import{b as Ln,u as zr,r as h,j as e,I as re,R as G,d as Nn,e as Et,B as u,G as Lr,T as j,f as U,L as ds,h as us,i as hs,k as ft,l as Zs,m as Mn,D as gt,A as ce,M as _e,n as Ee,o as He,p as ks,q as Cs,s as Rs,F as se,t as ee,S as ie,v as z,w as q,x as Ps,y as $e,z as X,C as Wt,E as Ht,H as te,J as Ae,K as Se,N as Nr,O as Mr,P as Fr,Q as ot,U as it,V as Qe,W as Fn,X as qn,Y as $n,Z as Un,_ as Bn,$ as Qs,a0 as Wn,a1 as Hn,a2 as Vn,a3 as Ks,a4 as xs,a5 as Jn,a6 as qr,a7 as Gn,a8 as Zn,a9 as Qn,aa as Xs,ab as Ys,ac as er,ad as tr}from"./mui-core-BVMuDfY9.js";import{D as $r,L as Kn,H as Xn,a as _s,S as Es,b as Ur,G as As,c as Br,A as Wr,Q as Hr,d as zt,P as yt,e as Yn,K as eo,f as jt,g as de,h as ge,F as Os,i as Lt,j as sr,I as rr,E as lt,k as to,l as Vr,m as Jr,n as so,C as ro,M as no,o as oo,p as io,q as Is,r as Gr,s as nr,t as lo,u as ao,B as co,v as uo,w as ho,x as xo,y as po,z as fo,J as mo,N as or,O as go,U as Zr,R as jo,T as bo,V as yo,W as wo,X as So}from"./mui-icons-B0DlgBzH.js";import{c as vo}from"./supabase-CQnIwFJt.js";import{N as Nt,u as Ds,a as Ts,R as zs,b as ye,B as ko}from"./router-D89MQL-m.js";import{f as ts}from"./utils-CSQe5d3I.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();var kt={},ir;function Co(){if(ir)return kt;ir=1;var s=Ln();return kt.createRoot=s.createRoot,kt.hydrateRoot=s.hydrateRoot,kt}var Ro=Co();function Po(s){const{onClick:t,sx:r,...n}=s,{mode:o,setMode:l}=zr(),[i,a]=h.useState(!1);return h.useEffect(()=>{a(!0)},[]),i?e.jsxs(re,{"data-screenshot":"toggle-mode",size:"sm",variant:"outlined",color:"neutral",...n,onClick:c=>{l(o==="light"?"dark":"light"),t?.(c)},sx:[o==="dark"?{"& > *:first-of-type":{display:"none"}}:{"& > *:first-of-type":{display:"initial"}},o==="light"?{"& > *:last-of-type":{display:"none"}}:{"& > *:last-of-type":{display:"initial"}},...Array.isArray(r)?r:[r]],children:[e.jsx($r,{}),e.jsx(Kn,{})]}):e.jsx(re,{size:"sm",variant:"outlined",color:"neutral",...n,sx:r,disabled:!0})}const Qr="https://tfzvtzqybgbzxcxozdes.supabase.co",ps="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRmenZ0enF5YmdienhjeG96ZGVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc4NTc2MDIsImV4cCI6MjA2MzQzMzYwMn0.hD2WdkvI8LY9N0IHP7HDQliyicQA0c-mspKjCJf0_Fc";console.log("[Supabase] URL:",Qr);console.log("[Supabase] Anon Key:",ps.slice(0,6)+"..."+ps.slice(-6));const F=vo(Qr,ps);F.auth.onAuthStateChange((s,t)=>{console.log("[Auth State Change]",s,t),s==="SIGNED_IN"?console.log("User signed in:",t?.user):s==="SIGNED_OUT"&&console.log("User signed out")});let ss=!1;F.auth.onAuthStateChange((s,t)=>{ss||(ss=!0,console.log("[Auth State Change]",s,t),s==="SIGNED_IN"?console.log("User signed in:",t?.user):s==="SIGNED_OUT"&&(console.log("User signed out"),window.location.pathname!=="/login"&&(window.location.href="/login")),ss=!1)});const Ls=s=>t=>{const[r,n]=G.useState(null),[o,l]=G.useState(!0);return G.useEffect(()=>{async function i(){const{data:a}=await F.auth.getSession();n(a?.session||null),l(!1)}i()},[]),o?e.jsx("div",{children:"Loading..."}):r?e.jsx(s,{...t}):e.jsx(Nt,{to:"/login",replace:!0})},_o=[{label:"Home",icon:G.createElement(Xn),value:"home",route:"/",showInMobile:!0},{label:"Dashboard",icon:G.createElement(_s),value:"dashboard",route:"/dashboard",showInMobile:!0},{label:"Orders",icon:G.createElement(Es),value:"orders",route:"/orders",showInMobile:!0},{label:"Products",icon:G.createElement(Ur),value:"products",route:"/products",showInMobile:!0},{label:"Users",icon:G.createElement(As),value:"users",route:"/users",showInMobile:!0},{label:"Suppliers",icon:G.createElement(Br),value:"suppliers",route:"/suppliers",showInMobile:!0},{label:"Purchase Orders",icon:G.createElement(Wr),value:"purchaseorders",route:"/purchase-orders",showInMobile:!0},{label:"Tickets",icon:G.createElement(Hr),value:"tickets",route:"/tickets",showInMobile:!0},{label:"SMS Campaigns",icon:G.createElement(zt),value:"smscampaigns",route:"/sms-campaigns",showInMobile:!0},{label:"Movements",icon:G.createElement(zt),value:"movements",route:"/movements",showInMobile:!0},{label:"My Profile",icon:G.createElement(yt),value:"profile",route:"/settings",showInMobile:!0}],At={Sales:[{label:"Dashboard",icon:G.createElement(_s),value:"dashboard",route:"/dashboard",showInMobile:!0},{label:"Orders",icon:G.createElement(Es),value:"orders",route:"/orders",showInMobile:!0},{label:"Products",icon:G.createElement(Ur),value:"products",route:"/products",showInMobile:!0}],Support:[{label:"Tickets",icon:G.createElement(Hr),value:"tickets",route:"/tickets",showInMobile:!0},{label:"Users",icon:G.createElement(As),value:"users",route:"/users",showInMobile:!0},{label:"My Profile",icon:G.createElement(yt),value:"profile",route:"/settings",showInMobile:!0}],Marketing:[{label:"SMS Campaigns",icon:G.createElement(zt),value:"smscampaigns",route:"/sms-campaigns",showInMobile:!0}],Operations:[{label:"Suppliers",icon:G.createElement(Br),value:"suppliers",route:"/suppliers",showInMobile:!0},{label:"Purchase Orders",icon:G.createElement(Wr),value:"purchaseorders",route:"/purchase-orders",showInMobile:!0},{label:"Movements",icon:G.createElement(zt),value:"movements",route:"/movements",showInMobile:!0}]};function ve(){const s=Nn(),t=Et("(max-width:600px)"),r=Et("(min-width:601px) and (max-width:1024px)"),n=Et("(min-width:1025px)");return{isMobile:t,isTablet:r,isDesktop:n,isSmallScreen:t,isMediumScreen:r,isLargeScreen:n,breakpoints:{mobile:"600px",tablet:"1024px",desktop:"1025px"},theme:s}}function Kr(){const{isMobile:s,isTablet:t}=ve();return{containerPadding:s?1:t?2:3,sectionPadding:s?2:t?3:4,itemPadding:s?1:2,smallGap:s?1:2,mediumGap:s?2:3,largeGap:s?3:4,sectionMargin:s?2:3,itemMargin:s?1:2}}function Eo(){const{isMobile:s}=ve();return{getModalSize:(r="medium")=>s?{width:"95vw",height:r==="fullscreen"?"95vh":"auto",maxHeight:"90vh",margin:1}:{small:{width:400,maxWidth:"90vw"},medium:{width:600,maxWidth:"90vw"},large:{width:800,maxWidth:"90vw"},fullscreen:{width:"90vw",height:"90vh"}}[r]}}function Ao({setView:s,view:t}){const r=Ds(),n=Ts(),{isMobile:o,isTablet:l,isDesktop:i}=ve(),[a,c]=h.useState(!1),[d,p]=h.useState([]),[x,w]=h.useState(null),[C,f]=h.useState(null);h.useEffect(()=>{async function g(){const{data:M,error:P}=await F.from("users").select("*");!P&&M&&p(M)}g();async function R(M){if(w(M),M){let{data:P}=await F.from("users").select("*").eq("id",M.id).single();P||(await F.from("users").upsert({id:M.id,email:M.email,name:M.user_metadata?.full_name||null,avatar_url:M.user_metadata?.avatar_url||null,role:"employee"}),P={...M,role:"employee"}),f(P)}else f(null)}F.auth.getUser().then(({data:M})=>R(M.user));const{data:T}=F.auth.onAuthStateChange((M,P)=>{R(P?.user??null)});return()=>{T?.subscription.unsubscribe()}},[]),h.useEffect(()=>{l&&c(!0)},[l,i]);const b=g=>{r(g.route),s(g.value),l&&c(!0)},S=()=>{c(!a)},A=(g,R)=>{b({value:R,route:g})},k=g=>n.pathname===g;return e.jsxs(u,{className:"Sidebar",sx:{display:o?"none":"flex",position:{xs:"fixed",md:"sticky"},transform:{xs:"translateX(calc(100% * (var(--SideNavigation-slideIn, 0) - 1)))",md:"none"},transition:"transform 0.4s, width 0.4s",zIndex:1e4,height:"100vh",maxHeight:"100vh",width:"var(--Sidebar-width)",top:0,p:2,flexShrink:0,flexDirection:"column",gap:2,borderRight:"1px solid",borderColor:"divider",background:"var(--joy-palette-background-surface, #fff)",overflow:"hidden"},children:[e.jsx(Lr,{styles:g=>({":root":{"--Sidebar-width":a?"60px":"220px",[g.breakpoints.up("lg")]:{"--Sidebar-width":a?"60px":"240px"}}})}),e.jsx(u,{className:"Sidebar-overlay",sx:{position:"fixed",zIndex:9998,top:0,left:0,width:"100vw",height:"100vh",opacity:"var(--SideNavigation-slideIn)",backgroundColor:"var(--joy-palette-background-backdrop)",transition:"opacity 0.4s",transform:{xs:"translateX(calc(100% * (var(--SideNavigation-slideIn, 0) - 1) + var(--SideNavigation-slideIn, 0) * var(--Sidebar-width, 0px)))",lg:"translateX(-100%)"}}}),e.jsxs(u,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(re,{size:"sm",variant:"plain",onClick:S,sx:{p:.5,borderRadius:1,"&:hover":{bgcolor:"neutral.100"}},children:e.jsx("img",{src:"/favicon.svg",alt:"Logo",style:{width:28,height:28,borderRadius:6}})}),!a&&e.jsxs(e.Fragment,{children:[e.jsx(j,{level:"title-lg",children:"Smartbuy"}),e.jsx(Po,{sx:{ml:"auto"}})]})]}),!a&&e.jsx(U,{size:"sm",startDecorator:e.jsx(Yn,{}),placeholder:"Search"}),e.jsx(u,{sx:{minHeight:0,overflowY:"auto",overflowX:"hidden",flex:1,display:"flex",flexDirection:"column",[`& .${Mn.root}`]:{gap:1.5}},children:e.jsx(ds,{size:"sm",sx:{gap:1,"--List-nestedInsetStart":"30px","--ListItem-radius":g=>g.vars.radius.sm},children:["Sales","Support","Operations","Marketing"].map(g=>e.jsx(us,{nested:!0,children:e.jsx(Oo,{defaultExpanded:!a,renderToggle:({open:R,setOpen:T})=>a?e.jsx(hs,{title:g,placement:"right",arrow:!0,children:e.jsx(ft,{onClick:()=>T(!R),children:At[g][0]?.icon})}):e.jsxs(ft,{onClick:()=>T(!R),children:[At[g][0]?.icon,e.jsx(Zs,{children:e.jsx(j,{level:"title-sm",children:g})}),e.jsx(eo,{sx:[R?{transform:"rotate(180deg)"}:{transform:"none"}]})]}),children:e.jsx(ds,{sx:{gap:.5},children:At[g].map(R=>e.jsx(us,{children:a?e.jsx(hs,{title:R.label,placement:"right",arrow:!0,children:e.jsx(ft,{selected:k(R.route),onClick:()=>A(R.route,R.value),sx:{justifyContent:"center",px:1,width:"100%"},children:R.icon})}):e.jsxs(ft,{selected:k(R.route),onClick:()=>A(R.route,R.value),sx:{justifyContent:"flex-start",px:2,width:"100%"},children:[R.icon,e.jsx(Zs,{children:e.jsx(j,{level:"body-sm",children:R.label})})]})},R.value))})})},g))})}),e.jsx(u,{sx:{flexShrink:0}}),e.jsx(gt,{}),e.jsxs(u,{sx:{display:"flex",gap:1,alignItems:"center",minHeight:48,cursor:"pointer",borderRadius:"sm","&:hover":{bgcolor:"neutral.50"}},onClick:()=>A("/settings","settings"),children:[e.jsx(ce,{variant:"outlined",size:"sm",src:C?.avatar_url||x?.user_metadata?.avatar_url||void 0}),!a&&e.jsxs(u,{sx:{minWidth:0,flex:1},children:[e.jsx(j,{level:"title-sm",children:C?.name||x?.user_metadata?.full_name||x?.email||"Not signed in"}),e.jsx(j,{level:"body-xs",children:C?.email||x?.email||""})]})]})]})}function Oo({defaultExpanded:s=!1,renderToggle:t,children:r}){const[n,o]=h.useState(s);return e.jsxs(h.Fragment,{children:[t({open:n,setOpen:o}),e.jsx(u,{sx:{display:"grid",transition:"0.2s ease","& > *":{overflow:"hidden"},gridTemplateRows:n?"1fr":"0fr"},children:r})]})}const Io=Ls(Ao);function je({children:s,variant:t="page",padding:r="medium",fullHeight:n=!1,className:o}){const{isMobile:l}=ve(),i=Kr(),a=()=>r==="none"?0:{small:i.itemPadding,medium:i.containerPadding,large:i.sectionPadding}[r]||i.containerPadding,c=()=>{const d={p:a(),boxSizing:"border-box"};switch(t){case"page":return{...d,height:n?"100%":"auto",overflow:"auto",width:"100%"};case"dialog":return{...d,height:"auto",overflow:"visible"};case"form":return{...d,display:"flex",flexDirection:"column",gap:i.mediumGap};case"card":return{...d,borderRadius:1,bgcolor:"background.surface"};case"table-page":return{width:"100%",overflow:"visible",pt:l?1:2,pl:l?1:2,pr:l?1:2,pb:l?1:2,boxSizing:"border-box"};default:return d}};return e.jsx(u,{sx:c(),className:o,children:s})}function Mt({open:s,onClose:t,children:r,title:n,size:o="medium",showCloseButton:l=!0,actions:i}){const{getModalSize:a}=Eo();return e.jsx(_e,{open:s,onClose:t,children:e.jsxs(Ee,{sx:a(o),children:[l&&e.jsx(He,{}),n&&e.jsx(ks,{children:n}),e.jsx(Cs,{children:r}),i&&e.jsx(Rs,{children:i})]})})}const Le=({children:s})=>e.jsx(u,{sx:{display:"flex",flexDirection:"column",width:"100%",flex:1,bgcolor:"background.body"},children:s}),Do=({open:s,creating:t,newOrder:r,setNewOrder:n,onClose:o,onCreate:l})=>{const[i,a]=h.useState([]),[c,d]=h.useState([{id:crypto.randomUUID(),product:null,quantity:1,unitprice:0,discount:0}]),[p,x]=h.useState(!1),[w,C]=h.useState(null),[f,b]=h.useState(null),[S,A]=h.useState(0),[k,g]=h.useState(!1),[R,T]=h.useState(null),[M,P]=h.useState(!1);h.useEffect(()=>{s&&(d([{id:crypto.randomUUID(),product:null,quantity:1,unitprice:0,discount:0}]),C(null),n(N=>({...N,date:N.date||new Date().toISOString().slice(0,10)})))},[s]),h.useEffect(()=>{s&&(x(!0),b(null),F.from("Products").select("*").then(({data:N,error:v})=>{!v&&N?(N.length===0&&b("No products available. Please add products first."),a(N.map(O=>({id:O.uuid||O.id,ProductName:O.ProductName,SalesPrice:O.SalesPrice??0})))):b("Failed to load products. Please try again later."),x(!1)}))},[s]);const W=()=>{d(N=>[...N,{id:crypto.randomUUID(),product:null,quantity:1,unitprice:0,discount:S}])},I=N=>{d(v=>v.filter((O,D)=>D!==N))},L=(N,v,O)=>{d(D=>D.map((B,xe)=>{if(xe!==N)return B;if(v==="product"&&O){const Oe=i.find(ae=>ae.id===O.id);return{...B,product:O,unitprice:Oe?.SalesPrice??0}}return v==="product"&&!O?{...B,product:null,unitprice:0}:{...B,[v]:O}}))},_=N=>{N.preventDefault();const v=c.filter(O=>O.product&&O.product.id&&O.quantity>0).map(O=>({product_uuid:O.product.id,quantity:O.quantity,unitprice:O.unitprice,discount:O.discount}));if(v.length===0){C("Please add at least one valid order item.");return}C(null),l(v,S)};return e.jsx(_e,{open:s,onClose:o,"aria-labelledby":"create-order-modal",children:e.jsxs(Ee,{"aria-labelledby":"create-order-modal",sx:{maxWidth:600,width:"100%",minWidth:{xs:300,sm:400}},children:[e.jsx(He,{}),e.jsx(j,{id:"create-order-modal",level:"h4",sx:{mb:2},children:"Create Order"}),e.jsxs("form",{onSubmit:_,children:[e.jsxs(se,{sx:{mb:2},required:!0,children:[e.jsx(ee,{children:"Date"}),e.jsx(U,{type:"date",value:r.date,onChange:N=>n(v=>({...v,date:N.target.value})),required:!0})]}),e.jsxs(se,{sx:{mb:2},required:!0,children:[e.jsx(ee,{children:"Status"}),e.jsxs(ie,{value:r.status,onChange:(N,v)=>n(O=>({...O,status:v||"Paid"})),children:[e.jsx(z,{value:"Paid",children:"Paid"}),e.jsx(z,{value:"Refunded",children:"Refunded"}),e.jsx(z,{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs(se,{sx:{mb:2},required:!0,children:[e.jsx(ee,{children:"Customer Name"}),e.jsx(U,{value:r.customer_name,onChange:N=>n(v=>({...v,customer_name:N.target.value})),required:!0})]}),e.jsxs(se,{sx:{mb:2},required:!0,children:[e.jsx(ee,{children:"Customer Email"}),e.jsx(U,{type:"email",value:r.customer_email,onChange:N=>n(v=>({...v,customer_email:N.target.value})),required:!0})]}),e.jsxs(se,{sx:{mb:2},required:!0,children:[e.jsx(ee,{children:"Order Discount (%)"}),e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(U,{type:"number",value:S,disabled:c.length>0&&!(c.length===1&&!c[0].product),onChange:N=>{const v=Math.max(0,Math.min(100,Math.floor(Number(N.target.value))));A(v),d(O=>O.map(D=>({...D,discount:v})))},slotProps:{input:{min:0,max:100,step:1}},required:!0,placeholder:"Order Discount %",sx:{flex:1}}),(c.length>1||c.length===1&&c[0].product)&&e.jsx(q,{size:"sm",variant:"outlined",onClick:()=>g(!0),children:"Edit"})]})]}),w&&e.jsx(j,{color:"danger",sx:{mb:1},children:w}),e.jsx(gt,{sx:{my:2}}),e.jsx(u,{sx:{mb:1,fontWeight:"lg",fontSize:"lg"},children:"Order Items"}),f&&e.jsx(j,{color:"danger",sx:{mb:1},children:f}),c.map((N,v)=>e.jsxs(u,{sx:{display:"flex",gap:1,alignItems:"center",mb:1},children:[e.jsx(Ps,{options:i,getOptionLabel:O=>O.ProductName,isOptionEqualToValue:(O,D)=>O.id===D.id,value:N.product,onChange:(O,D)=>L(v,"product",D),loading:p,placeholder:p?"Loading...":"Search product",sx:{minWidth:220},disabled:i.length===0,required:!0,renderOption:(O,D)=>e.jsx("li",{...O,children:D.ProductName})}),e.jsx(U,{type:"number",value:N.quantity,onChange:O=>L(v,"quantity",Math.max(1,Number(O.target.value))),sx:{width:80},required:!0,slotProps:{input:{min:1}}}),e.jsx(U,{type:"number",value:N.unitprice,onChange:O=>L(v,"unitprice",Math.max(0,Number(O.target.value))),sx:{width:100},required:!0,slotProps:{input:{min:0,step:.01}},placeholder:"Unit Price"}),e.jsx(U,{type:"number",value:N.discount,onChange:O=>L(v,"discount",Math.max(0,Math.min(100,Math.floor(Number(O.target.value))))),sx:{width:80},required:!0,slotProps:{input:{min:0,max:100,step:1}},placeholder:"Discount %"}),e.jsx(re,{size:"sm",color:"danger",onClick:()=>I(v),disabled:c.length===1,children:e.jsx(jt,{})})]},N.id)),e.jsx(q,{startDecorator:e.jsx(de,{}),variant:"soft",size:"sm",onClick:W,sx:{mb:2},disabled:!!f,children:"Add Item"}),e.jsx(_e,{open:k,onClose:()=>g(!1),children:e.jsxs(Ee,{sx:{minWidth:350},children:[e.jsx(j,{level:"title-md",sx:{mb:1},children:"Change Order Discount"}),e.jsxs(se,{sx:{mb:2},required:!0,children:[e.jsx(ee,{children:"Change discount to (%)"}),e.jsx(U,{type:"number",value:R??S,onChange:N=>T(Math.max(0,Math.min(100,Math.floor(Number(N.target.value))))),slotProps:{input:{min:0,max:100,step:1}},required:!0,autoFocus:!0})]}),e.jsx(j,{sx:{mb:2},children:"How do you want to apply the new order discount?"}),e.jsxs(u,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(q,{onClick:()=>{A(R),d(N=>N.map(v=>({...v,discount:R}))),g(!1),T(null)},children:"Overwrite all"}),e.jsx(q,{onClick:()=>{A(R),d(N=>N.map(v=>v.discount<R?{...v,discount:R}:v)),g(!1),T(null)},children:"Set discount on lower"}),e.jsx(q,{variant:"plain",onClick:()=>{g(!1),T(null)},children:"Cancel"})]})]})}),e.jsxs(u,{sx:{display:"flex",gap:2,mt:2},children:[e.jsx(q,{type:"submit",loading:t,color:"primary",disabled:!!f,children:"Create"}),e.jsx(q,{variant:"plain",onClick:o,disabled:t,children:"Cancel"})]})]})]})})};function To({open:s,onClose:t,selectedOrder:r,fetchOrderItems:n}){const[o,l]=h.useState([]),[i,a]=h.useState(!1);return h.useEffect(()=>{async function c(){if(r){a(!0);const d=await n(r.uuid);l(d),a(!1)}else l([])}s&&r?c():l([])},[s,r,n]),e.jsx(_e,{open:s,onClose:t,"aria-labelledby":"order-details-modal",children:e.jsxs(Ee,{"aria-labelledby":"order-details-modal",sx:{maxWidth:600,width:"100%"},children:[e.jsx(He,{}),e.jsx(j,{id:"order-details-modal",level:"title-md",fontWeight:"lg",sx:{mb:2},children:"Order Details"}),r&&e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(j,{level:"body-sm",sx:{color:"text.secondary"},children:["Order ID: ",r.uuid]}),e.jsxs(j,{level:"body-sm",sx:{color:"text.secondary"},children:["Date: ",new Date(r.date).toLocaleString()]}),e.jsxs(j,{level:"body-sm",sx:{color:"text.secondary"},children:["Status: ",r.status]})]}),e.jsx(gt,{}),e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(j,{level:"body-sm",fontWeight:"md",children:"Customer Information"}),e.jsxs(j,{level:"body-sm",sx:{color:"text.secondary"},children:["Name: ",r.customer.name]}),e.jsxs(j,{level:"body-sm",sx:{color:"text.secondary"},children:["Email: ",r.customer.email]})]}),e.jsx(gt,{}),e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(j,{level:"body-sm",fontWeight:"md",children:"Ordered Items"}),i?e.jsx(j,{level:"body-sm",sx:{color:"text.secondary"},children:"Loading items..."}):e.jsxs($e,{size:"sm",sx:{minWidth:500},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{style:{textAlign:"right"},children:"Quantity"}),e.jsx("th",{style:{textAlign:"right"},children:"Unit Price"}),e.jsx("th",{style:{textAlign:"right"},children:"Discount (%)"}),e.jsx("th",{style:{textAlign:"right"},children:"Total Price"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{textAlign:"center",padding:"16px"},children:e.jsx(j,{level:"body-sm",sx:{color:"text.secondary"},children:"No items found for this order."})})}):o.map(function(c){return e.jsxs("tr",{children:[e.jsx("td",{children:c.name||c.product_uuid}),e.jsx("td",{style:{textAlign:"right"},children:c.quantity??"-"}),e.jsx("td",{style:{textAlign:"right"},children:c.unitprice!=null?`$${Number(c.unitprice).toFixed(2)}`:"-"}),e.jsx("td",{style:{textAlign:"right"},children:c.discount!=null?`${Number(c.discount).toFixed(2)}%`:"-"}),e.jsx("td",{style:{textAlign:"right"},children:c.price!=null?`$${Number(c.price).toFixed(2)}`:"-"})]},c.uuid)})})]})]})]})]})})}const K={sizes:{small:"0.875rem",xlarge:"1.5rem"}},be={fontSize:K.sizes.small},zo=()=>{const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState(!1),[l,i]=h.useState(""),[a,c]=h.useState(""),[d,p]=h.useState(""),[x,w]=h.useState(""),[C,f]=h.useState(!1),[b,S]=h.useState(!1),[A,k]=h.useState(!1),[g,R]=h.useState(null),[T,M]=h.useState(!1),[P,W]=h.useState({date:new Date().toISOString().split("T")[0],status:"Paid",customer_name:"",customer_email:""}),[I,L]=h.useState(!1),[_,N]=h.useState(""),[v,O]=h.useState("success"),D=(m,$="success")=>{N(m),O($),L(!0)},B=m=>{switch(m){case"Paid":return"success";case"Refunded":return"warning";case"Cancelled":return"danger";default:return"neutral"}},xe=m=>{switch(m){case"Paid":return e.jsx(sr,{});case"Refunded":return e.jsx(sr,{});case"Cancelled":return e.jsx(Lt,{});default:return e.jsx(Lt,{})}},Oe=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),ae=async()=>{o(!0);try{const{data:m,error:$}=await F.from("Orders").select("*");if($){console.error("Error fetching orders:",$),D("Failed to fetch orders","danger");return}if(m){const Y=m.map(J=>({uuid:J.uuid,date:J.date||J.created_at||J["Created at"]||"",status:J.status||"Paid",customer:J.customer||{initial:J.customer_initial||(J.customer_name?J.customer_name[0]:"?"),name:J.customer_name||"Unknown",email:J.customer_email||""},order_number_display:J.order_number_display,order_total:typeof J.order_total=="number"?J.order_total:0,created_by:J.created_by||"",created_by_name:J.created_by_name||"",created_by_email:J.created_by_email||"",category:J.category||"purchase"})).sort((J,ne)=>{const oe=new Date(J.date||0);return new Date(ne.date||0).getTime()-oe.getTime()});r(Y)}}catch(m){console.error("Error fetching orders:",m),D("Failed to fetch orders","danger")}finally{o(!1)}},ke=async m=>{try{const{data:$,error:Y}=await F.from("OrderItems").select("*, Products:product_uuid(ProductName)").eq("order_uuid",m);return Y?(console.error("Error fetching order items:",Y),[]):$?.map(J=>({...J,product_name:J.Products?.ProductName||J.product_uuid}))||[]}catch($){return console.error("Error fetching order items:",$),[]}};h.useEffect(()=>{ae()},[]);const Ne=t.filter(m=>{const $=!l||m.order_number_display?.toString().toLowerCase().includes(l.toLowerCase())||m.customer.name.toLowerCase().includes(l.toLowerCase())||m.customer.email.toLowerCase().includes(l.toLowerCase()),Y=!a||m.status===a,J=!d||m.category===d,ne=!x||m.customer.name===x;return $&&Y&&J&&ne}),Ve=Array.from(new Set(t.map(m=>m.status))),dt=Array.from(new Set(t.map(m=>m.category||"purchase"))),Ue=Array.from(new Set(t.map(m=>m.customer.name))),Pe=m=>{const $=t.find(Y=>Y.uuid===m||Y.order_number_display===m);$&&(R($),k(!0))},st=()=>{S(!0)},rt=async(m,$)=>{M(!0);try{const{data:Y,error:J}=await F.from("Orders").insert({date:P.date,status:P.status,customer_name:P.customer_name,customer_email:P.customer_email,order_total:m.reduce((ne,oe)=>ne+oe.quantity*oe.unitprice*(1-oe.discount/100),0)-$}).select().single();if(J){console.error("Error creating order:",J),D("Failed to create order","danger");return}if(m.length>0){const{error:ne}=await F.from("OrderItems").insert(m.map(oe=>({order_uuid:Y.uuid,product_uuid:oe.product_uuid,quantity:oe.quantity,unitprice:oe.unitprice,discount_percent:oe.discount})));ne&&(console.error("Error creating order items:",ne),D("Order created but failed to add items","warning"))}D("Order created successfully","success"),S(!1),W({date:new Date().toISOString().split("T")[0],status:"Paid",customer_name:"",customer_email:""}),ae()}catch(Y){console.error("Error creating order:",Y),D("Failed to create order","danger")}finally{M(!1)}},nt=()=>{f(!1)},E=()=>{c(""),p(""),w("")},V=()=>e.jsxs(u,{sx:{pb:2},children:[e.jsxs(je,{variant:"page",padding:"medium",children:[e.jsxs(u,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(U,{placeholder:"Search orders...",value:l,onChange:m=>i(m.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1,fontSize:"16px"}}),e.jsx(re,{variant:"soft",onClick:()=>f(!0),sx:{flexShrink:0},children:e.jsx(Os,{})})]}),(a||d||x)&&e.jsxs(u,{sx:{display:"flex",gap:1,mb:2,flexWrap:"wrap"},children:[a&&e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Status: ",a]}),d&&e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Category: ",d]}),x&&e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Customer: ",x]})]}),n&&e.jsx(Ae,{sx:{mb:2}})]}),e.jsx(u,{children:Ne.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:n?"Loading orders...":"No orders found"})}):Ne.map(m=>e.jsx(u,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider",cursor:"pointer","&:hover":{bgcolor:"background.level1"}},onClick:()=>Pe(m.uuid),children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(u,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:`${B(m.status)}.100`,color:`${B(m.status)}.600`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",flexShrink:0},children:xe(m.status)}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsxs(j,{level:"title-sm",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%"},children:["Order #",m.order_number_display||m.uuid.substring(0,8)]}),e.jsx(te,{size:"sm",color:B(m.status),variant:"soft",sx:{fontWeight:"bold",minWidth:"fit-content"},children:m.status})]}),e.jsxs(j,{level:"body-xs",color:"neutral",sx:{mb:.5},children:[m.customer.name," • ",new Date(m.date).toLocaleDateString()]}),m.order_total&&e.jsx(j,{level:"body-xs",sx:{fontWeight:"bold",color:"primary.600"},children:Oe(m.order_total)})]})]})},m.uuid))}),e.jsx(re,{color:"primary",variant:"soft",size:"sm",sx:{position:"fixed",bottom:80,right:16,zIndex:1e3,borderRadius:"8px",width:40,height:40,boxShadow:"sm",bgcolor:"primary.100","&:hover":{bgcolor:"primary.200",boxShadow:"md"}},onClick:st,children:e.jsx(de,{fontSize:"small"})})]}),pe=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Orders"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(U,{placeholder:"Search orders...",sx:{flex:1,fontSize:K.sizes.small},value:l,onChange:m=>i(m.target.value),startDecorator:e.jsx(ge,{})}),e.jsxs(ie,{placeholder:"Filter status",value:a,onChange:(m,$)=>c($||""),sx:{minWidth:160,fontSize:K.sizes.small},children:[e.jsx(z,{value:"",children:"All Statuses"}),Ve.map(m=>e.jsx(z,{value:m,children:m},m))]}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:st,sx:{fontSize:K.sizes.small},children:"Create Order"})]}),e.jsxs(Se,{sx:{overflow:"visible"},children:[n&&e.jsx(Ae,{}),e.jsxs($e,{"aria-label":"Orders",sx:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:be,children:"Order #"}),e.jsx("th",{style:be,children:"Date"}),e.jsx("th",{style:be,children:"Customer"}),e.jsx("th",{style:be,children:"Status"}),e.jsx("th",{style:be,children:"Total"}),e.jsx("th",{style:be,children:"Actions"})]})}),e.jsxs("tbody",{children:[Ne.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center",color:"#888",...be},children:n?"Loading orders...":"No orders found."})}),Ne.map(m=>e.jsxs("tr",{style:{cursor:"pointer"},children:[e.jsx("td",{style:be,children:m.order_number_display||m.uuid.substring(0,8)}),e.jsx("td",{style:be,children:new Date(m.date).toLocaleDateString()}),e.jsx("td",{style:be,children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(u,{sx:{width:24,height:24,borderRadius:"50%",bgcolor:"primary.100",color:"primary.600",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:m.customer.initial}),e.jsxs(u,{children:[e.jsx(j,{level:"body-sm",sx:{fontWeight:"bold"},children:m.customer.name}),e.jsx(j,{level:"body-xs",color:"neutral",children:m.customer.email})]})]})}),e.jsx("td",{style:be,children:e.jsx(te,{size:"sm",variant:"soft",color:B(m.status),children:m.status})}),e.jsx("td",{style:be,children:e.jsx(j,{level:"body-sm",sx:{fontWeight:"bold"},children:m.order_total?Oe(m.order_total):"N/A"})}),e.jsx("td",{style:be,children:e.jsx(q,{size:"sm",variant:"soft",onClick:()=>Pe(m.uuid),children:"View"})})]},m.uuid))]})]})]})]});return e.jsxs(Le,{children:[s?e.jsx(V,{}):e.jsx(pe,{}),e.jsx(Do,{open:b,creating:T,newOrder:P,setNewOrder:W,onClose:()=>S(!1),onCreate:rt}),e.jsx(To,{open:A,onClose:()=>k(!1),selectedOrder:g,fetchOrderItems:ke}),s&&e.jsx(Mt,{open:C,onClose:nt,title:"Filter Orders",size:"medium",actions:e.jsxs(u,{sx:{display:"flex",gap:2},children:[e.jsx(q,{variant:"plain",onClick:E,sx:be,children:"Clear All"}),e.jsx(q,{variant:"solid",onClick:nt,sx:be,children:"Apply"})]}),children:e.jsxs(X,{spacing:2,children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Status"}),e.jsxs(ie,{placeholder:"All statuses",value:a,onChange:(m,$)=>c($||""),children:[e.jsx(z,{value:"",children:"All Statuses"}),Ve.map(m=>e.jsx(z,{value:m,children:m},m))]})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Category"}),e.jsxs(ie,{placeholder:"All categories",value:d,onChange:(m,$)=>p($||""),children:[e.jsx(z,{value:"",children:"All Categories"}),dt.map(m=>e.jsx(z,{value:m,children:m},m))]})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Customer"}),e.jsxs(ie,{placeholder:"All customers",value:x,onChange:(m,$)=>w($||""),children:[e.jsx(z,{value:"",children:"All Customers"}),Ue.map(m=>e.jsx(z,{value:m,children:m},m))]})]})]})}),e.jsx(Wt,{open:I,onClose:()=>L(!1),autoHideDuration:4e3,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:16,zIndex:2e3},children:e.jsx(Ht,{color:v,variant:"solid",sx:{width:"100%"},children:_})})]})};function Lo({open:s,onClose:t,product:r,onSave:n}){const[o,l]=h.useState({ProductName:r?.ProductName||"",SalesPrice:r?.SalesPrice?.toString()||"",CostPrice:r?.CostPrice?.toString()||""}),[i,a]=h.useState(!1);h.useEffect(()=>{l({ProductName:r?.ProductName||"",SalesPrice:r?.SalesPrice?.toString()||"",CostPrice:r?.CostPrice?.toString()||""})},[r]);const c=async()=>{a(!0),await n(o),a(!1)};return e.jsx(_e,{open:s,onClose:t,"aria-labelledby":"product-table-form-title",children:e.jsxs(Ee,{children:[e.jsx(ks,{id:"product-table-form-title",children:r?"Edit Product":"Add Product"}),e.jsxs(Cs,{children:[e.jsx(U,{name:"ProductName",value:o.ProductName,onChange:d=>l({...o,ProductName:d.target.value}),placeholder:"Product Name",sx:{mb:2}}),e.jsx(U,{name:"SalesPrice",value:o.SalesPrice,onChange:d=>l({...o,SalesPrice:d.target.value}),placeholder:"Sales Price",type:"number",sx:{mb:2}}),e.jsx(U,{name:"CostPrice",value:o.CostPrice,onChange:d=>l({...o,CostPrice:d.target.value}),placeholder:"Cost Price",type:"number"})]}),e.jsxs(Rs,{children:[e.jsx(q,{onClick:t,variant:"plain",disabled:i,children:"Cancel"}),e.jsx(q,{onClick:c,variant:"solid",loading:i,disabled:i,children:"Save"})]})]})})}const lr=Ls(Lo),ue={fontSize:K.sizes.small},No=()=>{const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState({}),[l,i]=h.useState(!1),[a,c]=h.useState(!1),[d,p]=h.useState(!1),[x,w]=h.useState(""),[C,f]=h.useState(""),[b,S]=h.useState(!1),[A,k]=h.useState(!1),[g,R]=h.useState(!1),[T,M]=h.useState(null),[P,W]=h.useState(!1),[I,L]=h.useState(""),[_,N]=h.useState("success"),v=(E,V="success")=>{L(E),N(V),W(!0)},O=E=>E<=0?{status:"Out of Stock",color:"danger"}:E<=10?{status:"Low Stock",color:"warning"}:{status:"In Stock",color:"success"},D=E=>{const V=O(E);return e.jsx(u,{sx:{width:20,height:20,borderRadius:"50%",bgcolor:`${V.color}.100`,color:`${V.color}.600`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:e.jsx(to,{sx:{fontSize:"12px"}})})},B=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),xe=async()=>{i(!0);try{const{data:E,error:V}=await F.from("Products").select("*").order("CreatedAt",{ascending:!1});if(V){console.error("Error fetching products:",V),v("Failed to fetch products","danger");return}E&&(r(E),await Oe(E))}catch(E){console.error("Error fetching products:",E),v("Failed to fetch products","danger")}finally{i(!1)}},Oe=async E=>{c(!0);try{const{data:V,error:pe}=await F.from("stock_movements").select("product_id, movement_type, quantity");if(pe){console.error("Error fetching stock data:",pe);return}if(V){const m={};E.forEach($=>{const J=V.filter(ne=>ne.product_id===$.uuid).reduce((ne,oe)=>{switch(oe.movement_type){case"incoming":case"adjustment":return ne+(oe.quantity||0);case"outgoing":return ne-(oe.quantity||0);default:return ne}},0);m[$.uuid]=J}),o(m)}}catch(V){console.error("Error fetching stock levels:",V)}finally{c(!1)}};h.useEffect(()=>{xe()},[]);const ae=t.filter(E=>{const V=!x||E.ProductName.toLowerCase().includes(x.toLowerCase())||E.ProductID?.toLowerCase().includes(x.toLowerCase()),pe=n[E.uuid]||0,m=!C||C==="in-stock"&&pe>10||C==="low-stock"&&pe>0&&pe<=10||C==="out-of-stock"&&pe<=0;return V&&m}),ke=()=>{k(!0)},Ne=E=>{M(E),R(!0)},Ve=async E=>{if(confirm("Are you sure you want to delete this product?")){p(!0);try{const{error:V}=await F.from("Products").delete().eq("uuid",E);if(V){console.error("Error deleting product:",V),v("Failed to delete product","danger");return}r(t.filter(pe=>pe.uuid!==E)),v("Product deleted successfully","success")}catch(V){console.error("Error deleting product:",V),v("Failed to delete product","danger")}finally{p(!1)}}},dt=async E=>{p(!0);try{const{data:V,error:pe}=await F.from("Products").insert([{ProductName:E.ProductName,SalesPrice:parseFloat(E.SalesPrice),CostPrice:parseFloat(E.CostPrice),CreatedAt:new Date().toISOString()}]).select().single();if(pe){console.error("Error adding product:",pe),v("Failed to add product","danger");return}v("Product added successfully","success"),k(!1),xe()}catch(V){console.error("Error adding product:",V),v("Failed to add product","danger")}finally{p(!1)}},Ue=async E=>{if(T){p(!0);try{const{error:V}=await F.from("Products").update({ProductName:E.ProductName,SalesPrice:parseFloat(E.SalesPrice),CostPrice:parseFloat(E.CostPrice)}).eq("uuid",T.uuid);if(V){console.error("Error updating product:",V),v("Failed to update product","danger");return}v("Product updated successfully","success"),R(!1),M(null),xe()}catch(V){console.error("Error updating product:",V),v("Failed to update product","danger")}finally{p(!1)}}},Pe=()=>{S(!1)},st=()=>{f("")},rt=()=>e.jsxs(u,{sx:{pb:2},children:[e.jsxs(je,{variant:"page",padding:"medium",children:[e.jsxs(u,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(U,{placeholder:"Search products...",value:x,onChange:E=>w(E.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1,fontSize:"16px"}}),e.jsx(re,{variant:"soft",onClick:()=>S(!0),sx:{flexShrink:0},children:e.jsx(Os,{})})]}),C&&e.jsx(u,{sx:{display:"flex",gap:1,mb:2,flexWrap:"wrap"},children:e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Stock: ",C.replace("-"," ")]})}),l&&e.jsx(Ae,{sx:{mb:2}})]}),e.jsx(u,{children:ae.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:l?"Loading products...":"No products found"})}):ae.map(E=>e.jsx(u,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider","&:hover":{bgcolor:"background.level1"}},children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(u,{sx:{flexShrink:0},children:E.ImageUrl?e.jsx(ce,{src:E.ImageUrl,sx:{width:48,height:48},alt:E.ProductName}):e.jsx(ce,{sx:{width:48,height:48,bgcolor:"neutral.100"},children:e.jsx(rr,{})})}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%"},children:E.ProductName}),e.jsx(u,{sx:{display:"flex",alignItems:"center",gap:1},children:a?e.jsx(j,{level:"body-xs",color:"neutral",children:"..."}):e.jsxs(e.Fragment,{children:[D(n[E.uuid]||0),e.jsx(te,{size:"sm",color:O(n[E.uuid]||0).color,variant:"soft",sx:{fontSize:"10px",minWidth:"fit-content"},children:n[E.uuid]||0})]})})]}),e.jsxs(j,{level:"body-xs",color:"neutral",sx:{mb:.5},children:["ID: ",E.ProductID||"N/A"," • ",new Date(E.CreatedAt).toLocaleDateString()]}),e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(u,{children:[e.jsxs(j,{level:"body-xs",sx:{fontWeight:"bold",color:"success.600"},children:["Sale: ",B(E.SalesPrice)]}),e.jsxs(j,{level:"body-xs",color:"neutral",children:["Cost: ",B(E.CostPrice)]})]}),e.jsxs(u,{sx:{display:"flex",gap:.5},children:[e.jsx(re,{size:"sm",variant:"soft",color:"primary",onClick:()=>Ne(E),children:e.jsx(lt,{})}),e.jsx(re,{size:"sm",variant:"soft",color:"danger",onClick:()=>Ve(E.uuid),disabled:d,children:e.jsx(jt,{})})]})]})]})]})},E.uuid))}),e.jsx(re,{color:"primary",variant:"soft",size:"sm",sx:{position:"fixed",bottom:80,right:16,zIndex:1e3,borderRadius:"8px",width:40,height:40,boxShadow:"sm",bgcolor:"primary.100","&:hover":{bgcolor:"primary.200",boxShadow:"md"}},onClick:ke,children:e.jsx(de,{fontSize:"small"})})]}),nt=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Products"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(U,{placeholder:"Search products...",sx:{flex:1,fontSize:K.sizes.small},value:x,onChange:E=>w(E.target.value),startDecorator:e.jsx(ge,{})}),e.jsxs(ie,{placeholder:"Filter by stock",value:C,onChange:(E,V)=>f(V||""),sx:{minWidth:160,fontSize:K.sizes.small},children:[e.jsx(z,{value:"",children:"All Stock Levels"}),e.jsx(z,{value:"in-stock",children:"In Stock"}),e.jsx(z,{value:"low-stock",children:"Low Stock"}),e.jsx(z,{value:"out-of-stock",children:"Out of Stock"})]}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:ke,sx:{fontSize:K.sizes.small},children:"Add Product"})]}),e.jsxs(Se,{sx:{overflow:"visible"},children:[l&&e.jsx(Ae,{}),e.jsxs($e,{"aria-label":"Products",sx:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:ue,children:"Image"}),e.jsx("th",{style:ue,children:"Name"}),e.jsx("th",{style:ue,children:"Stock"}),e.jsx("th",{style:ue,children:"Sales Price"}),e.jsx("th",{style:ue,children:"Cost Price"}),e.jsx("th",{style:ue,children:"Created"}),e.jsx("th",{style:ue,children:"Actions"})]})}),e.jsxs("tbody",{children:[ae.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"#888",...ue},children:l?"Loading products...":"No products found."})}),ae.map(E=>e.jsxs("tr",{children:[e.jsx("td",{style:ue,children:E.ImageUrl?e.jsx(ce,{src:E.ImageUrl,sx:{width:32,height:32},alt:E.ProductName}):e.jsx(ce,{sx:{width:32,height:32,bgcolor:"neutral.100"},children:e.jsx(rr,{sx:{fontSize:"16px"}})})}),e.jsx("td",{style:ue,children:e.jsxs(u,{children:[e.jsx(j,{level:"body-sm",sx:{fontWeight:"bold"},children:E.ProductName}),e.jsxs(j,{level:"body-xs",color:"neutral",children:["ID: ",E.ProductID||"N/A"]})]})}),e.jsx("td",{style:ue,children:a?e.jsx(j,{level:"body-sm",sx:{color:"neutral.500"},children:"Loading..."}):e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(te,{size:"sm",variant:"soft",color:O(n[E.uuid]||0).color,children:O(n[E.uuid]||0).status}),e.jsx(hs,{title:`Current stock level: ${n[E.uuid]||0} units`,arrow:!0,children:e.jsx(j,{level:"body-sm",sx:{fontWeight:"bold",color:O(n[E.uuid]||0).color==="danger"?"danger.500":O(n[E.uuid]||0).color==="warning"?"warning.600":"success.600"},children:n[E.uuid]||0})}),e.jsx(u,{sx:{width:40,height:4,bgcolor:"neutral.200",borderRadius:2,overflow:"hidden"},children:e.jsx(u,{sx:{width:`${Math.min(100,Math.max(0,(n[E.uuid]||0)/50*100))}%`,height:"100%",bgcolor:O(n[E.uuid]||0).color==="danger"?"danger.400":O(n[E.uuid]||0).color==="warning"?"warning.400":"success.400",borderRadius:2}})})]})}),e.jsx("td",{style:ue,children:e.jsx(j,{level:"body-sm",sx:{fontWeight:"bold",color:"success.600"},children:B(E.SalesPrice)})}),e.jsx("td",{style:ue,children:e.jsx(j,{level:"body-sm",color:"neutral",children:B(E.CostPrice)})}),e.jsx("td",{style:ue,children:new Date(E.CreatedAt).toLocaleDateString()}),e.jsx("td",{style:ue,children:e.jsxs(u,{sx:{display:"flex",gap:.5},children:[e.jsx(re,{size:"sm",variant:"soft",color:"primary",onClick:()=>Ne(E),children:e.jsx(lt,{})}),e.jsx(re,{size:"sm",variant:"soft",color:"danger",onClick:()=>Ve(E.uuid),disabled:d,children:e.jsx(jt,{})})]})})]},E.uuid))]})]})]})]});return e.jsxs(Le,{children:[s?e.jsx(rt,{}):e.jsx(nt,{}),e.jsx(lr,{open:A,onClose:()=>k(!1),product:null,onSave:dt}),e.jsx(lr,{open:g,onClose:()=>{R(!1),M(null)},product:T,onSave:Ue}),s&&e.jsx(Mt,{open:b,onClose:Pe,title:"Filter Products",size:"medium",actions:e.jsxs(u,{sx:{display:"flex",gap:2},children:[e.jsx(q,{variant:"plain",onClick:st,sx:ue,children:"Clear All"}),e.jsx(q,{variant:"solid",onClick:Pe,sx:ue,children:"Apply"})]}),children:e.jsx(X,{spacing:2,children:e.jsxs(se,{children:[e.jsx(ee,{children:"Stock Level"}),e.jsxs(ie,{placeholder:"All stock levels",value:C,onChange:(E,V)=>f(V||""),children:[e.jsx(z,{value:"",children:"All Stock Levels"}),e.jsx(z,{value:"in-stock",children:"In Stock"}),e.jsx(z,{value:"low-stock",children:"Low Stock"}),e.jsx(z,{value:"out-of-stock",children:"Out of Stock"})]})]})})}),e.jsx(Wt,{open:P,onClose:()=>W(!1),autoHideDuration:4e3,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:16,zIndex:2e3},children:e.jsx(Ht,{color:_,variant:"solid",sx:{width:"100%"},children:I})})]})},Be={fontSize:K.sizes.small},Je={...Be,fontWeight:600,borderBottom:"1.5px solid #e0e0e0",background:"inherit"},ar=s=>{switch(s?.toLowerCase()){case"admin":return"danger";case"manager":return"warning";case"user":return"primary";case"staff":return"success";default:return"neutral"}},cr=(s,t)=>{const r=s||t;let n=0;for(let l=0;l<r.length;l++)n=r.charCodeAt(l)+((n<<5)-n);const o=["primary","success","warning","danger","neutral"];return o[Math.abs(n)%o.length]},dr=(s,t)=>{if(s){const r=s.split(" ");return r.length>=2?(r[0][0]+r[1][0]).toUpperCase():s.substring(0,2).toUpperCase()}return t.substring(0,2).toUpperCase()};function Mo(){return e.jsxs(Nr,{children:[e.jsx(Mr,{slots:{root:re},slotProps:{root:{variant:"plain",color:"neutral",size:"sm"}},children:e.jsx(no,{})}),e.jsxs(Fr,{size:"sm",sx:{minWidth:140},children:[e.jsx(ot,{children:"Edit"}),e.jsx(ot,{children:"Reset Password"}),e.jsx(ot,{children:"Disable"}),e.jsx(ot,{color:"danger",children:"Delete"})]})]})}const Fo=()=>{const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState(!1),[l,i]=h.useState(null),[a,c]=h.useState(""),[d,p]=h.useState("all"),[x,w]=h.useState(!1),C=async()=>{o(!0),i(null);try{const{data:g,error:R}=await F.from("users").select("*");if(R)throw R;if(g){const T=g.map(M=>({id:M.id,name:M.name||null,email:M.email,role:M.role||null,created_at:M.created_at||null,last_login:M.last_login||null,phone:M.phone||null}));r(T)}}catch(g){console.error("Error fetching users:",g),i(g.message||"Failed to fetch users")}finally{o(!1)}},f=Array.from(new Set(t.map(g=>g.role).filter(Boolean))),S=[...t.filter(g=>{const R=g.name?.toLowerCase().includes(a.toLowerCase())||g.email.toLowerCase().includes(a.toLowerCase()),T=d==="all"||g.role===d;return R&&T})].sort((g,R)=>{const T=g.name||g.email,M=R.name||R.email;return T.localeCompare(M)});h.useEffect(()=>{C()},[]);const A=()=>e.jsxs(u,{sx:{width:"100%",minHeight:"100vh"},children:[e.jsxs(je,{padding:"medium",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Users"}),e.jsxs(u,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(U,{placeholder:"Search users...",value:a,onChange:g=>c(g.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1}}),e.jsxs(ie,{placeholder:"Role",value:d,onChange:(g,R)=>p(R??"all"),sx:{minWidth:120},children:[e.jsx(z,{value:"all",children:"All"}),f.map(g=>e.jsx(z,{value:g,children:g},g))]})]}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:()=>w(!0),sx:{width:"100%",mb:2},children:"Create User"})]}),n&&e.jsx(Ae,{}),l&&e.jsx(u,{sx:{p:2},children:e.jsxs(j,{color:"danger",children:["Error: ",l]})}),e.jsx(u,{children:S.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:"No users found"})}):S.map(g=>e.jsx(u,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider","&:hover":{bgcolor:"background.level1"}},children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ce,{size:"md",color:cr(g.name,g.email),sx:{flexShrink:0},children:dr(g.name,g.email)}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%"},children:g.name||"Unnamed User"}),g.role&&e.jsx(te,{size:"sm",color:ar(g.role),variant:"soft",sx:{fontWeight:"bold",minWidth:"fit-content",textTransform:"capitalize"},children:g.role})]}),e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(Vr,{sx:{fontSize:14,color:"text.tertiary"}}),e.jsx(j,{level:"body-xs",color:"neutral",children:g.email})]}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:.5},children:[g.phone&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Jr,{sx:{fontSize:14,color:"text.tertiary"}}),e.jsx(j,{level:"body-xs",color:"neutral",children:g.phone})]}),g.last_login&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(so,{sx:{fontSize:14,color:"text.tertiary"}}),e.jsx(j,{level:"body-xs",color:"neutral",children:new Date(g.last_login).toLocaleDateString()})]})]}),g.created_at&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(ro,{sx:{fontSize:14,color:"text.tertiary"}}),e.jsxs(j,{level:"body-xs",color:"neutral",children:["Joined ",new Date(g.created_at).toLocaleDateString()]})]})]})]})},g.id))})]}),k=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Users"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(U,{placeholder:"Search users...",sx:{flex:1},value:a,onChange:g=>c(g.target.value),startDecorator:e.jsx(ge,{})}),e.jsxs(ie,{placeholder:"Filter role",value:d,onChange:(g,R)=>p(R??"all"),sx:{minWidth:160},children:[e.jsx(z,{value:"all",children:"All Roles"}),f.map(g=>e.jsx(z,{value:g,children:g},g))]}),e.jsx(q,{onClick:()=>w(!0),variant:"solid",startDecorator:e.jsx(de,{}),children:"Create User"})]}),e.jsxs(Se,{sx:{overflow:"visible"},children:[n&&e.jsx(Ae,{}),l&&e.jsxs(j,{color:"danger",children:["Error: ",l]}),e.jsxs($e,{"aria-label":"Users",sx:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:Je,children:"Name"}),e.jsx("th",{style:Je,children:"Email"}),e.jsx("th",{style:Je,children:"Role"}),e.jsx("th",{style:Je,children:"Created At"}),e.jsx("th",{style:Je,children:"Last Login"}),e.jsx("th",{style:Je,children:"Phone"}),e.jsx("th",{style:{width:120,...Je},children:"Actions"})]})}),e.jsxs("tbody",{children:[S.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"#888",...Be},children:"No users found."})}),S.map(g=>e.jsxs("tr",{style:{cursor:"pointer",height:48},children:[e.jsx("td",{style:Be,children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{size:"sm",color:cr(g.name,g.email),children:dr(g.name,g.email)}),e.jsx(j,{level:"body-sm",fontWeight:"md",children:g.name||"Unnamed User"})]})}),e.jsx("td",{style:Be,children:g.email}),e.jsx("td",{style:Be,children:g.role?e.jsx(te,{size:"sm",color:ar(g.role),variant:"soft",sx:{textTransform:"capitalize"},children:g.role}):"-"}),e.jsx("td",{style:Be,children:g.created_at?new Date(g.created_at).toLocaleDateString():"-"}),e.jsx("td",{style:Be,children:g.last_login?new Date(g.last_login).toLocaleDateString():"-"}),e.jsx("td",{style:Be,children:g.phone||"-"}),e.jsx("td",{children:e.jsx(Mo,{})})]},g.id))]})]})]})]});return e.jsxs(Le,{children:[s?e.jsx(A,{}):e.jsx(k,{}),e.jsx(_e,{open:x,onClose:()=>w(!1),"aria-labelledby":"create-user-modal",children:e.jsxs(Ee,{"aria-labelledby":"create-user-modal",sx:{maxWidth:600,width:"100%"},children:[e.jsx(He,{}),e.jsx(j,{id:"create-user-modal",level:"title-md",fontWeight:"lg",sx:{mb:2},children:"Create User"}),e.jsx(j,{level:"body-sm",sx:{mb:2},children:"User creation functionality will be implemented here."}),e.jsx(q,{onClick:()=>w(!1),variant:"outlined",children:"Close"})]})})]})};function Xr({open:s,onClose:t,onSaved:r,mode:n="add",supplier:o}){const[l,i]=h.useState(o?.name||""),[a,c]=h.useState(o?.contact_name||""),[d,p]=h.useState(o?.email||""),[x,w]=h.useState(o?.phone||""),[C,f]=h.useState(o?.address||""),[b,S]=h.useState(!1),[A,k]=h.useState(null);h.useEffect(()=>{s&&n==="edit"&&o?(i(o.name||""),c(o.contact_name||""),p(o.email||""),w(o.phone||""),f(o.address||"")):s&&n==="add"&&(i(""),c(""),p(""),w(""),f(""))},[s,n,o]);const g=async()=>{S(!0),k(null);const R={name:l,contact_name:a,email:d,phone:x,address:C};let T;if(n==="add"){T=await F.from("Suppliers").insert([R]).select(),S(!1),T.error?k(T.error.message):r(T.data?.[0]?.id);return}else T=await F.from("Suppliers").update(R).eq("id",o?.id);S(!1),T.error?k(T.error.message):r()};return e.jsx(_e,{open:s,onClose:t,children:e.jsxs(Ee,{sx:{minWidth:400},children:[e.jsx(He,{}),e.jsxs(j,{level:"title-md",sx:{mb:2},children:[n==="edit"?"Edit":"Add"," Supplier"]}),e.jsxs("form",{onSubmit:R=>{R.preventDefault(),R.stopPropagation(),g()},children:[e.jsx(U,{placeholder:"Name",value:l,onChange:R=>i(R.target.value),sx:{mb:2},required:!0}),e.jsx(U,{placeholder:"Contact Name",value:a,onChange:R=>c(R.target.value),sx:{mb:2}}),e.jsx(U,{placeholder:"Email",value:d,onChange:R=>p(R.target.value),sx:{mb:2},type:"email",required:!0}),e.jsx(U,{placeholder:"Phone",value:x,onChange:R=>w(R.target.value),sx:{mb:2},type:"tel"}),e.jsx(U,{placeholder:"Address",value:C,onChange:R=>f(R.target.value),sx:{mb:2}}),A&&e.jsx(j,{color:"danger",sx:{mb:1},children:A}),e.jsx(q,{type:"submit",loading:b,disabled:b,variant:"solid",children:"Save"})]})]})})}const ur=s=>{let t=0;for(let n=0;n<s.length;n++)t=s.charCodeAt(n)+((t<<5)-t);const r=["primary","success","warning","danger","neutral"];return r[Math.abs(t)%r.length]},hr=s=>{const t=s.split(" ");return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():s.substring(0,2).toUpperCase()};function qo({supplier:s,onEdit:t,onDelete:r}){return e.jsxs(Nr,{children:[e.jsx(Mr,{slots:{root:re},slotProps:{root:{variant:"plain",color:"neutral",size:"sm"}},children:e.jsx(io,{})}),e.jsxs(Fr,{size:"sm",sx:{minWidth:120},children:[e.jsxs(ot,{onClick:()=>t(s),children:[e.jsx(lt,{sx:{mr:1},fontSize:"small"}),"Edit"]}),e.jsxs(ot,{color:"danger",onClick:()=>r(s.id),children:[e.jsx(jt,{sx:{mr:1},fontSize:"small"}),"Delete"]})]})]})}const $o=()=>{const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState(!1),[l,i]=h.useState(null),[a,c]=h.useState(""),[d,p]=h.useState(!1),[x,w]=h.useState(null),[C,f]=h.useState("view"),b=async()=>{o(!0),i(null);try{const{data:P,error:W}=await F.from("Suppliers").select("*");if(W)throw W;P&&r(P)}catch(P){console.error("Error fetching suppliers:",P),i(P.message||"Failed to fetch suppliers")}finally{o(!1)}},S=P=>{w(P),f("edit"),p(!0)},A=async P=>{if(confirm("Are you sure you want to delete this supplier?"))try{const{error:W}=await F.from("Suppliers").delete().eq("id",P);if(W)throw W;await b()}catch(W){console.error("Error deleting supplier:",W),i(W.message||"Failed to delete supplier")}},k=async()=>{p(!1),await b()},R=[...t.filter(P=>P.name?.toLowerCase().includes(a.toLowerCase())||P.contact_name?.toLowerCase().includes(a.toLowerCase())||P.email?.toLowerCase().includes(a.toLowerCase())||P.phone?.toLowerCase().includes(a.toLowerCase())||P.address?.toLowerCase().includes(a.toLowerCase()))].sort((P,W)=>P.name.localeCompare(W.name));h.useEffect(()=>{b()},[]);const T=()=>e.jsxs(u,{sx:{width:"100%",minHeight:"100vh"},children:[e.jsxs(je,{padding:"medium",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Suppliers"}),e.jsx(u,{sx:{display:"flex",gap:1,mb:2},children:e.jsx(U,{placeholder:"Search suppliers...",value:a,onChange:P=>c(P.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1}})}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:()=>{w(null),f("add"),p(!0)},sx:{width:"100%",mb:2},children:"Add Supplier"})]}),n&&e.jsx(Ae,{}),l&&e.jsx(u,{sx:{p:2},children:e.jsxs(j,{color:"danger",children:["Error: ",l]})}),e.jsx(u,{sx:{px:2},children:R.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:"No suppliers found"})}):R.map(P=>e.jsx(Se,{variant:"outlined",sx:{mb:2,"&:hover":{boxShadow:"sm"}},children:e.jsx(it,{sx:{p:2},children:e.jsxs(u,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[e.jsx(ce,{size:"md",color:ur(P.name),sx:{flexShrink:0},children:P.image_url?e.jsx("img",{src:P.image_url,alt:P.name}):hr(P.name)}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",mb:1},children:[e.jsx(j,{level:"title-md",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"calc(100% - 40px)"},children:P.name}),e.jsx(qo,{supplier:P,onEdit:S,onDelete:A})]}),e.jsxs(X,{spacing:.5,children:[P.contact_name&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(yt,{sx:{fontSize:16,color:"text.tertiary"}}),e.jsx(j,{level:"body-sm",color:"neutral",children:P.contact_name})]}),P.email&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Vr,{sx:{fontSize:16,color:"text.tertiary"}}),e.jsx(j,{level:"body-sm",color:"neutral",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:P.email})]}),P.phone&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Jr,{sx:{fontSize:16,color:"text.tertiary"}}),e.jsx(j,{level:"body-sm",color:"neutral",children:P.phone})]}),P.address&&e.jsxs(u,{sx:{display:"flex",alignItems:"flex-start",gap:1,mt:.5},children:[e.jsx(oo,{sx:{fontSize:16,color:"text.tertiary",mt:.25}}),e.jsx(j,{level:"body-sm",color:"neutral",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:1.2},children:P.address})]})]})]})]})})},P.id))})]}),M=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Suppliers"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:3,alignItems:"center"},children:[e.jsx(U,{placeholder:"Search suppliers...",value:a,onChange:P=>c(P.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1}}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:()=>{w(null),f("add"),p(!0)},sx:{minWidth:140},children:"Add Supplier"})]}),n&&e.jsx(Ae,{sx:{mb:2}}),l&&e.jsxs(j,{color:"danger",sx:{mb:2},children:["Error: ",l]}),e.jsx(Qe,{container:!0,spacing:2,children:R.length===0?e.jsx(Qe,{xs:12,children:e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:"No suppliers found"})})}):R.map(P=>e.jsx(Qe,{xs:12,md:6,lg:4,children:e.jsx(Se,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(it,{children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(ce,{size:"sm",color:ur(P.name),children:P.image_url?e.jsx("img",{src:P.image_url,alt:P.name}):hr(P.name)}),e.jsx(j,{level:"title-md",fontWeight:"bold",children:P.name})]}),e.jsxs(X,{spacing:1,children:[e.jsxs(j,{level:"body-sm",children:[e.jsx("strong",{children:"Contact:"})," ",P.contact_name||"N/A"]}),e.jsxs(j,{level:"body-sm",children:[e.jsx("strong",{children:"Email:"})," ",P.email||"N/A"]}),e.jsxs(j,{level:"body-sm",children:[e.jsx("strong",{children:"Phone:"})," ",P.phone||"N/A"]}),e.jsxs(j,{level:"body-sm",children:[e.jsx("strong",{children:"Address:"})," ",P.address||"N/A"]})]}),e.jsxs(u,{sx:{display:"flex",gap:1,mt:2},children:[e.jsx(q,{size:"sm",variant:"outlined",startDecorator:e.jsx(lt,{}),onClick:()=>S(P),children:"Edit"}),e.jsx(q,{size:"sm",variant:"outlined",color:"danger",startDecorator:e.jsx(jt,{}),onClick:()=>A(P.id),children:"Delete"})]})]})})},P.id))})]});return e.jsxs(Le,{children:[s?e.jsx(T,{}):e.jsx(M,{}),e.jsx(Xr,{open:d,onClose:()=>p(!1),supplier:x,onSaved:k,mode:C==="edit"||C==="add"?C:void 0})]})};function Uo({orderId:s,editable:t,onItemsChange:r,initialItems:n=[]}){const[o,l]=h.useState(n),[i,a]=h.useState([]),[c,d]=h.useState(!1);h.useEffect(()=>{d(!0),F.from("Products").select("uuid, ProductName").then(({data:C,error:f})=>{f?console.error("Failed to fetch products:",f.message):a(C||[]),d(!1)})},[]);const p=(C,f,b)=>{l(S=>{const A=S.map((k,g)=>g===C?{...k,[f]:b}:k);return r&&r(A),A})},x=()=>{l(C=>{const f=[...C,{product_id:null,quantity_ordered:1,unit_price:0}];return r&&r(f),f})},w=C=>{l(f=>{const b=f.filter((S,A)=>A!==C);return r&&r(b),b})};return e.jsxs(u,{sx:{mt:2},children:[e.jsxs($e,{size:"sm",sx:{minWidth:500},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Total"}),t&&e.jsx("th",{})]})}),e.jsx("tbody",{children:o.map((C,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(Ps,{options:i,getOptionLabel:b=>b.ProductName,value:i.find(b=>b.uuid===C.product_id)||null,onChange:(b,S)=>p(f,"product_id",S?S.uuid:null),disabled:!t,sx:{minWidth:180},isOptionEqualToValue:(b,S)=>b.uuid===S.uuid,required:!0})}),e.jsx("td",{children:e.jsx(U,{type:"number",value:C.quantity_ordered??1,onChange:b=>p(f,"quantity_ordered",Math.max(1,Number(b.target.value))),disabled:!t,sx:{width:80},required:!0})}),e.jsx("td",{children:e.jsx(U,{type:"number",value:C.unit_price??0,onChange:b=>p(f,"unit_price",Math.max(0,Number(b.target.value))),disabled:!t,sx:{width:100},required:!0})}),e.jsx("td",{children:(C.quantity_ordered*C.unit_price).toFixed(2)}),t&&e.jsx("td",{children:e.jsx(q,{size:"sm",color:"danger",onClick:()=>w(f),children:"Remove"})})]},f))})]}),t&&e.jsx(q,{size:"sm",variant:"soft",onClick:x,sx:{mt:1},children:"Add Item"})]})}const Ct=["Pending","Approved","Received","Cancelled"];function Bo({open:s,onClose:t,onCreated:r,mode:n="add",order:o}){const[l,i]=h.useState(o?.order_number||""),[a,c]=h.useState(o?.order_date||new Date().toISOString().slice(0,10)),[d,p]=h.useState(o?.status||"Pending"),[x,w]=h.useState(o?.total?String(o.total):""),[C,f]=h.useState(o?.notes||""),[b,S]=h.useState(o?.supplier_id||null),[A,k]=h.useState(!1),[g,R]=h.useState(null),[T,M]=h.useState([]),[P,W]=h.useState(""),[I,L]=h.useState(!1),[_,N]=h.useState([{product_id:null,quantity_ordered:1,unit_price:0}]);h.useRef(null),h.useEffect(()=>{s?(console.log("[PurchaseOrderForm] Modal opened"),F.from("Suppliers").select("id, name").then(({data:D})=>{M(D||[])}),n==="edit"&&o?.id?F.from("purchaseorderitems").select("*").eq("purchase_order_id",o.id).then(({data:D})=>{N(D||[])}):n==="add"&&N([{product_id:null,quantity_ordered:1,unit_price:0}])):console.log("[PurchaseOrderForm] Modal closed")},[s,n,o]);const v=async D=>{console.log("[PurchaseOrderForm] handleSupplierAdded called");const{data:B}=await F.from("Suppliers").select("id, name");M(B||[]),D&&(S(String(D)),console.log("[PurchaseOrderForm] New supplier set:",D)),L(!1),console.log("[PurchaseOrderForm] SupplierForm closed")},O=async()=>{console.log("[PurchaseOrderForm] handleSave called"),k(!0),R(null);const D={order_date:a,status:d,notes:C,supplier_id:b};n==="edit"&&(D.order_number=l),D.total=x?parseFloat(x):null;let B,xe=o?.id;if(n==="add"?(B=await F.from("PurchaseOrders").insert([D]).select(),!B.error&&B.data&&B.data[0]&&(xe=B.data[0].id)):o&&(B=await F.from("PurchaseOrders").update(D).eq("id",o.id)),B&&!B.error&&n==="add"&&xe&&_.length>0){const Oe=_.filter(ke=>ke.product_id).map(ke=>({purchase_order_id:xe,product_id:ke.product_id,quantity_ordered:ke.quantity_ordered,unit_price:ke.unit_price,notes:ke.notes||null}));if(Oe.length===0){R("Please select a product for each item before saving."),k(!1);return}const ae=await F.from("purchaseorderitems").insert(Oe);if(ae.error){R("Failed to save items: "+ae.error.message),k(!1);return}}k(!1),B?.error?(R(B.error.message),console.log("[PurchaseOrderForm] Save error:",B.error.message)):(r(),t(),i(""),c(new Date().toISOString().slice(0,10)),p("Pending"),w(""),f(""),S(null),W(""),console.log("[PurchaseOrderForm] Purchase order saved and modal closed"))};return e.jsx(_e,{open:s,onClose:t,"aria-labelledby":"purchase-order-form-title",children:e.jsxs(Ee,{sx:{minWidth:400},children:[e.jsx(He,{}),e.jsxs(j,{id:"purchase-order-form-title",level:"title-md",sx:{mb:2},children:[n==="edit"?"Edit":"Add"," Purchase Order"]}),e.jsxs("form",{onSubmit:D=>{D.preventDefault(),O()},children:[e.jsx(U,{type:"date",value:a,onChange:D=>c(D.target.value),sx:{mb:2},required:!0}),e.jsx(ie,{value:d,onChange:(D,B)=>p(B??"Pending"),sx:{mb:2,display:"none"},required:!0,children:Ct.map(D=>e.jsx(z,{value:D,children:D},D))}),n==="edit"&&e.jsx(u,{sx:{mb:2},children:e.jsx(te,{variant:"soft",color:d==="Approved"?"success":d==="Received"?"primary":d==="Cancelled"?"danger":"neutral",sx:{textTransform:"capitalize",fontWeight:600,fontSize:"md",px:1.5,py:.5},onClick:()=>{const D=Ct.indexOf(d);p(Ct[(D+1)%Ct.length])},children:d})}),e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Ps,{options:T,getOptionLabel:D=>D.name,value:T.find(D=>D.id===b)||null,onChange:(D,B)=>S(B?B.id:null),inputValue:P,onInputChange:(D,B)=>W(B),placeholder:"Select supplier",sx:{flex:1,mb:0},isOptionEqualToValue:(D,B)=>D.id===B.id,required:!0}),e.jsx(re,{color:"primary",sx:{ml:1},onClick:()=>L(!0),children:e.jsx(de,{})})]}),e.jsx(Xr,{open:I,onClose:()=>L(!1),onSaved:v,mode:"add"}),n==="edit"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{placeholder:"Order Number",value:l,onChange:D=>i(D.target.value),sx:{mb:2}}),e.jsx(U,{placeholder:"Total",value:x,onChange:D=>w(D.target.value),sx:{mb:2},type:"number",readOnly:!0})]}),e.jsx(U,{placeholder:"Notes",value:C,onChange:D=>f(D.target.value),sx:{mb:2}}),e.jsx(Uo,{orderId:o?.id,editable:n==="add",onItemsChange:N,initialItems:_}),e.jsx(u,{sx:{height:16}}),g&&e.jsx(j,{color:"danger",sx:{mb:1},children:g}),e.jsx(q,{type:"submit",loading:A,disabled:A,variant:"solid",children:"Save"})]})]})})}function Yr(s,t){return function(){return s.apply(t,arguments)}}const{toString:Wo}=Object.prototype,{getPrototypeOf:Ns}=Object,{iterator:Vt,toStringTag:en}=Symbol,Jt=(s=>t=>{const r=Wo.call(t);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ie=s=>(s=s.toLowerCase(),t=>Jt(t)===s),Gt=s=>t=>typeof t===s,{isArray:at}=Array,bt=Gt("undefined");function Ho(s){return s!==null&&!bt(s)&&s.constructor!==null&&!bt(s.constructor)&&Ce(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const tn=Ie("ArrayBuffer");function Vo(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&tn(s.buffer),t}const Jo=Gt("string"),Ce=Gt("function"),sn=Gt("number"),Zt=s=>s!==null&&typeof s=="object",Go=s=>s===!0||s===!1,Ot=s=>{if(Jt(s)!=="object")return!1;const t=Ns(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(en in s)&&!(Vt in s)},Zo=Ie("Date"),Qo=Ie("File"),Ko=Ie("Blob"),Xo=Ie("FileList"),Yo=s=>Zt(s)&&Ce(s.pipe),ei=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||Ce(s.append)&&((t=Jt(s))==="formdata"||t==="object"&&Ce(s.toString)&&s.toString()==="[object FormData]"))},ti=Ie("URLSearchParams"),[si,ri,ni,oi]=["ReadableStream","Request","Response","Headers"].map(Ie),ii=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wt(s,t,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let n,o;if(typeof s!="object"&&(s=[s]),at(s))for(n=0,o=s.length;n<o;n++)t.call(null,s[n],n,s);else{const l=r?Object.getOwnPropertyNames(s):Object.keys(s),i=l.length;let a;for(n=0;n<i;n++)a=l[n],t.call(null,s[a],a,s)}}function rn(s,t){t=t.toLowerCase();const r=Object.keys(s);let n=r.length,o;for(;n-- >0;)if(o=r[n],t===o.toLowerCase())return o;return null}const Ke=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,nn=s=>!bt(s)&&s!==Ke;function fs(){const{caseless:s}=nn(this)&&this||{},t={},r=(n,o)=>{const l=s&&rn(t,o)||o;Ot(t[l])&&Ot(n)?t[l]=fs(t[l],n):Ot(n)?t[l]=fs({},n):at(n)?t[l]=n.slice():t[l]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&wt(arguments[n],r);return t}const li=(s,t,r,{allOwnKeys:n}={})=>(wt(t,(o,l)=>{r&&Ce(o)?s[l]=Yr(o,r):s[l]=o},{allOwnKeys:n}),s),ai=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),ci=(s,t,r,n)=>{s.prototype=Object.create(t.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),r&&Object.assign(s.prototype,r)},di=(s,t,r,n)=>{let o,l,i;const a={};if(t=t||{},s==null)return t;do{for(o=Object.getOwnPropertyNames(s),l=o.length;l-- >0;)i=o[l],(!n||n(i,s,t))&&!a[i]&&(t[i]=s[i],a[i]=!0);s=r!==!1&&Ns(s)}while(s&&(!r||r(s,t))&&s!==Object.prototype);return t},ui=(s,t,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=t.length;const n=s.indexOf(t,r);return n!==-1&&n===r},hi=s=>{if(!s)return null;if(at(s))return s;let t=s.length;if(!sn(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=s[t];return r},xi=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&Ns(Uint8Array)),pi=(s,t)=>{const n=(s&&s[Vt]).call(s);let o;for(;(o=n.next())&&!o.done;){const l=o.value;t.call(s,l[0],l[1])}},fi=(s,t)=>{let r;const n=[];for(;(r=s.exec(t))!==null;)n.push(r);return n},mi=Ie("HTMLFormElement"),gi=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),xr=(({hasOwnProperty:s})=>(t,r)=>s.call(t,r))(Object.prototype),ji=Ie("RegExp"),on=(s,t)=>{const r=Object.getOwnPropertyDescriptors(s),n={};wt(r,(o,l)=>{let i;(i=t(o,l,s))!==!1&&(n[l]=i||o)}),Object.defineProperties(s,n)},bi=s=>{on(s,(t,r)=>{if(Ce(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=s[r];if(Ce(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},yi=(s,t)=>{const r={},n=o=>{o.forEach(l=>{r[l]=!0})};return at(s)?n(s):n(String(s).split(t)),r},wi=()=>{},Si=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function vi(s){return!!(s&&Ce(s.append)&&s[en]==="FormData"&&s[Vt])}const ki=s=>{const t=new Array(10),r=(n,o)=>{if(Zt(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[o]=n;const l=at(n)?[]:{};return wt(n,(i,a)=>{const c=r(i,o+1);!bt(c)&&(l[a]=c)}),t[o]=void 0,l}}return n};return r(s,0)},Ci=Ie("AsyncFunction"),Ri=s=>s&&(Zt(s)||Ce(s))&&Ce(s.then)&&Ce(s.catch),ln=((s,t)=>s?setImmediate:t?((r,n)=>(Ke.addEventListener("message",({source:o,data:l})=>{o===Ke&&l===r&&n.length&&n.shift()()},!1),o=>{n.push(o),Ke.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ce(Ke.postMessage)),Pi=typeof queueMicrotask<"u"?queueMicrotask.bind(Ke):typeof process<"u"&&process.nextTick||ln,_i=s=>s!=null&&Ce(s[Vt]),y={isArray:at,isArrayBuffer:tn,isBuffer:Ho,isFormData:ei,isArrayBufferView:Vo,isString:Jo,isNumber:sn,isBoolean:Go,isObject:Zt,isPlainObject:Ot,isReadableStream:si,isRequest:ri,isResponse:ni,isHeaders:oi,isUndefined:bt,isDate:Zo,isFile:Qo,isBlob:Ko,isRegExp:ji,isFunction:Ce,isStream:Yo,isURLSearchParams:ti,isTypedArray:xi,isFileList:Xo,forEach:wt,merge:fs,extend:li,trim:ii,stripBOM:ai,inherits:ci,toFlatObject:di,kindOf:Jt,kindOfTest:Ie,endsWith:ui,toArray:hi,forEachEntry:pi,matchAll:fi,isHTMLForm:mi,hasOwnProperty:xr,hasOwnProp:xr,reduceDescriptors:on,freezeMethods:bi,toObjectSet:yi,toCamelCase:gi,noop:wi,toFiniteNumber:Si,findKey:rn,global:Ke,isContextDefined:nn,isSpecCompliantForm:vi,toJSONObject:ki,isAsyncFn:Ci,isThenable:Ri,setImmediate:ln,asap:Pi,isIterable:_i};function H(s,t,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}y.inherits(H,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:y.toJSONObject(this.config),code:this.code,status:this.status}}});const an=H.prototype,cn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{cn[s]={value:s}});Object.defineProperties(H,cn);Object.defineProperty(an,"isAxiosError",{value:!0});H.from=(s,t,r,n,o,l)=>{const i=Object.create(an);return y.toFlatObject(s,i,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),H.call(i,s.message,t,r,n,o),i.cause=s,i.name=s.name,l&&Object.assign(i,l),i};const Ei=null;function ms(s){return y.isPlainObject(s)||y.isArray(s)}function dn(s){return y.endsWith(s,"[]")?s.slice(0,-2):s}function pr(s,t,r){return s?s.concat(t).map(function(o,l){return o=dn(o),!r&&l?"["+o+"]":o}).join(r?".":""):t}function Ai(s){return y.isArray(s)&&!s.some(ms)}const Oi=y.toFlatObject(y,{},null,function(t){return/^is[A-Z]/.test(t)});function Qt(s,t,r){if(!y.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,r=y.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,S){return!y.isUndefined(S[b])});const n=r.metaTokens,o=r.visitor||p,l=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&y.isSpecCompliantForm(t);if(!y.isFunction(o))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(y.isDate(f))return f.toISOString();if(y.isBoolean(f))return f.toString();if(!c&&y.isBlob(f))throw new H("Blob is not supported. Use a Buffer instead.");return y.isArrayBuffer(f)||y.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function p(f,b,S){let A=f;if(f&&!S&&typeof f=="object"){if(y.endsWith(b,"{}"))b=n?b:b.slice(0,-2),f=JSON.stringify(f);else if(y.isArray(f)&&Ai(f)||(y.isFileList(f)||y.endsWith(b,"[]"))&&(A=y.toArray(f)))return b=dn(b),A.forEach(function(g,R){!(y.isUndefined(g)||g===null)&&t.append(i===!0?pr([b],R,l):i===null?b:b+"[]",d(g))}),!1}return ms(f)?!0:(t.append(pr(S,b,l),d(f)),!1)}const x=[],w=Object.assign(Oi,{defaultVisitor:p,convertValue:d,isVisitable:ms});function C(f,b){if(!y.isUndefined(f)){if(x.indexOf(f)!==-1)throw Error("Circular reference detected in "+b.join("."));x.push(f),y.forEach(f,function(A,k){(!(y.isUndefined(A)||A===null)&&o.call(t,A,y.isString(k)?k.trim():k,b,w))===!0&&C(A,b?b.concat(k):[k])}),x.pop()}}if(!y.isObject(s))throw new TypeError("data must be an object");return C(s),t}function fr(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Ms(s,t){this._pairs=[],s&&Qt(s,this,t)}const un=Ms.prototype;un.append=function(t,r){this._pairs.push([t,r])};un.toString=function(t){const r=t?function(n){return t.call(this,n,fr)}:fr;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function Ii(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function hn(s,t,r){if(!t)return s;const n=r&&r.encode||Ii;y.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let l;if(o?l=o(t,r):l=y.isURLSearchParams(t)?t.toString():new Ms(t,r).toString(n),l){const i=s.indexOf("#");i!==-1&&(s=s.slice(0,i)),s+=(s.indexOf("?")===-1?"?":"&")+l}return s}class mr{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){y.forEach(this.handlers,function(n){n!==null&&t(n)})}}const xn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Di=typeof URLSearchParams<"u"?URLSearchParams:Ms,Ti=typeof FormData<"u"?FormData:null,zi=typeof Blob<"u"?Blob:null,Li={isBrowser:!0,classes:{URLSearchParams:Di,FormData:Ti,Blob:zi},protocols:["http","https","file","blob","url","data"]},Fs=typeof window<"u"&&typeof document<"u",gs=typeof navigator=="object"&&navigator||void 0,Ni=Fs&&(!gs||["ReactNative","NativeScript","NS"].indexOf(gs.product)<0),Mi=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Fi=Fs&&window.location.href||"http://localhost",qi=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Fs,hasStandardBrowserEnv:Ni,hasStandardBrowserWebWorkerEnv:Mi,navigator:gs,origin:Fi},Symbol.toStringTag,{value:"Module"})),me={...qi,...Li};function $i(s,t){return Qt(s,new me.classes.URLSearchParams,Object.assign({visitor:function(r,n,o,l){return me.isNode&&y.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function Ui(s){return y.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Bi(s){const t={},r=Object.keys(s);let n;const o=r.length;let l;for(n=0;n<o;n++)l=r[n],t[l]=s[l];return t}function pn(s){function t(r,n,o,l){let i=r[l++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),c=l>=r.length;return i=!i&&y.isArray(o)?o.length:i,c?(y.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!a):((!o[i]||!y.isObject(o[i]))&&(o[i]=[]),t(r,n,o[i],l)&&y.isArray(o[i])&&(o[i]=Bi(o[i])),!a)}if(y.isFormData(s)&&y.isFunction(s.entries)){const r={};return y.forEachEntry(s,(n,o)=>{t(Ui(n),o,r,0)}),r}return null}function Wi(s,t,r){if(y.isString(s))try{return(t||JSON.parse)(s),y.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(s)}const St={transitional:xn,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,l=y.isObject(t);if(l&&y.isHTMLForm(t)&&(t=new FormData(t)),y.isFormData(t))return o?JSON.stringify(pn(t)):t;if(y.isArrayBuffer(t)||y.isBuffer(t)||y.isStream(t)||y.isFile(t)||y.isBlob(t)||y.isReadableStream(t))return t;if(y.isArrayBufferView(t))return t.buffer;if(y.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return $i(t,this.formSerializer).toString();if((a=y.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Qt(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return l||o?(r.setContentType("application/json",!1),Wi(t)):t}],transformResponse:[function(t){const r=this.transitional||St.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(y.isResponse(t)||y.isReadableStream(t))return t;if(t&&y.isString(t)&&(n&&!this.responseType||o)){const i=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?H.from(a,H.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:me.classes.FormData,Blob:me.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};y.forEach(["delete","get","head","post","put","patch"],s=>{St.headers[s]={}});const Hi=y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Vi=s=>{const t={};let r,n,o;return s&&s.split(`
`).forEach(function(i){o=i.indexOf(":"),r=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!r||t[r]&&Hi[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},gr=Symbol("internals");function ut(s){return s&&String(s).trim().toLowerCase()}function It(s){return s===!1||s==null?s:y.isArray(s)?s.map(It):String(s)}function Ji(s){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(s);)t[n[1]]=n[2];return t}const Gi=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function rs(s,t,r,n,o){if(y.isFunction(n))return n.call(this,t,r);if(o&&(t=r),!!y.isString(t)){if(y.isString(n))return t.indexOf(n)!==-1;if(y.isRegExp(n))return n.test(t)}}function Zi(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function Qi(s,t){const r=y.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+r,{value:function(o,l,i){return this[n].call(this,t,o,l,i)},configurable:!0})})}let Re=class{constructor(t){t&&this.set(t)}set(t,r,n){const o=this;function l(a,c,d){const p=ut(c);if(!p)throw new Error("header name must be a non-empty string");const x=y.findKey(o,p);(!x||o[x]===void 0||d===!0||d===void 0&&o[x]!==!1)&&(o[x||c]=It(a))}const i=(a,c)=>y.forEach(a,(d,p)=>l(d,p,c));if(y.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(y.isString(t)&&(t=t.trim())&&!Gi(t))i(Vi(t),r);else if(y.isObject(t)&&y.isIterable(t)){let a={},c,d;for(const p of t){if(!y.isArray(p))throw TypeError("Object iterator must return a key-value pair");a[d=p[0]]=(c=a[d])?y.isArray(c)?[...c,p[1]]:[c,p[1]]:p[1]}i(a,r)}else t!=null&&l(r,t,n);return this}get(t,r){if(t=ut(t),t){const n=y.findKey(this,t);if(n){const o=this[n];if(!r)return o;if(r===!0)return Ji(o);if(y.isFunction(r))return r.call(this,o,n);if(y.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=ut(t),t){const n=y.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||rs(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let o=!1;function l(i){if(i=ut(i),i){const a=y.findKey(n,i);a&&(!r||rs(n,n[a],a,r))&&(delete n[a],o=!0)}}return y.isArray(t)?t.forEach(l):l(t),o}clear(t){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const l=r[n];(!t||rs(this,this[l],l,t,!0))&&(delete this[l],o=!0)}return o}normalize(t){const r=this,n={};return y.forEach(this,(o,l)=>{const i=y.findKey(n,l);if(i){r[i]=It(o),delete r[l];return}const a=t?Zi(l):String(l).trim();a!==l&&delete r[l],r[a]=It(o),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return y.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=t&&y.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(o=>n.set(o)),n}static accessor(t){const n=(this[gr]=this[gr]={accessors:{}}).accessors,o=this.prototype;function l(i){const a=ut(i);n[a]||(Qi(o,i),n[a]=!0)}return y.isArray(t)?t.forEach(l):l(t),this}};Re.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);y.reduceDescriptors(Re.prototype,({value:s},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(n){this[r]=n}}});y.freezeMethods(Re);function ns(s,t){const r=this||St,n=t||r,o=Re.from(n.headers);let l=n.data;return y.forEach(s,function(a){l=a.call(r,l,o.normalize(),t?t.status:void 0)}),o.normalize(),l}function fn(s){return!!(s&&s.__CANCEL__)}function ct(s,t,r){H.call(this,s??"canceled",H.ERR_CANCELED,t,r),this.name="CanceledError"}y.inherits(ct,H,{__CANCEL__:!0});function mn(s,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?s(r):t(new H("Request failed with status code "+r.status,[H.ERR_BAD_REQUEST,H.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Ki(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function Xi(s,t){s=s||10;const r=new Array(s),n=new Array(s);let o=0,l=0,i;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),p=n[l];i||(i=d),r[o]=c,n[o]=d;let x=l,w=0;for(;x!==o;)w+=r[x++],x=x%s;if(o=(o+1)%s,o===l&&(l=(l+1)%s),d-i<t)return;const C=p&&d-p;return C?Math.round(w*1e3/C):void 0}}function Yi(s,t){let r=0,n=1e3/t,o,l;const i=(d,p=Date.now())=>{r=p,o=null,l&&(clearTimeout(l),l=null),s.apply(null,d)};return[(...d)=>{const p=Date.now(),x=p-r;x>=n?i(d,p):(o=d,l||(l=setTimeout(()=>{l=null,i(o)},n-x)))},()=>o&&i(o)]}const Ft=(s,t,r=3)=>{let n=0;const o=Xi(50,250);return Yi(l=>{const i=l.loaded,a=l.lengthComputable?l.total:void 0,c=i-n,d=o(c),p=i<=a;n=i;const x={loaded:i,total:a,progress:a?i/a:void 0,bytes:c,rate:d||void 0,estimated:d&&a&&p?(a-i)/d:void 0,event:l,lengthComputable:a!=null,[t?"download":"upload"]:!0};s(x)},r)},jr=(s,t)=>{const r=s!=null;return[n=>t[0]({lengthComputable:r,total:s,loaded:n}),t[1]]},br=s=>(...t)=>y.asap(()=>s(...t)),el=me.hasStandardBrowserEnv?((s,t)=>r=>(r=new URL(r,me.origin),s.protocol===r.protocol&&s.host===r.host&&(t||s.port===r.port)))(new URL(me.origin),me.navigator&&/(msie|trident)/i.test(me.navigator.userAgent)):()=>!0,tl=me.hasStandardBrowserEnv?{write(s,t,r,n,o,l){const i=[s+"="+encodeURIComponent(t)];y.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),y.isString(n)&&i.push("path="+n),y.isString(o)&&i.push("domain="+o),l===!0&&i.push("secure"),document.cookie=i.join("; ")},read(s){const t=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function sl(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function rl(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function gn(s,t,r){let n=!sl(t);return s&&(n||r==!1)?rl(s,t):t}const yr=s=>s instanceof Re?{...s}:s;function Ye(s,t){t=t||{};const r={};function n(d,p,x,w){return y.isPlainObject(d)&&y.isPlainObject(p)?y.merge.call({caseless:w},d,p):y.isPlainObject(p)?y.merge({},p):y.isArray(p)?p.slice():p}function o(d,p,x,w){if(y.isUndefined(p)){if(!y.isUndefined(d))return n(void 0,d,x,w)}else return n(d,p,x,w)}function l(d,p){if(!y.isUndefined(p))return n(void 0,p)}function i(d,p){if(y.isUndefined(p)){if(!y.isUndefined(d))return n(void 0,d)}else return n(void 0,p)}function a(d,p,x){if(x in t)return n(d,p);if(x in s)return n(void 0,d)}const c={url:l,method:l,data:l,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(d,p,x)=>o(yr(d),yr(p),x,!0)};return y.forEach(Object.keys(Object.assign({},s,t)),function(p){const x=c[p]||o,w=x(s[p],t[p],p);y.isUndefined(w)&&x!==a||(r[p]=w)}),r}const jn=s=>{const t=Ye({},s);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:l,headers:i,auth:a}=t;t.headers=i=Re.from(i),t.url=hn(gn(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(y.isFormData(r)){if(me.hasStandardBrowserEnv||me.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...p]=c?c.split(";").map(x=>x.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...p].join("; "))}}if(me.hasStandardBrowserEnv&&(n&&y.isFunction(n)&&(n=n(t)),n||n!==!1&&el(t.url))){const d=o&&l&&tl.read(l);d&&i.set(o,d)}return t},nl=typeof XMLHttpRequest<"u",ol=nl&&function(s){return new Promise(function(r,n){const o=jn(s);let l=o.data;const i=Re.from(o.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:d}=o,p,x,w,C,f;function b(){C&&C(),f&&f(),o.cancelToken&&o.cancelToken.unsubscribe(p),o.signal&&o.signal.removeEventListener("abort",p)}let S=new XMLHttpRequest;S.open(o.method.toUpperCase(),o.url,!0),S.timeout=o.timeout;function A(){if(!S)return;const g=Re.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),T={data:!a||a==="text"||a==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:g,config:s,request:S};mn(function(P){r(P),b()},function(P){n(P),b()},T),S=null}"onloadend"in S?S.onloadend=A:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(A)},S.onabort=function(){S&&(n(new H("Request aborted",H.ECONNABORTED,s,S)),S=null)},S.onerror=function(){n(new H("Network Error",H.ERR_NETWORK,s,S)),S=null},S.ontimeout=function(){let R=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const T=o.transitional||xn;o.timeoutErrorMessage&&(R=o.timeoutErrorMessage),n(new H(R,T.clarifyTimeoutError?H.ETIMEDOUT:H.ECONNABORTED,s,S)),S=null},l===void 0&&i.setContentType(null),"setRequestHeader"in S&&y.forEach(i.toJSON(),function(R,T){S.setRequestHeader(T,R)}),y.isUndefined(o.withCredentials)||(S.withCredentials=!!o.withCredentials),a&&a!=="json"&&(S.responseType=o.responseType),d&&([w,f]=Ft(d,!0),S.addEventListener("progress",w)),c&&S.upload&&([x,C]=Ft(c),S.upload.addEventListener("progress",x),S.upload.addEventListener("loadend",C)),(o.cancelToken||o.signal)&&(p=g=>{S&&(n(!g||g.type?new ct(null,s,S):g),S.abort(),S=null)},o.cancelToken&&o.cancelToken.subscribe(p),o.signal&&(o.signal.aborted?p():o.signal.addEventListener("abort",p)));const k=Ki(o.url);if(k&&me.protocols.indexOf(k)===-1){n(new H("Unsupported protocol "+k+":",H.ERR_BAD_REQUEST,s));return}S.send(l||null)})},il=(s,t)=>{const{length:r}=s=s?s.filter(Boolean):[];if(t||r){let n=new AbortController,o;const l=function(d){if(!o){o=!0,a();const p=d instanceof Error?d:this.reason;n.abort(p instanceof H?p:new ct(p instanceof Error?p.message:p))}};let i=t&&setTimeout(()=>{i=null,l(new H(`timeout ${t} of ms exceeded`,H.ETIMEDOUT))},t);const a=()=>{s&&(i&&clearTimeout(i),i=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(l):d.removeEventListener("abort",l)}),s=null)};s.forEach(d=>d.addEventListener("abort",l));const{signal:c}=n;return c.unsubscribe=()=>y.asap(a),c}},ll=function*(s,t){let r=s.byteLength;if(r<t){yield s;return}let n=0,o;for(;n<r;)o=n+t,yield s.slice(n,o),n=o},al=async function*(s,t){for await(const r of cl(s))yield*ll(r,t)},cl=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},wr=(s,t,r,n)=>{const o=al(s,t);let l=0,i,a=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:p}=await o.next();if(d){a(),c.close();return}let x=p.byteLength;if(r){let w=l+=x;r(w)}c.enqueue(new Uint8Array(p))}catch(d){throw a(d),d}},cancel(c){return a(c),o.return()}},{highWaterMark:2})},Kt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",bn=Kt&&typeof ReadableStream=="function",dl=Kt&&(typeof TextEncoder=="function"?(s=>t=>s.encode(t))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),yn=(s,...t)=>{try{return!!s(...t)}catch{return!1}},ul=bn&&yn(()=>{let s=!1;const t=new Request(me.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!t}),Sr=64*1024,js=bn&&yn(()=>y.isReadableStream(new Response("").body)),qt={stream:js&&(s=>s.body)};Kt&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!qt[t]&&(qt[t]=y.isFunction(s[t])?r=>r[t]():(r,n)=>{throw new H(`Response type '${t}' is not supported`,H.ERR_NOT_SUPPORT,n)})})})(new Response);const hl=async s=>{if(s==null)return 0;if(y.isBlob(s))return s.size;if(y.isSpecCompliantForm(s))return(await new Request(me.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(y.isArrayBufferView(s)||y.isArrayBuffer(s))return s.byteLength;if(y.isURLSearchParams(s)&&(s=s+""),y.isString(s))return(await dl(s)).byteLength},xl=async(s,t)=>{const r=y.toFiniteNumber(s.getContentLength());return r??hl(t)},pl=Kt&&(async s=>{let{url:t,method:r,data:n,signal:o,cancelToken:l,timeout:i,onDownloadProgress:a,onUploadProgress:c,responseType:d,headers:p,withCredentials:x="same-origin",fetchOptions:w}=jn(s);d=d?(d+"").toLowerCase():"text";let C=il([o,l&&l.toAbortSignal()],i),f;const b=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let S;try{if(c&&ul&&r!=="get"&&r!=="head"&&(S=await xl(p,n))!==0){let T=new Request(t,{method:"POST",body:n,duplex:"half"}),M;if(y.isFormData(n)&&(M=T.headers.get("content-type"))&&p.setContentType(M),T.body){const[P,W]=jr(S,Ft(br(c)));n=wr(T.body,Sr,P,W)}}y.isString(x)||(x=x?"include":"omit");const A="credentials"in Request.prototype;f=new Request(t,{...w,signal:C,method:r.toUpperCase(),headers:p.normalize().toJSON(),body:n,duplex:"half",credentials:A?x:void 0});let k=await fetch(f,w);const g=js&&(d==="stream"||d==="response");if(js&&(a||g&&b)){const T={};["status","statusText","headers"].forEach(I=>{T[I]=k[I]});const M=y.toFiniteNumber(k.headers.get("content-length")),[P,W]=a&&jr(M,Ft(br(a),!0))||[];k=new Response(wr(k.body,Sr,P,()=>{W&&W(),b&&b()}),T)}d=d||"text";let R=await qt[y.findKey(qt,d)||"text"](k,s);return!g&&b&&b(),await new Promise((T,M)=>{mn(T,M,{data:R,headers:Re.from(k.headers),status:k.status,statusText:k.statusText,config:s,request:f})})}catch(A){throw b&&b(),A&&A.name==="TypeError"&&/Load failed|fetch/i.test(A.message)?Object.assign(new H("Network Error",H.ERR_NETWORK,s,f),{cause:A.cause||A}):H.from(A,A&&A.code,s,f)}}),bs={http:Ei,xhr:ol,fetch:pl};y.forEach(bs,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const vr=s=>`- ${s}`,fl=s=>y.isFunction(s)||s===null||s===!1,wn={getAdapter:s=>{s=y.isArray(s)?s:[s];const{length:t}=s;let r,n;const o={};for(let l=0;l<t;l++){r=s[l];let i;if(n=r,!fl(r)&&(n=bs[(i=String(r)).toLowerCase()],n===void 0))throw new H(`Unknown adapter '${i}'`);if(n)break;o[i||"#"+l]=n}if(!n){const l=Object.entries(o).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=t?l.length>1?`since :
`+l.map(vr).join(`
`):" "+vr(l[0]):"as no adapter specified";throw new H("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:bs};function os(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new ct(null,s)}function kr(s){return os(s),s.headers=Re.from(s.headers),s.data=ns.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),wn.getAdapter(s.adapter||St.adapter)(s).then(function(n){return os(s),n.data=ns.call(s,s.transformResponse,n),n.headers=Re.from(n.headers),n},function(n){return fn(n)||(os(s),n&&n.response&&(n.response.data=ns.call(s,s.transformResponse,n.response),n.response.headers=Re.from(n.response.headers))),Promise.reject(n)})}const Sn="1.10.0",Xt={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{Xt[s]=function(n){return typeof n===s||"a"+(t<1?"n ":" ")+s}});const Cr={};Xt.transitional=function(t,r,n){function o(l,i){return"[Axios v"+Sn+"] Transitional option '"+l+"'"+i+(n?". "+n:"")}return(l,i,a)=>{if(t===!1)throw new H(o(i," has been removed"+(r?" in "+r:"")),H.ERR_DEPRECATED);return r&&!Cr[i]&&(Cr[i]=!0,console.warn(o(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,i,a):!0}};Xt.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function ml(s,t,r){if(typeof s!="object")throw new H("options must be an object",H.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let o=n.length;for(;o-- >0;){const l=n[o],i=t[l];if(i){const a=s[l],c=a===void 0||i(a,l,s);if(c!==!0)throw new H("option "+l+" must be "+c,H.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new H("Unknown option "+l,H.ERR_BAD_OPTION)}}const Dt={assertOptions:ml,validators:Xt},De=Dt.validators;let Xe=class{constructor(t){this.defaults=t||{},this.interceptors={request:new mr,response:new mr}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const l=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ye(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:l}=r;n!==void 0&&Dt.assertOptions(n,{silentJSONParsing:De.transitional(De.boolean),forcedJSONParsing:De.transitional(De.boolean),clarifyTimeoutError:De.transitional(De.boolean)},!1),o!=null&&(y.isFunction(o)?r.paramsSerializer={serialize:o}:Dt.assertOptions(o,{encode:De.function,serialize:De.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Dt.assertOptions(r,{baseUrl:De.spelling("baseURL"),withXsrfToken:De.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=l&&y.merge(l.common,l[r.method]);l&&y.forEach(["delete","get","head","post","put","patch","common"],f=>{delete l[f]}),r.headers=Re.concat(i,l);const a=[];let c=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(c=c&&b.synchronous,a.unshift(b.fulfilled,b.rejected))});const d=[];this.interceptors.response.forEach(function(b){d.push(b.fulfilled,b.rejected)});let p,x=0,w;if(!c){const f=[kr.bind(this),void 0];for(f.unshift.apply(f,a),f.push.apply(f,d),w=f.length,p=Promise.resolve(r);x<w;)p=p.then(f[x++],f[x++]);return p}w=a.length;let C=r;for(x=0;x<w;){const f=a[x++],b=a[x++];try{C=f(C)}catch(S){b.call(this,S);break}}try{p=kr.call(this,C)}catch(f){return Promise.reject(f)}for(x=0,w=d.length;x<w;)p=p.then(d[x++],d[x++]);return p}getUri(t){t=Ye(this.defaults,t);const r=gn(t.baseURL,t.url,t.allowAbsoluteUrls);return hn(r,t.params,t.paramsSerializer)}};y.forEach(["delete","get","head","options"],function(t){Xe.prototype[t]=function(r,n){return this.request(Ye(n||{},{method:t,url:r,data:(n||{}).data}))}});y.forEach(["post","put","patch"],function(t){function r(n){return function(l,i,a){return this.request(Ye(a||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:i}))}}Xe.prototype[t]=r(),Xe.prototype[t+"Form"]=r(!0)});let gl=class vn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(o=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](o);n._listeners=null}),this.promise.then=o=>{let l;const i=new Promise(a=>{n.subscribe(a),l=a}).then(o);return i.cancel=function(){n.unsubscribe(l)},i},t(function(l,i,a){n.reason||(n.reason=new ct(l,i,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new vn(function(o){t=o}),cancel:t}}};function jl(s){return function(r){return s.apply(null,r)}}function bl(s){return y.isObject(s)&&s.isAxiosError===!0}const ys={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ys).forEach(([s,t])=>{ys[t]=s});function kn(s){const t=new Xe(s),r=Yr(Xe.prototype.request,t);return y.extend(r,Xe.prototype,t,{allOwnKeys:!0}),y.extend(r,t,null,{allOwnKeys:!0}),r.create=function(o){return kn(Ye(s,o))},r}const le=kn(St);le.Axios=Xe;le.CanceledError=ct;le.CancelToken=gl;le.isCancel=fn;le.VERSION=Sn;le.toFormData=Qt;le.AxiosError=H;le.Cancel=le.CanceledError;le.all=function(t){return Promise.all(t)};le.spread=jl;le.isAxiosError=bl;le.mergeConfig=Ye;le.AxiosHeaders=Re;le.formToJSON=s=>pn(y.isHTMLForm(s)?new FormData(s):s);le.getAdapter=wn.getAdapter;le.HttpStatusCode=ys;le.default=le;const{Axios:Oa,AxiosError:Ia,CanceledError:Da,isCancel:Ta,CancelToken:za,VERSION:La,all:Na,Cancel:Ma,isAxiosError:Fa,spread:qa,toFormData:$a,AxiosHeaders:Ua,HttpStatusCode:Ba,formToJSON:Wa,getAdapter:Ha,mergeConfig:Va}=le;async function yl(s,t){try{console.log("Sending to backend:",{purchaseOrderId:s,items:t});const r=await le.post("/api/receive-purchase-order",{purchaseOrderId:s,items:t});console.log("Purchase order received successfully:",r.data)}catch(r){throw console.error("Error receiving purchase order:",r),new Error("Failed to receive purchase order")}}const wl=({open:s,onClose:t,poId:r,orderNumber:n,items:o,onConfirm:l})=>{const[i,a]=h.useState([]),[c,d]=h.useState(!0),[p,x]=h.useState(!1);h.useEffect(()=>{s&&(d(!0),a(o.map(f=>({id:f.id,product_id:f.product_id,ProductName:f.ProductName,quantity_ordered:f.quantity_ordered??0,quantity_received:f.quantity_received??f.quantity_ordered??0}))),d(!1))},[o,s]);const w=(f,b)=>{let S=0;if(b==="")S=0;else if(/^\d+$/.test(b))S=parseInt(b,10);else return;a(A=>A.map(k=>k.id===f?{...k,quantity_received:S}:k))},C=async()=>{try{const f=i.map(({product_id:b,quantity_received:S})=>({product_id:String(b),quantity_received:S}));await yl(String(r),f),x(!0),t()}catch(f){console.error("Error receiving purchase order:",f),alert("Failed to receive purchase order. Please try again.")}};return e.jsxs(e.Fragment,{children:[e.jsx(_e,{open:s,onClose:t,"aria-labelledby":"receive-po-dialog-title",children:e.jsxs(Ee,{sx:{minWidth:400},children:[e.jsx(He,{}),e.jsxs(j,{id:"receive-po-dialog-title",level:"h4",sx:{mb:2},children:["Receive Purchase Order #",n??r]}),c?e.jsx(j,{children:"Loading items..."}):i.length===0?e.jsx(j,{children:"No items found for this purchase order."}):e.jsxs($e,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Ordered"}),e.jsx("th",{children:"Received"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:i.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:f.ProductName}),e.jsx("td",{children:f.quantity_ordered}),e.jsx("td",{children:e.jsx(U,{type:"number",value:f.quantity_received===0&&i.find(b=>b.id===f.id)?.quantity_received===0?"0":f.quantity_received,onChange:b=>w(f.id,b.target.value),sx:{width:80},slotProps:{input:{min:0,max:f.quantity_ordered}}})}),e.jsx("td",{style:{textAlign:"center"},children:f.quantity_received===f.quantity_ordered?e.jsx(Is,{sx:{color:"#2e7d32"},titleAccess:"Received in full"}):e.jsx(Gr,{sx:{color:"#d32f2f"},titleAccess:"Not fully received"})})]},f.id))})]}),e.jsxs(u,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:3},children:[e.jsx(q,{variant:"plain",onClick:t,children:"Cancel"}),e.jsx(q,{variant:"solid",onClick:C,children:"Receive"})]})]})}),e.jsx(Wt,{open:p,autoHideDuration:3e3,onClose:()=>x(!1),color:"success",variant:"soft",anchorOrigin:{vertical:"top",horizontal:"center"},children:"Purchase order received successfully!"})]})},Rr={Pending:0,Ordered:1,Approved:2,Received:3,Cancelled:4},We={fontSize:K.sizes.small},Ge={...We,fontWeight:600,borderBottom:"1.5px solid #e0e0e0",background:"inherit"},Rt=s=>{switch(s){case"Pending":return"warning";case"Ordered":return"primary";case"Approved":return"primary";case"Received":return"success";case"Cancelled":return"danger";default:return"neutral"}},Sl=s=>{switch(s){case"Pending":return e.jsx(nr,{});case"Ordered":return e.jsx(Lt,{});case"Approved":return e.jsx(Lt,{});case"Received":return e.jsx(Is,{});case"Cancelled":return e.jsx(Gr,{});default:return e.jsx(nr,{})}},vl=()=>{const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState(!1),[l,i]=h.useState(null),[a,c]=h.useState(""),[d,p]=h.useState(""),[x,w]=h.useState(!1),[C,f]=h.useState(!1),[b,S]=h.useState(null),[A,k]=h.useState([]),g=async()=>{o(!0),i(null);try{const{data:v,error:O}=await F.from("PurchaseOrders").select("id, order_number, order_date, status, total, notes, Suppliers(name)").order("order_date",{ascending:!1});if(O)throw O;if(v){const D=v.map(B=>({...B,supplier_name:B.Suppliers?.[0]?.name||"N/A",Suppliers:void 0}));r(D)}}catch(v){i(v.message||"Failed to fetch purchase orders")}finally{o(!1)}},R=async v=>{try{const{data:O,error:D}=await F.from("purchaseorderitems").select("id, product_id, Products(ProductName), quantity_ordered, quantity_received").eq("purchase_order_id",v);if(D)throw D;if(O){const B=O.map(xe=>({...xe,ProductName:xe.Products?.[0]?.ProductName||"Unknown Product"}));k(B)}}catch(O){console.error("Error fetching PO items:",O)}},T=async()=>{await g()},M=async(v,O)=>{try{const{error:D}=await F.from("PurchaseOrders").update({status:O}).eq("id",v);if(D)throw D;await g()}catch(D){i(D.message||"Failed to update order status")}},P=async v=>{S(v),await R(v.id),f(!0)},W=async v=>{try{for(const O of v)await F.from("purchaseorderitems").update({quantity_received:O.quantity_received}).eq("id",O.id);b?.id&&await F.from("PurchaseOrders").update({status:"Received"}).eq("id",b.id),f(!1),S(null),await g()}catch(O){i(O.message||"Failed to receive order")}},L=[...t.filter(v=>{const O=v.order_number?.toString().toLowerCase().includes(a.toLowerCase())||v.supplier_name?.toLowerCase().includes(a.toLowerCase()),D=d?v.status===d:!0;return O&&D})].sort((v,O)=>{const D=Rr[v.status]??99,B=Rr[O.status]??99;return D!==B?D-B:new Date(O.order_date).getTime()-new Date(v.order_date).getTime()});h.useEffect(()=>{g()},[]);const _=()=>e.jsxs(u,{sx:{width:"100%",minHeight:"100vh"},children:[e.jsxs(je,{padding:"medium",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Purchase Orders"}),e.jsxs(u,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(U,{placeholder:"Search orders...",value:a,onChange:v=>c(v.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1}}),e.jsxs(ie,{placeholder:"Status",value:d,onChange:(v,O)=>p(O??""),sx:{minWidth:120},children:[e.jsx(z,{value:"",children:"All"}),e.jsx(z,{value:"Pending",children:"Pending"}),e.jsx(z,{value:"Ordered",children:"Ordered"}),e.jsx(z,{value:"Approved",children:"Approved"}),e.jsx(z,{value:"Received",children:"Received"}),e.jsx(z,{value:"Cancelled",children:"Cancelled"})]})]}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:()=>w(!0),sx:{width:"100%",mb:2},children:"Add Purchase Order"})]}),n&&e.jsx(Ae,{}),l&&e.jsx(u,{sx:{p:2},children:e.jsxs(j,{color:"danger",children:["Error: ",l]})}),e.jsx(u,{children:L.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:"No purchase orders found"})}):L.map(v=>e.jsx(u,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider","&:hover":{bgcolor:"background.level1"}},children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(u,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:`${Rt(v.status)}.100`,color:`${Rt(v.status)}.600`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",flexShrink:0},children:Sl(v.status)}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsxs(j,{level:"title-sm",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%"},children:["Order #",v.order_number]}),e.jsx(te,{size:"sm",color:Rt(v.status),variant:"soft",sx:{fontWeight:"bold",minWidth:"fit-content"},children:v.status})]}),e.jsxs(j,{level:"body-xs",color:"neutral",sx:{mb:.5},children:[v.supplier_name," • ",new Date(v.order_date).toLocaleDateString()]}),e.jsxs(j,{level:"body-sm",sx:{fontWeight:"bold",color:"text.primary"},children:["Total: $",v.total?.toFixed(2)||"0.00"]}),e.jsx(u,{sx:{display:"flex",gap:1,mt:1},children:v.status==="Pending"?e.jsx(q,{size:"sm",variant:"outlined",onClick:()=>M(v.id,"Ordered"),children:"Order"}):e.jsx(q,{size:"sm",variant:"outlined",onClick:()=>P(v),disabled:v.status!=="Approved"&&v.status!=="Ordered",children:"Receive"})})]})]})},v.id))})]}),N=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Purchase Orders"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(U,{placeholder:"Search purchase orders...",sx:{flex:1},value:a,onChange:v=>c(v.target.value),startDecorator:e.jsx(ge,{})}),e.jsxs(ie,{placeholder:"Filter status",value:d,onChange:(v,O)=>p(O??""),sx:{minWidth:160},children:[e.jsx(z,{value:"",children:"All Statuses"}),e.jsx(z,{value:"Pending",children:"Pending"}),e.jsx(z,{value:"Ordered",children:"Ordered"}),e.jsx(z,{value:"Approved",children:"Approved"}),e.jsx(z,{value:"Received",children:"Received"}),e.jsx(z,{value:"Cancelled",children:"Cancelled"})]}),e.jsx(q,{onClick:()=>w(!0),variant:"solid",startDecorator:e.jsx(de,{}),children:"Add Purchase Order"})]}),e.jsxs(Se,{sx:{overflow:"visible"},children:[n&&e.jsx(Ae,{}),l&&e.jsxs(j,{color:"danger",children:["Error: ",l]}),e.jsxs($e,{"aria-label":"Purchase Orders",sx:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:Ge,children:"Order Number"}),e.jsx("th",{style:Ge,children:"Order Date"}),e.jsx("th",{style:Ge,children:"Status"}),e.jsx("th",{style:Ge,children:"Total"}),e.jsx("th",{style:Ge,children:"Supplier"}),e.jsx("th",{style:Ge,children:"Notes"}),e.jsx("th",{style:{width:120,...Ge},children:"Actions"})]})}),e.jsxs("tbody",{children:[L.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"#888",...We},children:"No purchase orders found."})}),L.map(v=>e.jsxs("tr",{style:{cursor:"pointer",height:48},children:[e.jsx("td",{style:We,children:v.order_number}),e.jsx("td",{style:We,children:new Date(v.order_date).toLocaleDateString()}),e.jsx("td",{style:We,children:e.jsx(te,{size:"sm",color:Rt(v.status),variant:"soft",children:v.status})}),e.jsxs("td",{style:We,children:["$",v.total?.toFixed(2)||"0.00"]}),e.jsx("td",{style:We,children:v.supplier_name}),e.jsx("td",{style:We,children:v.notes||"-"}),e.jsx("td",{children:v.status==="Pending"?e.jsx(q,{size:"sm",variant:"outlined",onClick:()=>M(v.id,"Ordered"),children:"Order"}):e.jsx(q,{size:"sm",variant:"outlined",onClick:()=>P(v),disabled:v.status!=="Approved"&&v.status!=="Ordered",children:"Receive"})})]},v.id))]})]})]})]});return e.jsxs(Le,{children:[s?e.jsx(_,{}):e.jsx(N,{}),e.jsx(Bo,{open:x,onClose:()=>w(!1),onCreated:T,mode:"add",order:void 0}),e.jsx(wl,{open:C&&!!b?.id,onClose:()=>{f(!1),S(null)},poId:b?.id||"",orderNumber:b?.order_number||"",items:A.filter(v=>!!v.id&&!!v.product_id),onConfirm:W})]})};function kl({value:s,onChange:t,toggleSidebar:r}){const n=Ts(),[o,l]=h.useState(!1),[i,a]=h.useState("Sales");if(n.pathname==="/login")return null;const c=h.useMemo(()=>Fn({components:{MuiTableRow:{styleOverrides:{root:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}}}}}),[]);_o.filter(x=>x.showInMobile);const d=i?At[i].filter(x=>x.showInMobile):[],p=async x=>{const{data:w}=await F.auth.getSession();if(!w&&["orders","products","users","suppliers","purchaseorders","tickets","smscampaigns","movements"].includes(x)){console.warn("Authentication required for this page"),t("home");return}t(x)};return e.jsxs(qn,{theme:c,children:[e.jsxs($n,{open:o,onClose:()=>l(!1),children:[e.jsx(Un,{children:"Select Area"}),e.jsx(Bn,{children:["Sales","Support","Marketing","Operations"].map(x=>e.jsx(Qs,{fullWidth:!0,variant:i===x?"contained":"outlined",onClick:()=>{a(x),l(!1)},sx:{my:1},children:x},x))}),e.jsx(Wn,{children:e.jsx(Qs,{onClick:()=>l(!1),children:"Close"})})]}),e.jsx(Hn,{sx:{position:"fixed",bottom:0,left:0,right:0,zIndex:9999,backgroundColor:"rgba(0, 0, 255, 0.2)",overflow:"hidden"},children:e.jsx("div",{style:{display:"flex",flexDirection:"row",overflowX:"auto"},children:e.jsxs(Vn,{showLabels:!0,value:s,onChange:(x,w)=>{p(w)},sx:{minWidth:"max-content",flex:1},children:[d.map(x=>e.jsx(Ks,{label:x.label,icon:x.icon,value:x.value,onClick:()=>p(x.value)},x.value)),e.jsx(Ks,{label:i||"",icon:e.jsx(lo,{}),onClick:x=>{x.stopPropagation(),l(!0)}})]})})})]})}function is({open:s,onClose:t,onCreated:r}){const[n,o]=h.useState(""),[l,i]=h.useState(""),[a,c]=h.useState(!1),[d,p]=h.useState(null),x=async w=>{w.preventDefault(),c(!0),p(null);const C={subject:n,requester_name:l,status:"Open"};console.log("[DialogTicketCreate] Creating ticket with payload:",C);const{error:f,data:b}=await F.from("tickets").insert(C);f&&(p(f.message||JSON.stringify(f)),console.error("[DialogTicketCreate] Error creating ticket:",f)),c(!1),f||(o(""),i(""),t(),r&&r())};return e.jsx(_e,{open:s,onClose:t,children:e.jsxs(Ee,{sx:{minWidth:400},children:[e.jsx(j,{level:"title-md",sx:{mb:2},children:"Create Ticket"}),e.jsxs("form",{onSubmit:x,children:[e.jsx(U,{placeholder:"Subject",value:n,onChange:w=>o(w.target.value),sx:{mb:2},required:!0}),e.jsx(U,{placeholder:"Requester Name",value:l,onChange:w=>i(w.target.value),sx:{mb:2},required:!0}),d&&e.jsx(j,{color:"danger",sx:{mb:1},children:d}),e.jsx(q,{type:"submit",loading:a,disabled:a||!n||!l,variant:"solid",children:"Create"})]})]})})}const Cl=["Refund issued","Replacement sent","Order cancelled","Technical support provided","Information provided","Awaiting customer response","Other"],Rl=({open:s,onClose:t,onSubmit:r})=>{const[n,o]=G.useState(""),[l,i]=G.useState("");return G.useEffect(()=>{s||(o(""),i(""))},[s]),e.jsx(_e,{open:s,onClose:t,children:e.jsxs(Ee,{children:[e.jsx(ks,{children:"Resolve Ticket"}),e.jsxs(Cs,{sx:{display:"flex",flexDirection:"column",gap:2,minWidth:320},children:[e.jsx(ie,{value:n,onChange:(a,c)=>o(c||""),placeholder:"Select resolution",required:!0,children:Cl.map(a=>e.jsx(z,{value:a,children:a},a))}),e.jsx(xs,{minRows:3,placeholder:"Resolution comment to customer...",value:l,onChange:a=>i(a.target.value)})]}),e.jsxs(Rs,{children:[e.jsx(q,{variant:"plain",onClick:t,children:"Cancel"}),e.jsx(q,{variant:"solid",color:"primary",disabled:!n,onClick:()=>{try{r(n,l),t()}catch(a){console.error("Error during form submission:",a)}},children:"Submit"})]})]})})},ls=Ls(Rl),Pr=s=>{if(!s)return"";const t=new Date(s),n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return"Just now";const o=Math.floor(n/60);if(o<60)return`${o} min ago`;const l=Math.floor(o/60);if(l<24)return`${l} hour${l>1?"s":""} ago`;const i=Math.floor(l/24);if(i<7)return`${i} day${i>1?"s":""} ago`;const a=Math.floor(i/7);if(a<4)return`${a} week${a>1?"s":""} ago`;const c=Math.floor(i/30);return`${c} month${c>1?"s":""} ago`},ht={Open:{color:"success",label:"Open"},Pending:{color:"warning",label:"Pending"},Closed:{color:"neutral",label:"Closed"}};function Pl(){const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState(null),[l,i]=h.useState([]),[a,c]=h.useState(""),[d,p]=h.useState(""),[x,w]=h.useState("Open"),[C,f]=h.useState(!1),[b,S]=h.useState(!1),[A,k]=h.useState(!1);h.useEffect(()=>{(async()=>{const{data:L,error:_}=await F.from("tickets").select("*").order("created_at",{ascending:!1});_||r(L||[])})()},[]),h.useEffect(()=>{if(!n){i([]);return}(async()=>{const{data:L,error:_}=await F.from("ticketactivities").select("*").eq("ticket_id",n).order("timestamp",{ascending:!0});_||i(L||[])})()},[n]);const g=async()=>{const{data:I,error:L}=await F.from("tickets").select("*").order("created_at",{ascending:!1});L||r(I||[])},R=async()=>{if(a.trim()&&n){console.log("Sending message:",{ticket_id:n,message:a,activity_type:"chat",sender_name:"You"});const{error:I,data:L}=await F.from("ticketactivities").insert({ticket_id:n,message:a,activity_type:"chat",sender_name:"You"}).select();if(I){console.error("Error sending message:",I),alert("Failed to send message: "+I.message);return}console.log("Message sent successfully:",L),c("");const{data:_,error:N}=await F.from("ticketactivities").select("*").eq("ticket_id",n).order("timestamp",{ascending:!0});N?console.error("Error fetching activities:",N):(console.log("Refreshed activities:",_),i(_||[]))}},T=async(I,L)=>{if(n)try{const{error:_}=await F.from("tickets").update({status:"Closed"}).eq("id",n);if(_){console.error("Error updating ticket status:",_),alert("Failed to resolve ticket: "+_.message);return}const{error:N}=await F.from("ticketactivities").insert({ticket_id:n,message:`Ticket resolved: ${I}${L?` - ${L}`:""}`,activity_type:"chat",sender_name:"You"});N&&console.error("Error adding resolution activity:",N),await g();const{data:v}=await F.from("ticketactivities").select("*").eq("ticket_id",n).order("timestamp",{ascending:!0});i(v||[])}catch(_){console.error("Error resolving ticket:",_),alert("Failed to resolve ticket")}},M=I=>{o(I),k(!0)},P=()=>{k(!1),o(null)},W=t.filter(I=>{if(x!=="All"&&I.status!==x)return!1;if(!d)return!0;const L=d.toLowerCase();return I.subject?.toLowerCase().includes(L)||I.requester_name?.toLowerCase().includes(L)||I.status?.toLowerCase().includes(L)});if(s){const I=t.length>0&&t.every(L=>L.status==="Closed")&&x==="Open";if(A&&n){const L=t.find(_=>_.id===n);return e.jsxs(Le,{children:[e.jsxs(u,{sx:{display:"flex",flexDirection:"column",height:"100vh"},children:[e.jsxs(u,{sx:{px:2,py:1.5,borderBottom:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",gap:2,bgcolor:"background.surface"},children:[e.jsx(re,{size:"sm",variant:"plain",onClick:P,children:e.jsx(ao,{})}),e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:L?.requester_name?.[0]?.toUpperCase()||"?"}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:600,mb:.5},children:L?.subject||"Untitled"}),e.jsx(j,{level:"body-xs",color:"neutral",children:L?.requester_name})]}),e.jsx(te,{variant:"soft",size:"sm",color:ht[L?.status||"Open"]?.color,sx:{fontWeight:600},children:ht[L?.status||"Open"]?.label}),L?.status!=="Closed"&&e.jsx(q,{variant:"solid",color:"primary",size:"sm",onClick:()=>S(!0),children:"Resolve"})]}),e.jsx(u,{sx:{flex:1,overflowY:"auto",px:2,py:2},children:e.jsx(X,{spacing:3,children:l.map((_,N)=>{const v=_.sender_name==="You";return e.jsxs(u,{children:[N===0||new Date(_.timestamp||"").toDateString()!==new Date(l[N-1]?.timestamp||"").toDateString()?e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(u,{sx:{flex:1,height:"1px",bgcolor:"divider"}}),e.jsx(j,{level:"body-xs",sx:{mx:2,color:"text.secondary"},children:_.timestamp?new Date(_.timestamp).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}):""}),e.jsx(u,{sx:{flex:1,height:"1px",bgcolor:"divider"}})]}):null,e.jsxs(X,{direction:"row",spacing:1,sx:{alignItems:"flex-start"},children:[!v&&e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:_.sender_name?.[0]?.toUpperCase()||"?"}),e.jsx(u,{sx:{flex:1,display:"flex",flexDirection:v?"row-reverse":"row"},children:e.jsxs(u,{sx:{maxWidth:"85%",bgcolor:v?"primary.500":"neutral.50",color:v?"white":"text.primary",borderRadius:v?"18px 18px 4px 18px":"18px 18px 18px 4px",px:2,py:1.5,position:"relative",boxShadow:"sm"},children:[!v&&e.jsx(j,{level:"body-xs",sx:{fontWeight:600,mb:.5,color:v?"white":"text.primary"},children:_.sender_name}),e.jsx(j,{level:"body-sm",sx:{lineHeight:1.4,color:v?"white":"text.primary"},children:_.message})]})}),v&&e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:_.sender_name?.[0]?.toUpperCase()||"?"})]}),e.jsx(u,{sx:{display:"flex",justifyContent:v?"flex-end":"flex-start",mt:.5,ml:v?0:5},children:e.jsx(j,{level:"body-xs",sx:{color:"text.tertiary"},children:_.timestamp?new Date(_.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):""})})]},_.id)})})}),e.jsx(u,{sx:{px:2,py:1.5,borderTop:"1px solid",borderColor:"divider",bgcolor:"background.surface"},children:e.jsxs(X,{direction:"row",spacing:1,alignItems:"flex-end",children:[e.jsx(u,{sx:{flex:1},children:e.jsx(xs,{placeholder:"Type something here...",value:a,onChange:_=>c(_.target.value),minRows:1,maxRows:3,sx:{borderRadius:"20px",border:"1px solid",borderColor:"neutral.300","&:focus-within":{borderColor:"primary.500"},"& textarea":{border:"none",outline:"none",resize:"none",px:2,py:1}},onKeyDown:_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),R())}})}),e.jsx(q,{onClick:R,disabled:!a.trim(),variant:"solid",color:"primary",size:"sm",sx:{borderRadius:"20px",minWidth:50,height:36,fontWeight:600},children:"Send"})]})})]}),e.jsx(is,{open:C,onClose:()=>f(!1),onCreated:g}),e.jsx(ls,{open:b,onClose:()=>S(!1),onSubmit:T})]})}return e.jsxs(Le,{children:[e.jsxs(u,{sx:{p:2},children:[e.jsx(j,{level:"h2",sx:{mb:3,fontWeight:600},children:"Tickets"}),e.jsxs(X,{spacing:2,sx:{mb:2},children:[e.jsxs(X,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(U,{placeholder:"Search tickets...",startDecorator:e.jsx(ge,{}),value:d,onChange:L=>p(L.target.value),size:"sm",sx:{flex:1}}),e.jsx(re,{size:"sm",variant:"soft",color:"primary",onClick:()=>f(!0),children:e.jsx(de,{})})]}),e.jsxs(ie,{value:x,onChange:(L,_)=>w(_),size:"sm",placeholder:"Filter by status",children:[e.jsx(z,{value:"All",children:"All Tickets"}),e.jsx(z,{value:"Open",children:"Open"}),e.jsx(z,{value:"Pending",children:"Pending"}),e.jsx(z,{value:"Closed",children:"Closed"})]})]}),I?e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"60vh",gap:2},children:[e.jsx(co,{sx:{fontSize:80,color:"primary.500"}}),e.jsx(j,{level:"h3",sx:{fontWeight:700,textAlign:"center"},children:"All done, you can now go to the beach"})]}):e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:0},children:[W.map((L,_)=>e.jsxs(h.Fragment,{children:[e.jsxs(u,{sx:{p:2,display:"flex",alignItems:"flex-start",gap:2,cursor:"pointer",background:"transparent",borderRadius:1,transition:"all 0.2s","&:hover":{bgcolor:"neutral.50"}},onClick:()=>M(L.id),children:[e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600,mt:.5},children:L.requester_name?.[0]?.toUpperCase()||"?"}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:600,mb:.5,wordBreak:"break-word"},children:L.subject||"Untitled"}),e.jsx(j,{level:"body-xs",color:"neutral",sx:{mb:.5,wordBreak:"break-word"},children:L.requester_name}),e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(j,{level:"body-xs",color:"neutral",children:Pr(L.updated_at)}),e.jsx(j,{level:"body-xs",color:"neutral",children:"•"}),e.jsxs(j,{level:"body-xs",color:"neutral",sx:{wordBreak:"break-all"},children:[L.id?.slice(0,8),"..."]})]})]}),e.jsx(te,{variant:"soft",size:"sm",color:ht[L.status||"Open"]?.color,sx:{fontWeight:600,px:1.5,py:.5,ml:1},children:ht[L.status||"Open"]?.label})]}),_<W.length-1&&e.jsx(gt,{sx:{my:.5}})]},L.id)),W.length===0&&e.jsx(j,{color:"neutral",sx:{textAlign:"center",mt:4},children:"No tickets found."})]})]}),e.jsx(is,{open:C,onClose:()=>f(!1),onCreated:g}),e.jsx(ls,{open:b,onClose:()=>S(!1),onSubmit:T})]})}return e.jsxs(u,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsxs(u,{sx:{display:"flex",flex:1},children:[e.jsxs(u,{sx:{width:390,borderRight:"1px solid",borderColor:"divider",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs(u,{sx:{px:2,py:1,borderBottom:"1px solid",borderColor:"divider",flexShrink:0},children:[e.jsxs(X,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[e.jsxs(X,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(j,{level:"title-lg",children:"Messages"}),e.jsx(te,{size:"sm",variant:"soft",color:"neutral",children:W.length})]}),e.jsx(re,{size:"sm",variant:"soft",color:"primary",onClick:()=>f(!0),children:e.jsx(de,{})})]}),e.jsx(U,{placeholder:"Search",startDecorator:e.jsx(ge,{}),value:d,onChange:I=>p(I.target.value),size:"sm",sx:{width:"100%",mb:1}}),e.jsxs(ie,{value:x,onChange:(I,L)=>w(L),size:"sm",sx:{width:"100%"},placeholder:"Filter by status",children:[e.jsx(z,{value:"All",children:"All Tickets"}),e.jsx(z,{value:"Open",children:"Open"}),e.jsx(z,{value:"Pending",children:"Pending"}),e.jsx(z,{value:"Closed",children:"Closed"})]})]}),e.jsx(u,{sx:{flex:1,overflowY:"auto",overflowX:"hidden",pt:1},children:e.jsx(ds,{size:"sm",sx:{gap:0},children:W.map(I=>e.jsxs(h.Fragment,{children:[e.jsx(us,{sx:{p:0},children:e.jsx(ft,{selected:n===I.id,onClick:()=>o(I.id),sx:{py:1,px:2},children:e.jsxs(X,{direction:"row",spacing:1.5,alignItems:"flex-start",sx:{width:"100%"},children:[e.jsx(u,{sx:{position:"relative"},children:e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:I.requester_name?.[0]?.toUpperCase()||"?"})}),e.jsxs(u,{sx:{flex:1,minWidth:0,pr:1},children:[e.jsxs(X,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",sx:{mb:.5},children:[e.jsx(j,{level:"body-md",noWrap:!0,sx:{flex:1,pr:1},children:I.subject||"Untitled"}),I.status&&e.jsx(te,{size:"sm",color:ht[I.status]?.color,variant:"soft",sx:{flexShrink:0},children:I.status})]}),e.jsx(j,{level:"body-sm",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",mb:.5},children:I.requester_name||""}),e.jsx(u,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(j,{level:"body-xs",sx:{color:"text.tertiary"},children:Pr(I.updated_at)})})]})]})})}),e.jsx(Jn,{component:"li",sx:{margin:0}})]},I.id))})})]}),e.jsxs(u,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[n&&e.jsx(u,{sx:{px:3,py:2,borderBottom:"1px solid",borderColor:"divider",flexShrink:0},children:e.jsxs(X,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:t.find(I=>I.id===n)?.requester_name?.[0]?.toUpperCase()||"?"}),e.jsxs(u,{sx:{flex:1},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:600},children:t.find(I=>I.id===n)?.requester_name||"Unknown User"}),e.jsx(j,{level:"body-xs",sx:{color:"text.secondary"},children:t.find(I=>I.id===n)?.status||"Unknown Status"})]}),e.jsx(q,{variant:"outlined",size:"sm",sx:{borderRadius:"16px"},children:"View profile"}),t.find(I=>I.id===n)?.status!=="Closed"&&e.jsx(q,{variant:"solid",color:"primary",size:"sm",sx:{borderRadius:"16px"},onClick:()=>S(!0),children:"Resolve"})]})}),e.jsx(u,{sx:{flex:1,overflowY:"auto",px:3,py:2},children:n?e.jsx(X,{spacing:3,children:l.map((I,L)=>{const _=I.sender_name==="You";return e.jsxs(u,{children:[L===0||new Date(I.timestamp||"").toDateString()!==new Date(l[L-1]?.timestamp||"").toDateString()?e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(u,{sx:{flex:1,height:"1px",bgcolor:"divider"}}),e.jsx(j,{level:"body-xs",sx:{mx:2,color:"text.secondary"},children:I.timestamp?new Date(I.timestamp).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}):""}),e.jsx(u,{sx:{flex:1,height:"1px",bgcolor:"divider"}})]}):null,e.jsxs(X,{direction:"row",spacing:1,sx:{alignItems:"flex-start"},children:[!_&&e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:I.sender_name?.[0]?.toUpperCase()||"?"}),e.jsx(u,{sx:{flex:1,display:"flex",flexDirection:_?"row-reverse":"row"},children:e.jsxs(u,{sx:{maxWidth:"70%",bgcolor:_?"primary.500":"neutral.50",color:_?"white":"text.primary",borderRadius:_?"18px 18px 4px 18px":"18px 18px 18px 4px",px:2,py:1.5,position:"relative",boxShadow:"sm"},children:[!_&&e.jsx(j,{level:"body-xs",sx:{fontWeight:600,mb:.5,color:_?"white":"text.primary"},children:I.sender_name}),e.jsx(j,{level:"body-sm",sx:{lineHeight:1.4,color:_?"white":"text.primary"},children:I.message})]})}),_&&e.jsx(ce,{size:"sm",sx:{bgcolor:"primary.100",color:"primary.700",fontWeight:600},children:I.sender_name?.[0]?.toUpperCase()||"?"})]}),e.jsx(u,{sx:{display:"flex",justifyContent:_?"flex-end":"flex-start",mt:.5,ml:_?0:5},children:e.jsx(j,{level:"body-xs",sx:{color:"text.tertiary"},children:I.timestamp?new Date(I.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):""})})]},I.id)})}):e.jsx(u,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx(j,{level:"body-md",sx:{color:"text.secondary"},children:"Select a ticket to view messages"})})}),n&&e.jsx(u,{sx:{px:3,py:2,borderTop:"1px solid",borderColor:"divider",flexShrink:0},children:e.jsxs(X,{direction:"row",spacing:1,alignItems:"flex-end",children:[e.jsx(u,{sx:{flex:1},children:e.jsx(xs,{placeholder:"Type something here...",value:a,onChange:I=>c(I.target.value),minRows:1,maxRows:4,sx:{borderRadius:"20px",border:"1px solid",borderColor:"neutral.300","&:focus-within":{borderColor:"primary.500"},"& textarea":{border:"none",outline:"none",resize:"none",px:2,py:1}},onKeyDown:I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),R())}})}),e.jsx(q,{onClick:R,disabled:!a.trim(),variant:"solid",color:"primary",sx:{borderRadius:"20px",minWidth:60,height:40,fontWeight:600},children:"Send"})]})})]})]}),e.jsx(is,{open:C,onClose:()=>f(!1),onCreated:g}),e.jsx(ls,{open:b,onClose:()=>S(!1),onSubmit:T})]})}const _r={draft:0,scheduled:1,sent:2,failed:3},Me={fontSize:K.sizes.small},Ze={...Me,fontWeight:600,borderBottom:"1.5px solid #e0e0e0",background:"inherit"},Pt=s=>{switch(s){case"draft":return"neutral";case"scheduled":return"warning";case"sent":return"success";case"failed":return"danger";default:return"neutral"}},_l=s=>{switch(s){case"draft":return e.jsx(po,{});case"scheduled":return e.jsx(xo,{});case"sent":return e.jsx(Is,{});case"failed":return e.jsx(ho,{});default:return e.jsx(uo,{})}},El=()=>{const{isMobile:s}=ve(),[t,r]=h.useState([]),[n,o]=h.useState(!1),[l,i]=h.useState(null),[a,c]=h.useState(""),[d,p]=h.useState(""),[x,w]=h.useState(!1),C=async()=>{o(!0),i(null);try{const{data:k,error:g}=await F.from("sms_campaigns").select("*").order("created_at",{ascending:!1});if(g)throw g;k&&r(k)}catch(k){console.error("Error fetching campaigns:",k),i(k.message||"Failed to fetch campaigns")}finally{o(!1)}},b=[...t.filter(k=>{const g=k.name.toLowerCase().includes(a.toLowerCase())||k.CampaignNumber?.toLowerCase().includes(a.toLowerCase()),R=d?k.status===d:!0;return g&&R})].sort((k,g)=>{const R=_r[k.status]??99,T=_r[g.status]??99;return R!==T?R-T:new Date(g.created_at).getTime()-new Date(k.created_at).getTime()});h.useEffect(()=>{C()},[]);const S=()=>e.jsxs(u,{sx:{width:"100%",minHeight:"100vh"},children:[e.jsxs(je,{padding:"medium",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"SMS Campaigns"}),e.jsxs(u,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(U,{placeholder:"Search campaigns...",value:a,onChange:k=>c(k.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1}}),e.jsxs(ie,{placeholder:"Status",value:d,onChange:(k,g)=>p(g??""),sx:{minWidth:120},children:[e.jsx(z,{value:"",children:"All"}),e.jsx(z,{value:"draft",children:"Draft"}),e.jsx(z,{value:"scheduled",children:"Scheduled"}),e.jsx(z,{value:"sent",children:"Sent"}),e.jsx(z,{value:"failed",children:"Failed"})]})]}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:()=>w(!0),sx:{width:"100%",mb:2},children:"Create Campaign"})]}),n&&e.jsx(Ae,{}),l&&e.jsx(u,{sx:{p:2},children:e.jsxs(j,{color:"danger",children:["Error: ",l]})}),e.jsx(u,{children:b.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:"No SMS campaigns found"})}):b.map(k=>e.jsx(u,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider","&:hover":{bgcolor:"background.level1"}},children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(u,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:`${Pt(k.status)}.100`,color:`${Pt(k.status)}.600`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",flexShrink:0},children:_l(k.status)}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%"},children:k.name}),e.jsx(te,{size:"sm",color:Pt(k.status),variant:"soft",sx:{fontWeight:"bold",minWidth:"fit-content",textTransform:"capitalize"},children:k.status})]}),e.jsxs(j,{level:"body-xs",color:"neutral",sx:{mb:.5},children:["Campaign #",k.CampaignNumber," • ",new Date(k.created_at).toLocaleDateString()]}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:.5},children:[e.jsxs(j,{level:"body-xs",color:"neutral",children:["Recipients: ",k.recipients?.length??0]}),k.scheduled_at&&e.jsxs(j,{level:"body-xs",color:"neutral",children:["Scheduled: ",ts(new Date(k.scheduled_at),"MMM dd, HH:mm")]})]}),k.message&&e.jsxs(j,{level:"body-xs",color:"neutral",sx:{fontStyle:"italic",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:['"',k.message,'"']})]})]})},k.id))})]}),A=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"SMS Campaigns"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(U,{placeholder:"Search campaigns...",sx:{flex:1},value:a,onChange:k=>c(k.target.value),startDecorator:e.jsx(ge,{})}),e.jsxs(ie,{placeholder:"Filter status",value:d,onChange:(k,g)=>p(g??""),sx:{minWidth:160},children:[e.jsx(z,{value:"",children:"All Statuses"}),e.jsx(z,{value:"draft",children:"Draft"}),e.jsx(z,{value:"scheduled",children:"Scheduled"}),e.jsx(z,{value:"sent",children:"Sent"}),e.jsx(z,{value:"failed",children:"Failed"})]}),e.jsx(q,{onClick:()=>w(!0),variant:"solid",startDecorator:e.jsx(de,{}),children:"Create Campaign"})]}),e.jsxs(Se,{sx:{overflow:"visible"},children:[n&&e.jsx(Ae,{}),l&&e.jsxs(j,{color:"danger",children:["Error: ",l]}),e.jsxs($e,{"aria-label":"SMS Campaigns",sx:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:Ze,children:"Campaign #"}),e.jsx("th",{style:Ze,children:"Name"}),e.jsx("th",{style:Ze,children:"Status"}),e.jsx("th",{style:Ze,children:"Scheduled"}),e.jsx("th",{style:Ze,children:"Sent"}),e.jsx("th",{style:Ze,children:"Recipients"}),e.jsx("th",{style:Ze,children:"Message"})]})}),e.jsxs("tbody",{children:[b.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"#888",...Me},children:"No campaigns found."})}),b.map(k=>e.jsxs("tr",{style:{cursor:"pointer",height:48},children:[e.jsx("td",{style:Me,children:k.CampaignNumber}),e.jsx("td",{style:Me,children:k.name}),e.jsx("td",{style:Me,children:e.jsx(te,{size:"sm",color:Pt(k.status),variant:"soft",sx:{textTransform:"capitalize"},children:k.status})}),e.jsx("td",{style:Me,children:k.scheduled_at?ts(new Date(k.scheduled_at),"yyyy-MM-dd HH:mm"):"-"}),e.jsx("td",{style:Me,children:k.sent_at?ts(new Date(k.sent_at),"yyyy-MM-dd HH:mm"):"-"}),e.jsx("td",{style:Me,children:k.recipients?.length??0}),e.jsx("td",{style:Me,children:e.jsx(j,{level:"body-sm",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:k.message||"-"})})]},k.id))]})]})]})]});return e.jsxs(Le,{children:[s?e.jsx(S,{}):e.jsx(A,{}),e.jsx(_e,{open:x,onClose:()=>w(!1),children:e.jsxs(Ee,{children:[e.jsx(He,{}),e.jsx(j,{level:"h4",children:"Create New Campaign"}),e.jsx(j,{level:"body-sm",sx:{mt:1,mb:2},children:"Campaign creation functionality will be implemented here."}),e.jsx(q,{onClick:()=>w(!1),variant:"outlined",children:"Close"})]})})]})};function as(s,t){return t===0?s>0?100:0:(s-t)/t*100}function cs(s){return s==null?"—":`${s>0?"+":s<0?"−":""}${Math.abs(Math.round(s))}%`}async function Al(){const s=new Date,t=s.toISOString().slice(0,10),r=new Date(s.getTime()-30*24*60*60*1e3).toISOString().slice(0,10),n=new Date(s.getTime()-60*24*60*60*1e3).toISOString().slice(0,10),o=new Date(s.getTime()-30*24*60*60*1e3-1).toISOString().slice(0,10),l=await F.from("Orders").select("order_total, customer_email, date",{count:"exact"}).not("order_total","is",null);if(l.error||!l.data)throw new Error("Failed to fetch order stats");const i=l.data,a=i.filter(b=>b.date&&b.date>=r&&b.date<=t),c=i.filter(b=>b.date&&b.date>=n&&b.date<=o),d=a.reduce((b,S)=>b+(typeof S.order_total=="number"?S.order_total:0),0),p=c.reduce((b,S)=>b+(typeof S.order_total=="number"?S.order_total:0),0),x=a.length,w=c.length,C=new Set(a.map(b=>b.customer_email).filter(Boolean)),f=new Set(c.map(b=>b.customer_email).filter(Boolean));return{totalSales:d,orderCount:x,customerCount:C.size,salesChange:as(d,p),ordersChange:as(x,w),customersChange:as(C.size,f.size)}}const Ol=()=>{const[s,t]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(null),[i,a]=h.useState(null),[c,d]=h.useState(null),[p,x]=h.useState(null),[w,C]=h.useState(!0),[f,b]=h.useState(null);return Et("(max-width:600px)"),h.useEffect(()=>{let S=!0,A=!0;async function k(){A&&C(!0),b(null);try{const{totalSales:R,orderCount:T,customerCount:M,salesChange:P,ordersChange:W,customersChange:I}=await Al();S&&(t(R),n(T),l(M),a(P),d(W),x(I))}catch(R){S&&b(R.message)}finally{A&&C(!1),A=!1}}k();const g=setInterval(k,1e4);return()=>{S=!1,clearInterval(g)}},[]),e.jsxs(u,{sx:{p:{xs:1,md:4},pt:{xs:0,md:4}},children:[e.jsx(j,{level:"h2",sx:{mb:2},children:"Dashboard"}),e.jsxs(Qe,{container:!0,spacing:2,children:[e.jsx(Qe,{xs:12,md:4,children:e.jsxs(Se,{variant:"outlined",children:[e.jsx(j,{level:"h4",children:"Total Sales"}),e.jsx(j,{level:"h2",color:"success",children:w?"Loading...":f?"—":`$${s?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}),e.jsxs(j,{level:"body-sm",color:"neutral",children:[w?"":cs(i)," from last 30 days"]})]})}),e.jsx(Qe,{xs:12,md:4,children:e.jsxs(Se,{variant:"outlined",children:[e.jsx(j,{level:"h4",children:"Orders"}),e.jsx(j,{level:"h2",color:"primary",children:w?"Loading...":f?"—":r?.toLocaleString()}),e.jsxs(j,{level:"body-sm",color:"neutral",children:[w?"":cs(c)," from last 30 days"]})]})}),e.jsx(Qe,{xs:12,md:4,children:e.jsxs(Se,{variant:"outlined",children:[e.jsx(j,{level:"h4",children:"Customers"}),e.jsx(j,{level:"h2",color:"warning",children:w?"Loading...":f?"—":o?.toLocaleString()}),e.jsxs(j,{level:"body-sm",color:"neutral",children:[w?"":cs(p)," new last 30 days"]})]})})]})]})},Te=({children:s})=>{const[t,r]=h.useState(null),[n,o]=h.useState(!0);return h.useEffect(()=>{async function l(){const{data:i}=await F.auth.getSession();r(i?.session||null),o(!1)}l()},[]),n?e.jsx("div",{children:"Loading..."}):t?e.jsx(e.Fragment,{children:s}):e.jsx(Nt,{to:"/",replace:!0})};function Il(s){const{onClick:t,...r}=s,{mode:n,setMode:o}=zr(),[l,i]=h.useState(!1);return h.useEffect(()=>i(!0),[]),e.jsx(re,{"aria-label":"toggle light/dark mode",size:"sm",variant:"outlined",disabled:!l,onClick:a=>{o(n==="light"?"dark":"light"),t?.(a)},...r,children:n==="light"?e.jsx($r,{}):e.jsx(mo,{})})}function Dl({onLogin:s}){const t=Ds(),[r,n]=h.useState(""),[o,l]=h.useState(""),[i,a]=h.useState(!1),[c,d]=h.useState(null);h.useEffect(()=>{if(window.location.pathname==="/login"){async function x(){const{data:w}=await F.auth.getSession();w?.session&&t("/dashboard")}x()}},[t]);async function p(x){x.preventDefault(),a(!0),d(null);const{data:w,error:C}=await F.auth.signInWithPassword({email:r,password:o});if(C){console.error("[Login] Auth error:",C),d(C.message),a(!1);return}const f=w.user?.id;if(!f){d("Login failed: No user ID."),a(!1);return}let{data:b,error:S}=await F.from("users").select("*").eq("id",f).single();if(S||!b){console.error("[Login] User fetch error:",S);const{error:A}=await F.from("users").upsert({id:f,email:w.user.email,name:w.user.user_metadata?.full_name||w.user.user_metadata?.name||"",role:"employee"});if(A){console.error("Upsert failed:",A),d("Upsert failed: "+A.message),a(!1);return}let k=3,g,R;for(;k>0;){await new Promise(P=>setTimeout(P,300));const{data:T,error:M}=await F.from("users").select("*").eq("id",f).single();if(g=T,R=M,R&&console.error("[Login] Retry user fetch error:",R),g&&!R){b=g,S=null;break}k--}if(S||!b){d("Access denied: User not found."),await F.auth.signOut(),a(!1);return}}if(b.role!=="employee"){d("Access denied: Only employees can access this app."),await F.auth.signOut(),a(!1);return}a(!1),s(),t("/dashboard")}return e.jsxs(qr,{disableTransitionOnChange:!0,children:[e.jsx(Gn,{}),e.jsx(Lr,{styles:{":root":{"--Form-maxWidth":"800px","--Transition-duration":"0.4s"}}}),e.jsx(u,{sx:x=>({width:{xs:"100%",md:"50vw"},transition:"width var(--Transition-duration)",transitionDelay:"calc(var(--Transition-duration) + 0.1s)",position:"relative",zIndex:1,display:"flex",justifyContent:"flex-end",backdropFilter:"blur(12px)",backgroundColor:"rgba(255 255 255 / 0.2)",[x.getColorSchemeSelector("dark")]:{backgroundColor:"rgba(19 19 24 / 0.4)"}}),children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",minHeight:"100dvh",width:"100%",px:2},children:[e.jsxs(u,{component:"header",sx:{py:3,display:"flex",justifyContent:"space-between"},children:[e.jsxs(u,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(re,{variant:"soft",color:"primary",size:"sm",children:e.jsx(fo,{})}),e.jsx(j,{level:"title-lg",children:"SmartBack"})]}),e.jsx(Il,{})]}),e.jsxs(u,{component:"main",sx:{my:"auto",py:2,pb:5,display:"flex",flexDirection:"column",gap:2,width:400,maxWidth:"100%",mx:"auto",borderRadius:"sm","& form":{display:"flex",flexDirection:"column",gap:2},"& .MuiFormLabel-asterisk":{visibility:"hidden"}},children:[e.jsx(X,{sx:{gap:4,mb:2},children:e.jsxs(X,{sx:{gap:1},children:[e.jsx(j,{component:"h1",level:"h3",children:"Sign in"}),e.jsx(j,{level:"body-sm",children:"Welcome back to SmartBack! Please sign in to continue."})]})}),e.jsx(X,{sx:{gap:4,mt:2},children:e.jsxs("form",{onSubmit:p,children:[e.jsxs(se,{required:!0,children:[e.jsx(ee,{children:"Email"}),e.jsx(U,{type:"email",name:"email",value:r,onChange:x=>n(x.target.value),placeholder:"your@email.com",disabled:i})]}),e.jsxs(se,{required:!0,children:[e.jsx(ee,{children:"Password"}),e.jsx(U,{type:"password",name:"password",value:o,onChange:x=>l(x.target.value),placeholder:"••••••",disabled:i})]}),e.jsxs(X,{sx:{gap:4,mt:2},children:[e.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Zn,{size:"sm",label:"Remember me",name:"persistent"}),e.jsx(Qn,{level:"title-sm",href:"#forgot-password",children:"Forgot your password?"})]}),e.jsx(q,{type:"submit",fullWidth:!0,loading:i,children:"Sign in"})]})]})}),c&&e.jsx(u,{sx:{mt:2},children:e.jsx(j,{level:"body-sm",color:"danger",children:c})})]}),e.jsx(u,{component:"footer",sx:{py:3},children:e.jsxs(j,{level:"body-xs",sx:{textAlign:"center"},children:["© SmartBack ",new Date().getFullYear()]})})]})}),e.jsx(u,{sx:x=>({height:"100%",position:"fixed",right:0,top:0,bottom:0,left:{xs:0,md:"50vw"},transition:"background-image var(--Transition-duration), left var(--Transition-duration) !important",transitionDelay:"calc(var(--Transition-duration) + 0.1s)",backgroundColor:"background.level1",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundImage:"url(https://images.unsplash.com/photo-1527181152855-fc03fc7949c8?auto=format&w=1000&dpr=2)",[x.getColorSchemeSelector("dark")]:{backgroundImage:"url(https://images.unsplash.com/photo-1572072393749-3ca9c8ea0831?auto=format&w=1000&dpr=2)"}})})]})}function Tl(){return e.jsx(zs,{children:e.jsx(ye,{path:"*",element:e.jsx(Dl,{onLogin:()=>{}})})})}const he={fontSize:K.sizes.small},zl=()=>{const{isMobile:s}=ve();Kr();const[t,r]=h.useState([]),[n,o]=h.useState([]),[l,i]=h.useState(""),[a,c]=h.useState(!1),[d,p]=h.useState(!1),[x,w]=h.useState(""),[C,f]=h.useState(""),[b,S]=h.useState(""),[A,k]=h.useState(""),[g,R]=h.useState(null),[T,M]=h.useState(!1),[P,W]=h.useState(""),[I,L]=h.useState(""),[_,N]=h.useState(!1),[v,O]=h.useState(!1),[D,B]=h.useState(""),[xe,Oe]=h.useState("success"),ae=(m,$="success")=>{B(m),Oe($),O(!0)},ke=async()=>{try{const{data:m,error:$}=await F.from("stock_movements").select(`
                    *,
                    Products (
                        ProductName,
                        ProductID
                    )
                `).order("date",{ascending:!1});$?(console.error("Error fetching movements:",$),r([]),ae("Failed to load movements","danger")):r(m||[])}catch(m){console.error("Unexpected error:",m),r([]),ae("An unexpected error occurred","danger")}},Ne=async()=>{try{const{data:m,error:$}=await F.from("Products").select("*").order("ProductName");$?(console.error("Error fetching products:",$),o([])):o(m||[])}catch(m){console.error("Unexpected error:",m),o([])}},Ve=async m=>{if(!m){R(null);return}M(!0);try{const{data:$,error:Y}=await F.from("stock_movements").select("movement_type, quantity").eq("product_id",m);if(Y)console.error("Error fetching stock movements:",Y),R(null);else{const J=($||[]).reduce((ne,oe)=>{switch(oe.movement_type){case"incoming":return ne+oe.quantity;case"outgoing":return ne-oe.quantity;case"adjustment":return ne+oe.quantity;default:return ne}},0);R(J)}}catch($){console.error("Error calculating stock:",$),R(null)}finally{M(!1)}};h.useEffect(()=>{A?Ve(A):R(null)},[A]);const dt=async()=>{if(!A||P===""||g===null){ae("Please select a product and enter a valid stock level","warning");return}const $=Number(P)-g;if($===0){ae("No adjustment needed - the stock level is already at the specified amount","warning");return}N(!0);try{const{error:Y}=await F.from("stock_movements").insert({product_id:A,movement_type:"adjustment",quantity:$,reason:`Manual adjustment: ${I||"Stock level correction"}`,date:new Date().toISOString()});Y?(console.error("Error creating adjustment:",Y),ae("Failed to create adjustment: "+Y.message,"danger")):(k(""),W(""),L(""),R(null),c(!1),ke(),ae("Stock adjustment created successfully!","success"))}catch(Y){console.error("Unexpected error:",Y),ae("An unexpected error occurred","danger")}finally{N(!1)}};h.useEffect(()=>{ke(),Ne()},[]);const Ue=t.filter(m=>{const $=l.toLowerCase(),Y=l===""||m.id.toLowerCase().includes($)||m.product_id.toLowerCase().includes($)||m.movement_type.toLowerCase().includes($)||(m.reason?.toLowerCase().includes($)??!1)||(m.Products?.ProductName?.toLowerCase().includes($)??!1),J=x===""||m.movement_type===x,ne=C===""||m.product_id===C,oe=b===""||(()=>{const fe=m.reason?.toLowerCase()||"";switch(b){case"manual":return fe.includes("manual")||fe.includes("adjustment")||fe.includes("correction");case"damage":return fe.includes("damage")||fe.includes("broken")||fe.includes("defect");case"loss":return fe.includes("loss")||fe.includes("lost")||fe.includes("missing");case"found":return fe.includes("found")||fe.includes("surplus")||fe.includes("extra");case"po":return fe.includes("po")||fe.includes("purchase")||fe.includes("receipt");default:return!0}})();return Y&&J&&ne&&oe}),Pe=m=>{switch(m.movement_type){case"incoming":return"success";case"outgoing":return"danger";case"adjustment":return m.quantity>=0?"success":"danger";default:return"neutral"}},st=m=>{switch(m.movement_type){case"incoming":return"↑";case"outgoing":return"↓";case"adjustment":return"⚖";default:return"•"}},rt=m=>{switch(m.movement_type){case"incoming":return`+${m.quantity}`;case"outgoing":return`-${m.quantity}`;case"adjustment":return m.quantity>=0?`+${m.quantity}`:`${m.quantity}`;default:return m.quantity}},nt=()=>{w(""),f(""),S("")},E=x!==""||C!==""||b!=="",V=()=>e.jsxs(u,{sx:{width:"100%",minHeight:"100vh"},children:[e.jsxs(je,{padding:"medium",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Stock Movements"}),e.jsxs(u,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(U,{placeholder:"Search movements...",value:l,onChange:m=>i(m.target.value),startDecorator:e.jsx(ge,{}),sx:{flex:1}}),e.jsx(re,{variant:E?"solid":"soft",color:E?"primary":"neutral",size:"sm",onClick:()=>p(!0),children:e.jsx(Os,{})})]}),E&&e.jsxs(u,{sx:{mb:2,display:"flex",gap:1,flexWrap:"wrap"},children:[x&&e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Type: ",x]}),C&&e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Product: ",n.find(m=>m.uuid===C)?.ProductName||"Selected"]}),b&&e.jsxs(te,{size:"sm",variant:"soft",color:"primary",children:["Reason: ",b]})]})]}),e.jsx(u,{children:Ue.length===0?e.jsx(u,{sx:{textAlign:"center",py:6},children:e.jsx(j,{color:"neutral",children:"No stock movements found"})}):Ue.map(m=>e.jsx(u,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider","&:hover":{bgcolor:"background.level1"}},children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(u,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:`${Pe(m)}.100`,color:`${Pe(m)}.600`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",flexShrink:0},children:st(m)}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsx(j,{level:"title-sm",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%"},children:m.Products?.ProductName||"Unknown Product"}),e.jsx(te,{size:"sm",color:Pe(m),variant:"soft",sx:{fontWeight:"bold",minWidth:"fit-content"},children:rt(m)})]}),e.jsxs(j,{level:"body-xs",color:"neutral",sx:{mb:.5},children:["ID: ",m.Products?.ProductID||"N/A"," • ",new Date(m.date).toLocaleDateString()]}),m.reason&&e.jsx(j,{level:"body-xs",color:"neutral",sx:{fontStyle:"italic",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.reason})]})]})},m.id))}),e.jsx(re,{color:"primary",variant:"soft",size:"sm",sx:{position:"fixed",bottom:80,right:16,zIndex:1e3,borderRadius:"8px",width:40,height:40,boxShadow:"sm",bgcolor:"primary.100","&:hover":{bgcolor:"primary.200",boxShadow:"md"}},onClick:()=>c(!0),children:e.jsx(de,{fontSize:"small"})})]}),pe=()=>e.jsxs(je,{variant:"table-page",children:[e.jsx(j,{level:"h2",sx:{mb:2,fontSize:K.sizes.xlarge},children:"Stock Movements"}),e.jsxs(u,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(U,{placeholder:"Search movements...",sx:{flex:1,fontSize:K.sizes.small},value:l,onChange:m=>i(m.target.value),startDecorator:e.jsx(ge,{})}),e.jsx(q,{variant:"solid",startDecorator:e.jsx(de,{}),onClick:()=>c(!0),sx:{fontSize:K.sizes.small},children:"Adjust"})]}),e.jsx(Se,{sx:{overflow:"visible"},children:e.jsxs($e,{"aria-label":"Stock Movements",sx:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:he,children:"ID"}),e.jsx("th",{style:he,children:"Product"}),e.jsx("th",{style:he,children:"Movement Type"}),e.jsx("th",{style:he,children:"Quantity"}),e.jsx("th",{style:he,children:"Reason"}),e.jsx("th",{style:he,children:"Date"})]})}),e.jsxs("tbody",{children:[Ue.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center",color:"#888",...he},children:"No stock movements found."})}),Ue.map(m=>e.jsxs("tr",{style:{cursor:"pointer"},children:[e.jsxs("td",{style:he,children:[m.id.substring(0,8),"..."]}),e.jsx("td",{style:he,children:m.Products?e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:m.Products.ProductName}),e.jsxs("div",{style:{fontSize:"0.8em",color:"#666"},children:["ID: ",m.Products.ProductID]})]}):e.jsx("span",{style:{color:"#999",fontStyle:"italic"},children:"Unknown Product"})}),e.jsx("td",{style:he,children:e.jsx(te,{size:"sm",variant:"soft",color:Pe(m),children:m.movement_type==="incoming"?"↑ Incoming":m.movement_type==="outgoing"?"↓ Outgoing":"⚖ Adjustment"})}),e.jsx("td",{style:he,children:e.jsx("span",{style:{fontWeight:"bold",color:Pe(m)==="success"?"#059669":Pe(m)==="danger"?"#dc2626":"#666"},children:rt(m)})}),e.jsx("td",{style:he,children:m.reason||"N/A"}),e.jsx("td",{style:he,children:new Date(m.date).toLocaleString()})]},m.id))]})]})})]});return e.jsxs(Le,{children:[s?e.jsx(V,{}):e.jsx(pe,{}),e.jsx(Mt,{open:a,onClose:()=>c(!1),title:"Manual Stock Adjustment",size:"medium",actions:e.jsxs(u,{sx:{display:"flex",gap:2},children:[e.jsx(q,{variant:"plain",onClick:()=>c(!1),sx:he,children:"Cancel"}),e.jsx(q,{variant:"solid",onClick:dt,loading:_,disabled:!A||P===""||g===null||Number(P)===g,sx:he,children:"Create Adjustment"})]}),children:e.jsxs(X,{spacing:2,children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Product"}),e.jsx(ie,{placeholder:"Select a product...",value:A,onChange:(m,$)=>k($||""),children:n.map(m=>e.jsxs(z,{value:m.uuid,children:[m.ProductName," (ID: ",m.ProductID,")"]},m.uuid))})]}),A&&e.jsxs(se,{children:[e.jsx(ee,{children:"Current Stock Level"}),e.jsx(U,{value:T?"Loading...":g!==null?g:"N/A",readOnly:!0,sx:{bgcolor:"neutral.100",color:g!==null&&g<=0?"danger.500":"neutral.600"}}),g!==null&&g<=0&&e.jsx(j,{level:"body-sm",sx:{color:"danger.500",mt:.5},children:"⚠️ Warning: Product is at or below zero stock level"})]}),g!==null&&e.jsxs(se,{children:[e.jsx(ee,{children:"Actual Stock Level"}),e.jsx(U,{type:"number",placeholder:"Enter the actual stock level...",value:P,onChange:m=>W(m.target.value),sx:{...he},slotProps:{input:{min:0,max:999999}}}),P!==""&&g!==null&&e.jsx(j,{level:"body-sm",sx:{mt:.5,color:Number(P)>g?"success.600":Number(P)<g?"danger.600":"neutral.600"},children:Number(P)>g?`+${Number(P)-g} (increase)`:Number(P)<g?`${Number(P)-g} (decrease)`:"No change needed"})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Reason for Adjustment"}),e.jsx(U,{placeholder:"e.g., damage, loss, found inventory, physical count correction...",value:I,onChange:m=>L(m.target.value),sx:{...he}})]})]})}),s&&e.jsx(Mt,{open:d,onClose:()=>p(!1),title:"Filter Movements",size:"medium",actions:e.jsxs(u,{sx:{display:"flex",gap:1,justifyContent:"space-between",width:"100%"},children:[e.jsx(q,{variant:"plain",color:"neutral",onClick:nt,disabled:!E,children:"Clear All"}),e.jsx(q,{onClick:()=>p(!1),children:"Apply Filters"})]}),children:e.jsxs(X,{spacing:2,children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Movement Type"}),e.jsxs(ie,{placeholder:"All types",value:x,onChange:(m,$)=>w($||""),children:[e.jsx(z,{value:"",children:"All Types"}),e.jsx(z,{value:"incoming",children:"Incoming"}),e.jsx(z,{value:"outgoing",children:"Outgoing"}),e.jsx(z,{value:"adjustment",children:"Adjustment"})]})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Product"}),e.jsxs(ie,{placeholder:"All products",value:C,onChange:(m,$)=>f($||""),children:[e.jsx(z,{value:"",children:"All Products"}),n.map(m=>e.jsx(z,{value:m.uuid,children:m.ProductName},m.uuid))]})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Reason Category"}),e.jsxs(ie,{placeholder:"All reasons",value:b,onChange:(m,$)=>S($||""),children:[e.jsx(z,{value:"",children:"All Reasons"}),e.jsx(z,{value:"manual",children:"Manual Adjustment"}),e.jsx(z,{value:"damage",children:"Damage/Defect"}),e.jsx(z,{value:"loss",children:"Loss/Missing"}),e.jsx(z,{value:"found",children:"Found/Surplus"}),e.jsx(z,{value:"po",children:"Purchase Order"})]})]})]})}),e.jsx(Wt,{open:v,onClose:()=>O(!1),autoHideDuration:4e3,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:16,zIndex:2e3},children:e.jsx(Ht,{color:xe,variant:"solid",sx:{width:"100%"},children:D})})]})};function qs(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var tt=qs();function Cn(s){tt=s}var mt={exec:()=>null};function Z(s,t=""){let r=typeof s=="string"?s:s.source,n={replace:(o,l)=>{let i=typeof l=="string"?l:l.source;return i=i.replace(we.caret,"$1"),r=r.replace(o,i),n},getRegex:()=>new RegExp(r,t)};return n}var we={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:s=>new RegExp(`^( {0,3}${s})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}#`),htmlBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}<(?:[a-z].*>|!--)`,"i")},Ll=/^(?:[ \t]*(?:\n|$))+/,Nl=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Ml=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,vt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Fl=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,$s=/(?:[*+-]|\d{1,9}[.)])/,Rn=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Pn=Z(Rn).replace(/bull/g,$s).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),ql=Z(Rn).replace(/bull/g,$s).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Us=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$l=/^[^\n]+/,Bs=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Ul=Z(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Bs).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Bl=Z(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,$s).getRegex(),Yt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ws=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Wl=Z("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Ws).replace("tag",Yt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),_n=Z(Us).replace("hr",vt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Yt).getRegex(),Hl=Z(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",_n).getRegex(),Hs={blockquote:Hl,code:Nl,def:Ul,fences:Ml,heading:Fl,hr:vt,html:Wl,lheading:Pn,list:Bl,newline:Ll,paragraph:_n,table:mt,text:$l},Er=Z("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",vt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Yt).getRegex(),Vl={...Hs,lheading:ql,table:Er,paragraph:Z(Us).replace("hr",vt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Er).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Yt).getRegex()},Jl={...Hs,html:Z(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ws).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:mt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Z(Us).replace("hr",vt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Pn).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Gl=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Zl=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,En=/^( {2,}|\\)\n(?!\s*$)/,Ql=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,es=/[\p{P}\p{S}]/u,Vs=/[\s\p{P}\p{S}]/u,An=/[^\s\p{P}\p{S}]/u,Kl=Z(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Vs).getRegex(),On=/(?!~)[\p{P}\p{S}]/u,Xl=/(?!~)[\s\p{P}\p{S}]/u,Yl=/(?:[^\s\p{P}\p{S}]|~)/u,ea=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,In=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,ta=Z(In,"u").replace(/punct/g,es).getRegex(),sa=Z(In,"u").replace(/punct/g,On).getRegex(),Dn="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",ra=Z(Dn,"gu").replace(/notPunctSpace/g,An).replace(/punctSpace/g,Vs).replace(/punct/g,es).getRegex(),na=Z(Dn,"gu").replace(/notPunctSpace/g,Yl).replace(/punctSpace/g,Xl).replace(/punct/g,On).getRegex(),oa=Z("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,An).replace(/punctSpace/g,Vs).replace(/punct/g,es).getRegex(),ia=Z(/\\(punct)/,"gu").replace(/punct/g,es).getRegex(),la=Z(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),aa=Z(Ws).replace("(?:-->|$)","-->").getRegex(),ca=Z("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",aa).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),$t=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,da=Z(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",$t).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Tn=Z(/^!?\[(label)\]\[(ref)\]/).replace("label",$t).replace("ref",Bs).getRegex(),zn=Z(/^!?\[(ref)\](?:\[\])?/).replace("ref",Bs).getRegex(),ua=Z("reflink|nolink(?!\\()","g").replace("reflink",Tn).replace("nolink",zn).getRegex(),Js={_backpedal:mt,anyPunctuation:ia,autolink:la,blockSkip:ea,br:En,code:Zl,del:mt,emStrongLDelim:ta,emStrongRDelimAst:ra,emStrongRDelimUnd:oa,escape:Gl,link:da,nolink:zn,punctuation:Kl,reflink:Tn,reflinkSearch:ua,tag:ca,text:Ql,url:mt},ha={...Js,link:Z(/^!?\[(label)\]\((.*?)\)/).replace("label",$t).getRegex(),reflink:Z(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",$t).getRegex()},ws={...Js,emStrongRDelimAst:na,emStrongLDelim:sa,url:Z(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},xa={...ws,br:Z(En).replace("{2,}","*").getRegex(),text:Z(ws.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},_t={normal:Hs,gfm:Vl,pedantic:Jl},xt={normal:Js,gfm:ws,breaks:xa,pedantic:ha},pa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ar=s=>pa[s];function ze(s,t){if(t){if(we.escapeTest.test(s))return s.replace(we.escapeReplace,Ar)}else if(we.escapeTestNoEncode.test(s))return s.replace(we.escapeReplaceNoEncode,Ar);return s}function Or(s){try{s=encodeURI(s).replace(we.percentDecode,"%")}catch{return null}return s}function Ir(s,t){let r=s.replace(we.findPipe,(l,i,a)=>{let c=!1,d=i;for(;--d>=0&&a[d]==="\\";)c=!c;return c?"|":" |"}),n=r.split(we.splitPipe),o=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;o<n.length;o++)n[o]=n[o].trim().replace(we.slashPipe,"|");return n}function pt(s,t,r){let n=s.length;if(n===0)return"";let o=0;for(;o<n&&s.charAt(n-o-1)===t;)o++;return s.slice(0,n-o)}function fa(s,t){if(s.indexOf(t[1])===-1)return-1;let r=0;for(let n=0;n<s.length;n++)if(s[n]==="\\")n++;else if(s[n]===t[0])r++;else if(s[n]===t[1]&&(r--,r<0))return n;return r>0?-2:-1}function Dr(s,t,r,n,o){let l=t.href,i=t.title||null,a=s[1].replace(o.other.outputLinkReplace,"$1");n.state.inLink=!0;let c={type:s[0].charAt(0)==="!"?"image":"link",raw:r,href:l,title:i,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,c}function ma(s,t,r){let n=s.match(r.other.indentCodeCompensation);if(n===null)return t;let o=n[1];return t.split(`
`).map(l=>{let i=l.match(r.other.beginningSpace);if(i===null)return l;let[a]=i;return a.length>=o.length?l.slice(o.length):l}).join(`
`)}var Ut=class{options;rules;lexer;constructor(s){this.options=s||tt}space(s){let t=this.rules.block.newline.exec(s);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(s){let t=this.rules.block.code.exec(s);if(t){let r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:pt(r,`
`)}}}fences(s){let t=this.rules.block.fences.exec(s);if(t){let r=t[0],n=ma(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(s){let t=this.rules.block.heading.exec(s);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){let n=pt(r,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(r=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(s){let t=this.rules.block.hr.exec(s);if(t)return{type:"hr",raw:pt(t[0],`
`)}}blockquote(s){let t=this.rules.block.blockquote.exec(s);if(t){let r=pt(t[0],`
`).split(`
`),n="",o="",l=[];for(;r.length>0;){let i=!1,a=[],c;for(c=0;c<r.length;c++)if(this.rules.other.blockquoteStart.test(r[c]))a.push(r[c]),i=!0;else if(!i)a.push(r[c]);else break;r=r.slice(c);let d=a.join(`
`),p=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${d}`:d,o=o?`${o}
${p}`:p;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,l,!0),this.lexer.state.top=x,r.length===0)break;let w=l.at(-1);if(w?.type==="code")break;if(w?.type==="blockquote"){let C=w,f=C.raw+`
`+r.join(`
`),b=this.blockquote(f);l[l.length-1]=b,n=n.substring(0,n.length-C.raw.length)+b.raw,o=o.substring(0,o.length-C.text.length)+b.text;break}else if(w?.type==="list"){let C=w,f=C.raw+`
`+r.join(`
`),b=this.list(f);l[l.length-1]=b,n=n.substring(0,n.length-w.raw.length)+b.raw,o=o.substring(0,o.length-C.raw.length)+b.raw,r=f.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:l,text:o}}}list(s){let t=this.rules.block.list.exec(s);if(t){let r=t[1].trim(),n=r.length>1,o={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=n?r:"[*+-]");let l=this.rules.other.listItemRegex(r),i=!1;for(;s;){let c=!1,d="",p="";if(!(t=l.exec(s))||this.rules.block.hr.test(s))break;d=t[0],s=s.substring(d.length);let x=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,A=>" ".repeat(3*A.length)),w=s.split(`
`,1)[0],C=!x.trim(),f=0;if(this.options.pedantic?(f=2,p=x.trimStart()):C?f=t[1].length+1:(f=t[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,p=x.slice(f),f+=t[1].length),C&&this.rules.other.blankLine.test(w)&&(d+=w+`
`,s=s.substring(w.length+1),c=!0),!c){let A=this.rules.other.nextBulletRegex(f),k=this.rules.other.hrRegex(f),g=this.rules.other.fencesBeginRegex(f),R=this.rules.other.headingBeginRegex(f),T=this.rules.other.htmlBeginRegex(f);for(;s;){let M=s.split(`
`,1)[0],P;if(w=M,this.options.pedantic?(w=w.replace(this.rules.other.listReplaceNesting,"  "),P=w):P=w.replace(this.rules.other.tabCharGlobal,"    "),g.test(w)||R.test(w)||T.test(w)||A.test(w)||k.test(w))break;if(P.search(this.rules.other.nonSpaceChar)>=f||!w.trim())p+=`
`+P.slice(f);else{if(C||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||g.test(x)||R.test(x)||k.test(x))break;p+=`
`+w}!C&&!w.trim()&&(C=!0),d+=M+`
`,s=s.substring(M.length+1),x=P.slice(f)}}o.loose||(i?o.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(i=!0));let b=null,S;this.options.gfm&&(b=this.rules.other.listIsTask.exec(p),b&&(S=b[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:d,task:!!b,checked:S,loose:!1,text:p,tokens:[]}),o.raw+=d}let a=o.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){let d=o.items[c].tokens.filter(x=>x.type==="space"),p=d.length>0&&d.some(x=>this.rules.other.anyLine.test(x.raw));o.loose=p}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}html(s){let t=this.rules.block.html.exec(s);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(s){let t=this.rules.block.def.exec(s);if(t){let r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:n,title:o}}}table(s){let t=this.rules.block.table.exec(s);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let r=Ir(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===n.length){for(let i of n)this.rules.other.tableAlignRight.test(i)?l.align.push("right"):this.rules.other.tableAlignCenter.test(i)?l.align.push("center"):this.rules.other.tableAlignLeft.test(i)?l.align.push("left"):l.align.push(null);for(let i=0;i<r.length;i++)l.header.push({text:r[i],tokens:this.lexer.inline(r[i]),header:!0,align:l.align[i]});for(let i of o)l.rows.push(Ir(i,l.header.length).map((a,c)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:l.align[c]})));return l}}lheading(s){let t=this.rules.block.lheading.exec(s);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(s){let t=this.rules.block.paragraph.exec(s);if(t){let r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(s){let t=this.rules.block.text.exec(s);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(s){let t=this.rules.inline.escape.exec(s);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(s){let t=this.rules.inline.tag.exec(s);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(s){let t=this.rules.inline.link.exec(s);if(t){let r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let l=pt(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{let l=fa(t[2],"()");if(l===-2)return;if(l>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+l;t[2]=t[2].substring(0,l),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let n=t[2],o="";if(this.options.pedantic){let l=this.rules.other.pedanticHrefTitle.exec(n);l&&(n=l[1],o=l[3])}else o=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?n=n.slice(1):n=n.slice(1,-1)),Dr(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(s,t){let r;if((r=this.rules.inline.reflink.exec(s))||(r=this.rules.inline.nolink.exec(s))){let n=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=t[n.toLowerCase()];if(!o){let l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return Dr(r,o,r[0],this.lexer,this.rules)}}emStrong(s,t,r=""){let n=this.rules.inline.emStrongLDelim.exec(s);if(!(!n||n[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!r||this.rules.inline.punctuation.exec(r))){let o=[...n[0]].length-1,l,i,a=o,c=0,d=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*s.length+o);(n=d.exec(t))!=null;){if(l=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!l)continue;if(i=[...l].length,n[3]||n[4]){a+=i;continue}else if((n[5]||n[6])&&o%3&&!((o+i)%3)){c+=i;continue}if(a-=i,a>0)continue;i=Math.min(i,i+a+c);let p=[...n[0]][0].length,x=s.slice(0,o+n.index+p+i);if(Math.min(o,i)%2){let C=x.slice(1,-1);return{type:"em",raw:x,text:C,tokens:this.lexer.inlineTokens(C)}}let w=x.slice(2,-2);return{type:"strong",raw:x,text:w,tokens:this.lexer.inlineTokens(w)}}}}codespan(s){let t=this.rules.inline.code.exec(s);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(r),o=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return n&&o&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(s){let t=this.rules.inline.br.exec(s);if(t)return{type:"br",raw:t[0]}}del(s){let t=this.rules.inline.del.exec(s);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(s){let t=this.rules.inline.autolink.exec(s);if(t){let r,n;return t[2]==="@"?(r=t[1],n="mailto:"+r):(r=t[1],n=r),{type:"link",raw:t[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}url(s){let t;if(t=this.rules.inline.url.exec(s)){let r,n;if(t[2]==="@")r=t[0],n="mailto:"+r;else{let o;do o=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(o!==t[0]);r=t[0],t[1]==="www."?n="http://"+t[0]:n=t[0]}return{type:"link",raw:t[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(s){let t=this.rules.inline.text.exec(s);if(t){let r=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:r}}}},Fe=class Ss{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||tt,this.options.tokenizer=this.options.tokenizer||new Ut,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:we,block:_t.normal,inline:xt.normal};this.options.pedantic?(r.block=_t.pedantic,r.inline=xt.pedantic):this.options.gfm&&(r.block=_t.gfm,this.options.breaks?r.inline=xt.breaks:r.inline=xt.gfm),this.tokenizer.rules=r}static get rules(){return{block:_t,inline:xt}}static lex(t,r){return new Ss(r).lex(t)}static lexInline(t,r){return new Ss(r).inlineTokens(t)}lex(t){t=t.replace(we.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let n=this.inlineQueue[r];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,r=[],n=!1){for(this.options.pedantic&&(t=t.replace(we.tabCharGlobal,"    ").replace(we.spaceLine,""));t;){let o;if(this.options.extensions?.block?.some(i=>(o=i.call({lexer:this},t,r))?(t=t.substring(o.raw.length),r.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);let i=r.at(-1);o.raw.length===1&&i!==void 0?i.raw+=`
`:r.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);let i=r.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=`
`+o.raw,i.text+=`
`+o.text,this.inlineQueue.at(-1).src=i.text):r.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);let i=r.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=`
`+o.raw,i.text+=`
`+o.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),r.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),r.push(o);continue}let l=t;if(this.options.extensions?.startBlock){let i=1/0,a=t.slice(1),c;this.options.extensions.startBlock.forEach(d=>{c=d.call({lexer:this},a),typeof c=="number"&&c>=0&&(i=Math.min(i,c))}),i<1/0&&i>=0&&(l=t.substring(0,i+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){let i=r.at(-1);n&&i?.type==="paragraph"?(i.raw+=`
`+o.raw,i.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):r.push(o),n=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);let i=r.at(-1);i?.type==="text"?(i.raw+=`
`+o.raw,i.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):r.push(o);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let n=t,o=null;if(this.tokens.links){let a=Object.keys(this.tokens.links);if(a.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)a.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,o.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(o=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let l=!1,i="";for(;t;){l||(i=""),l=!1;let a;if(this.options.extensions?.inline?.some(d=>(a=d.call({lexer:this},t,r))?(t=t.substring(a.raw.length),r.push(a),!0):!1))continue;if(a=this.tokenizer.escape(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.tag(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.link(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(a.raw.length);let d=r.at(-1);a.type==="text"&&d?.type==="text"?(d.raw+=a.raw,d.text+=a.text):r.push(a);continue}if(a=this.tokenizer.emStrong(t,n,i)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.codespan(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.br(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.del(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.autolink(t)){t=t.substring(a.raw.length),r.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(t))){t=t.substring(a.raw.length),r.push(a);continue}let c=t;if(this.options.extensions?.startInline){let d=1/0,p=t.slice(1),x;this.options.extensions.startInline.forEach(w=>{x=w.call({lexer:this},p),typeof x=="number"&&x>=0&&(d=Math.min(d,x))}),d<1/0&&d>=0&&(c=t.substring(0,d+1))}if(a=this.tokenizer.inlineText(c)){t=t.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(i=a.raw.slice(-1)),l=!0;let d=r.at(-1);d?.type==="text"?(d.raw+=a.raw,d.text+=a.text):r.push(a);continue}if(t){let d="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return r}},Bt=class{options;parser;constructor(s){this.options=s||tt}space(s){return""}code({text:s,lang:t,escaped:r}){let n=(t||"").match(we.notSpaceStart)?.[0],o=s.replace(we.endingNewline,"")+`
`;return n?'<pre><code class="language-'+ze(n)+'">'+(r?o:ze(o,!0))+`</code></pre>
`:"<pre><code>"+(r?o:ze(o,!0))+`</code></pre>
`}blockquote({tokens:s}){return`<blockquote>
${this.parser.parse(s)}</blockquote>
`}html({text:s}){return s}heading({tokens:s,depth:t}){return`<h${t}>${this.parser.parseInline(s)}</h${t}>
`}hr(s){return`<hr>
`}list(s){let t=s.ordered,r=s.start,n="";for(let i=0;i<s.items.length;i++){let a=s.items[i];n+=this.listitem(a)}let o=t?"ol":"ul",l=t&&r!==1?' start="'+r+'"':"";return"<"+o+l+`>
`+n+"</"+o+`>
`}listitem(s){let t="";if(s.task){let r=this.checkbox({checked:!!s.checked});s.loose?s.tokens[0]?.type==="paragraph"?(s.tokens[0].text=r+" "+s.tokens[0].text,s.tokens[0].tokens&&s.tokens[0].tokens.length>0&&s.tokens[0].tokens[0].type==="text"&&(s.tokens[0].tokens[0].text=r+" "+ze(s.tokens[0].tokens[0].text),s.tokens[0].tokens[0].escaped=!0)):s.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(s.tokens,!!s.loose),`<li>${t}</li>
`}checkbox({checked:s}){return"<input "+(s?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>
`}table(s){let t="",r="";for(let o=0;o<s.header.length;o++)r+=this.tablecell(s.header[o]);t+=this.tablerow({text:r});let n="";for(let o=0;o<s.rows.length;o++){let l=s.rows[o];r="";for(let i=0;i<l.length;i++)r+=this.tablecell(l[i]);n+=this.tablerow({text:r})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:s}){return`<tr>
${s}</tr>
`}tablecell(s){let t=this.parser.parseInline(s.tokens),r=s.header?"th":"td";return(s.align?`<${r} align="${s.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:s}){return`<strong>${this.parser.parseInline(s)}</strong>`}em({tokens:s}){return`<em>${this.parser.parseInline(s)}</em>`}codespan({text:s}){return`<code>${ze(s,!0)}</code>`}br(s){return"<br>"}del({tokens:s}){return`<del>${this.parser.parseInline(s)}</del>`}link({href:s,title:t,tokens:r}){let n=this.parser.parseInline(r),o=Or(s);if(o===null)return n;s=o;let l='<a href="'+s+'"';return t&&(l+=' title="'+ze(t)+'"'),l+=">"+n+"</a>",l}image({href:s,title:t,text:r,tokens:n}){n&&(r=this.parser.parseInline(n,this.parser.textRenderer));let o=Or(s);if(o===null)return ze(r);s=o;let l=`<img src="${s}" alt="${r}"`;return t&&(l+=` title="${ze(t)}"`),l+=">",l}text(s){return"tokens"in s&&s.tokens?this.parser.parseInline(s.tokens):"escaped"in s&&s.escaped?s.text:ze(s.text)}},Gs=class{strong({text:s}){return s}em({text:s}){return s}codespan({text:s}){return s}del({text:s}){return s}html({text:s}){return s}text({text:s}){return s}link({text:s}){return""+s}image({text:s}){return""+s}br(){return""}},qe=class vs{options;renderer;textRenderer;constructor(t){this.options=t||tt,this.options.renderer=this.options.renderer||new Bt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Gs}static parse(t,r){return new vs(r).parse(t)}static parseInline(t,r){return new vs(r).parseInline(t)}parse(t,r=!0){let n="";for(let o=0;o<t.length;o++){let l=t[o];if(this.options.extensions?.renderers?.[l.type]){let a=l,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){n+=c||"";continue}}let i=l;switch(i.type){case"space":{n+=this.renderer.space(i);continue}case"hr":{n+=this.renderer.hr(i);continue}case"heading":{n+=this.renderer.heading(i);continue}case"code":{n+=this.renderer.code(i);continue}case"table":{n+=this.renderer.table(i);continue}case"blockquote":{n+=this.renderer.blockquote(i);continue}case"list":{n+=this.renderer.list(i);continue}case"html":{n+=this.renderer.html(i);continue}case"paragraph":{n+=this.renderer.paragraph(i);continue}case"text":{let a=i,c=this.renderer.text(a);for(;o+1<t.length&&t[o+1].type==="text";)a=t[++o],c+=`
`+this.renderer.text(a);r?n+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):n+=c;continue}default:{let a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return n}parseInline(t,r=this.renderer){let n="";for(let o=0;o<t.length;o++){let l=t[o];if(this.options.extensions?.renderers?.[l.type]){let a=this.options.extensions.renderers[l.type].call({parser:this},l);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){n+=a||"";continue}}let i=l;switch(i.type){case"escape":{n+=r.text(i);break}case"html":{n+=r.html(i);break}case"link":{n+=r.link(i);break}case"image":{n+=r.image(i);break}case"strong":{n+=r.strong(i);break}case"em":{n+=r.em(i);break}case"codespan":{n+=r.codespan(i);break}case"br":{n+=r.br(i);break}case"del":{n+=r.del(i);break}case"text":{n+=r.text(i);break}default:{let a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return n}},Tt=class{options;block;constructor(s){this.options=s||tt}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(s){return s}postprocess(s){return s}processAllTokens(s){return s}provideLexer(){return this.block?Fe.lex:Fe.lexInline}provideParser(){return this.block?qe.parse:qe.parseInline}},ga=class{defaults=qs();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=qe;Renderer=Bt;TextRenderer=Gs;Lexer=Fe;Tokenizer=Ut;Hooks=Tt;constructor(...s){this.use(...s)}walkTokens(s,t){let r=[];for(let n of s)switch(r=r.concat(t.call(this,n)),n.type){case"table":{let o=n;for(let l of o.header)r=r.concat(this.walkTokens(l.tokens,t));for(let l of o.rows)for(let i of l)r=r.concat(this.walkTokens(i.tokens,t));break}case"list":{let o=n;r=r.concat(this.walkTokens(o.items,t));break}default:{let o=n;this.defaults.extensions?.childTokens?.[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{let i=o[l].flat(1/0);r=r.concat(this.walkTokens(i,t))}):o.tokens&&(r=r.concat(this.walkTokens(o.tokens,t)))}}return r}use(...s){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return s.forEach(r=>{let n={...r};if(n.async=this.defaults.async||n.async||!1,r.extensions&&(r.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){let l=t.renderers[o.name];l?t.renderers[o.name]=function(...i){let a=o.renderer.apply(this,i);return a===!1&&(a=l.apply(this,i)),a}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let l=t[o.level];l?l.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),n.extensions=t),r.renderer){let o=this.defaults.renderer||new Bt(this.defaults);for(let l in r.renderer){if(!(l in o))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;let i=l,a=r.renderer[i],c=o[i];o[i]=(...d)=>{let p=a.apply(o,d);return p===!1&&(p=c.apply(o,d)),p||""}}n.renderer=o}if(r.tokenizer){let o=this.defaults.tokenizer||new Ut(this.defaults);for(let l in r.tokenizer){if(!(l in o))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;let i=l,a=r.tokenizer[i],c=o[i];o[i]=(...d)=>{let p=a.apply(o,d);return p===!1&&(p=c.apply(o,d)),p}}n.tokenizer=o}if(r.hooks){let o=this.defaults.hooks||new Tt;for(let l in r.hooks){if(!(l in o))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;let i=l,a=r.hooks[i],c=o[i];Tt.passThroughHooks.has(l)?o[i]=d=>{if(this.defaults.async)return Promise.resolve(a.call(o,d)).then(x=>c.call(o,x));let p=a.call(o,d);return c.call(o,p)}:o[i]=(...d)=>{let p=a.apply(o,d);return p===!1&&(p=c.apply(o,d)),p}}n.hooks=o}if(r.walkTokens){let o=this.defaults.walkTokens,l=r.walkTokens;n.walkTokens=function(i){let a=[];return a.push(l.call(this,i)),o&&(a=a.concat(o.call(this,i))),a}}this.defaults={...this.defaults,...n}}),this}setOptions(s){return this.defaults={...this.defaults,...s},this}lexer(s,t){return Fe.lex(s,t??this.defaults)}parser(s,t){return qe.parse(s,t??this.defaults)}parseMarkdown(s){return(t,r)=>{let n={...r},o={...this.defaults,...n},l=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&n.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=s);let i=o.hooks?o.hooks.provideLexer():s?Fe.lex:Fe.lexInline,a=o.hooks?o.hooks.provideParser():s?qe.parse:qe.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(c=>i(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>a(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(l);try{o.hooks&&(t=o.hooks.preprocess(t));let c=i(t,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let d=a(c,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(c){return l(c)}}}onError(s,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,s){let n="<p>An error occurred:</p><pre>"+ze(r.message+"",!0)+"</pre>";return t?Promise.resolve(n):n}if(t)return Promise.reject(r);throw r}}},et=new ga;function Q(s,t){return et.parse(s,t)}Q.options=Q.setOptions=function(s){return et.setOptions(s),Q.defaults=et.defaults,Cn(Q.defaults),Q};Q.getDefaults=qs;Q.defaults=tt;Q.use=function(...s){return et.use(...s),Q.defaults=et.defaults,Cn(Q.defaults),Q};Q.walkTokens=function(s,t){return et.walkTokens(s,t)};Q.parseInline=et.parseInline;Q.Parser=qe;Q.parser=qe.parse;Q.Renderer=Bt;Q.TextRenderer=Gs;Q.Lexer=Fe;Q.lexer=Fe.lex;Q.Tokenizer=Ut;Q.Hooks=Tt;Q.parse=Q;Q.options;Q.setOptions;Q.use;Q.walkTokens;Q.parseInline;qe.parse;Fe.lex;function ja(){const[s,t]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(!0),[i,a]=h.useState(!1),[c,d]=h.useState(!1),[p,x]=h.useState(null),[w,C]=h.useState(""),[f,b]=h.useState(""),[S,A]=h.useState(""),[k,g]=h.useState(""),[R,T]=h.useState("Thailand"),[M,P]=h.useState("Indochina Time (Bangkok) — GMT+07:00");h.useEffect(()=>{W()},[]);const W=async()=>{try{l(!0);const{data:_}=await F.auth.getUser(),N=_.user;if(N){t(N),A(N.email||"");const{data:v}=await F.from("users").select("*").eq("id",N.id).single();if(v){n(v);const O=(v.name||"").split(" ");C(O[0]||""),b(O.slice(1).join(" ")||""),g(v.role||"UI Developer")}}}catch(_){console.error("Error loading user data:",_),x({type:"danger",text:"Failed to load user data"})}finally{l(!1)}},I=async()=>{if(s)try{d(!0);const _=`${w} ${f}`.trim(),{error:N}=await F.from("users").update({name:_,role:k}).eq("id",s.id);if(N)throw N;await W(),a(!1),x({type:"success",text:"Profile updated successfully"}),setTimeout(()=>x(null),3e3)}catch(_){console.error("Error saving profile:",_),x({type:"danger",text:"Failed to save profile"})}finally{d(!1)}},L=()=>{const _=(r?.name||"").split(" ");C(_[0]||""),b(_.slice(1).join(" ")||""),g(r?.role||"UI Developer"),a(!1),x(null)};return o?e.jsx(Se,{children:e.jsx(it,{children:e.jsx(j,{level:"body-sm",color:"neutral",children:"Loading profile..."})})}):e.jsx(Se,{children:e.jsxs(it,{children:[e.jsx(j,{level:"h4",sx:{mb:1},children:"Personal info"}),e.jsx(j,{level:"body-sm",color:"neutral",sx:{mb:3},children:"Customize how your profile information will appear to the networks."}),p&&e.jsx(Ht,{color:p.type,sx:{mb:2},children:p.text}),e.jsxs(u,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:3,alignItems:{xs:"center",sm:"flex-start"}},children:[e.jsxs(u,{sx:{position:"relative",alignSelf:{xs:"center",sm:"flex-start"}},children:[e.jsxs(ce,{size:"lg",src:r?.avatar_url||s?.user_metadata?.avatar_url,sx:{width:80,height:80},children:[w?.[0],f?.[0]]}),i&&e.jsx(re,{size:"sm",variant:"solid",sx:{position:"absolute",bottom:0,right:0,borderRadius:"50%",minHeight:24,minWidth:24},children:e.jsx(lt,{fontSize:"small"})})]}),e.jsxs(u,{sx:{flex:1,width:{xs:"100%",sm:"auto"}},children:[e.jsxs(X,{spacing:2,children:[e.jsxs(u,{children:[e.jsx(ee,{sx:{mb:1},children:"Name"}),e.jsxs(u,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1},children:[e.jsx(U,{placeholder:"First name",value:w,onChange:_=>C(_.target.value),disabled:!i,sx:{flex:1}}),e.jsx(U,{placeholder:"Last name",value:f,onChange:_=>b(_.target.value),disabled:!i,sx:{flex:1}})]})]}),e.jsxs(u,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2},children:[e.jsxs(se,{sx:{flex:1},children:[e.jsx(ee,{children:"Role"}),e.jsx(U,{value:k,onChange:_=>g(_.target.value),disabled:!i})]}),e.jsxs(se,{sx:{flex:1},children:[e.jsx(ee,{children:"Email"}),e.jsx(U,{value:S,disabled:!0,startDecorator:"✉️"})]})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Country"}),e.jsx(U,{value:R,onChange:_=>T(_.target.value),disabled:!i})]}),e.jsxs(se,{children:[e.jsx(ee,{children:"Timezone"}),e.jsx(U,{value:M,onChange:_=>P(_.target.value),disabled:!i,startDecorator:"🕐"})]})]}),e.jsx(u,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,mt:3,justifyContent:{xs:"stretch",sm:"flex-end"}},children:i?e.jsxs(e.Fragment,{children:[e.jsx(q,{variant:"outlined",onClick:L,disabled:c,startDecorator:e.jsx(jo,{}),sx:{order:{xs:2,sm:1}},children:"Cancel"}),e.jsx(q,{variant:"solid",onClick:I,loading:c,startDecorator:e.jsx(bo,{}),sx:{order:{xs:1,sm:2}},children:"Save"})]}):e.jsx(q,{variant:"outlined",onClick:()=>a(!0),startDecorator:e.jsx(lt,{}),children:"Edit Profile"})})]})]})]})})}function ba(){const[s,t]=G.useState(""),[r,n]=G.useState(!0),[o,l]=G.useState(!1),i=`## Latest Release
**Version 2.1.2** - July 6, 2025

### Recent Updates
- Modern Login Page Redesign with Split Layout
- Glassmorphism effect with backdrop blur and semi-transparent backgrounds
- Dynamic mountain landscape background images that change with light/dark mode
- Dark/light mode toggle in login page header
- Company branding with SmartBack logo and name in header

### System Status
- All systems operational
- Database migrations up to date
- Authentication services active

*For complete release history, please check the development environment or contact support.*`;return G.useEffect(()=>{const a="/RELEASE_LOG.md";console.log("Fetching release log from:",a),fetch(a).then(c=>{if(console.log("Release log response status:",c.status,c.statusText),!c.ok)throw new Error(`Failed to fetch release log: ${c.status} ${c.statusText}`);return c.text()}).then(c=>{console.log("Release log loaded successfully, length:",c.length);const d=c.replace(/<!--[\s\S]*?-->/g,"").trim();t(d),l(!1)}).catch(c=>{console.error("Error fetching release log:",c),console.log("Using fallback content"),t(i),l(!1)}).finally(()=>n(!1))},[i]),e.jsx(Se,{sx:{height:"100%",minHeight:{xs:200,md:300}},children:e.jsxs(it,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(Zr,{color:"primary"}),e.jsx(j,{level:"h4",children:"Release Log"})]}),e.jsxs(u,{sx:{flex:1,overflow:"auto",bgcolor:"background.level1",borderRadius:"var(--joy-radius-md)",border:"1px solid",borderColor:"divider",p:2},children:[r&&e.jsx(j,{level:"body-sm",color:"neutral",children:"Loading release log..."}),!r&&e.jsx(u,{sx:{typography:"body-sm"},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Q(s)}})})]})]})})}function ya(){return ve(),e.jsx(Se,{sx:{height:"100%",minHeight:{xs:120,md:300}},children:e.jsxs(it,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(yo,{color:"primary"}),e.jsx(j,{level:"h4",children:"Application Info"})]}),e.jsxs(X,{spacing:1.5,sx:{flex:1},children:[e.jsx(j,{level:"title-md",sx:{fontWeight:"bold"},children:"Smartback Inventory System"}),e.jsxs(X,{spacing:.5,children:[e.jsxs(j,{level:"body-sm",color:"neutral",children:[e.jsx("strong",{children:"Environment:"})," ","production"]}),e.jsxs(j,{level:"body-sm",color:"neutral",children:[e.jsx("strong",{children:"Version:"})," ","N/A"]}),e.jsxs(j,{level:"body-sm",color:"neutral",children:[e.jsx("strong",{children:"Build:"})," ","N/A"]}),e.jsxs(j,{level:"body-sm",color:"neutral",children:[e.jsx("strong",{children:"Date:"})," ",new Date().toLocaleDateString()]})]})]}),e.jsx(q,{component:"a",href:"https://nicklasfangerfisk.github.io/Testflow/",target:"_blank",rel:"noopener noreferrer",startDecorator:e.jsx(wo,{}),variant:"outlined",color:"primary",sx:{mt:2,alignSelf:"flex-start"},children:"System Test"})]})})}const wa=()=>{const{isMobile:s}=ve(),[t,r]=h.useState(0),n=async()=>{try{const{error:a}=await F.auth.signOut();a?console.error("Error signing out:",a):window.location.href="/login"}catch(a){console.error("Error during logout:",a)}},o=[{label:"User",icon:e.jsx(yt,{}),content:e.jsx(ja,{})},{label:"App",icon:e.jsx(go,{}),content:e.jsx(ya,{})},{label:"Releases",icon:e.jsx(Zr,{}),content:e.jsx(ba,{})}],l=()=>e.jsx(u,{sx:{width:"100%",minHeight:"100vh"},children:e.jsxs(je,{padding:"medium",children:[e.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(j,{level:"h2",sx:{fontSize:K.sizes.xlarge},children:"My profile"}),e.jsx(q,{variant:"outlined",color:"danger",size:"sm",startDecorator:e.jsx(or,{}),onClick:n,children:"Logout"})]}),e.jsxs(Xs,{value:t,onChange:(a,c)=>r(typeof c=="number"?c:0),children:[e.jsx(Ys,{children:o.map((a,c)=>e.jsx(er,{value:c,children:a.label},c))}),o.map((a,c)=>e.jsx(tr,{value:c,sx:{p:0,pt:3},children:a.content},c))]})]})}),i=()=>e.jsxs(je,{variant:"table-page",children:[e.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(j,{level:"h2",sx:{fontSize:K.sizes.xlarge},children:"My profile"}),e.jsx(q,{variant:"outlined",color:"danger",startDecorator:e.jsx(or,{}),onClick:n,children:"Logout"})]}),e.jsxs(Xs,{value:t,onChange:(a,c)=>r(typeof c=="number"?c:0),children:[e.jsx(Ys,{children:o.map((a,c)=>e.jsx(er,{value:c,children:a.label},c))}),o.map((a,c)=>e.jsx(tr,{value:c,sx:{p:0,pt:3},children:a.content},c))]})]});return e.jsx(Le,{children:s?e.jsx(l,{}):e.jsx(i,{})})};function Sa(){const s=Ts(),{isMobile:t}=ve(),r=Ds(),[n,o]=h.useState("dashboard"),l=[{label:"Dashboard",icon:e.jsx(_s,{}),value:"dashboard"},{label:"Orders",icon:e.jsx(Es,{}),value:"orders"},{label:"Users",icon:e.jsx(As,{}),value:"users"},{label:"My Profile",icon:e.jsx(yt,{}),value:"profile"},{label:"Settings",icon:e.jsx(So,{}),value:"settings"}];return h.useEffect(()=>{o({"/":"dashboard","/dashboard":"dashboard","/orders":"orders","/products":"dashboard","/users":"users","/suppliers":"dashboard","/purchase-orders":"dashboard","/tickets":"dashboard","/sms-campaigns":"dashboard","/movements":"dashboard","/settings":"profile"}[s.pathname]||"dashboard")},[s.pathname]),console.log("isMobile:",t),e.jsxs(u,{sx:{display:"flex",minHeight:"100vh"},children:[s.pathname!=="/login"&&!t&&e.jsx(Io,{setView:i=>console.log(i),view:"home"}),e.jsxs(u,{component:"main",sx:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:"100vh",bgcolor:"background.default",p:0,width:t?"100%":"calc(100% - var(--Sidebar-width, 240px))",marginBottom:t?"56px":0},children:[t&&s.pathname!=="/login"&&e.jsx(kl,{items:l,value:n,onChange:i=>{o(i),r(i==="profile"?"/settings":`/${i}`)},toggleSidebar:()=>console.log("Sidebar toggled")}),e.jsxs(zs,{children:[e.jsx(ye,{path:"/",element:e.jsx(Nt,{to:"/dashboard",replace:!0})}),e.jsx(ye,{path:"/orders",element:e.jsx(Te,{children:e.jsx(zo,{})})}),e.jsx(ye,{path:"/products",element:e.jsx(Te,{children:e.jsx(No,{})})}),e.jsx(ye,{path:"/users",element:e.jsx(Te,{children:e.jsx(Fo,{})})}),e.jsx(ye,{path:"/suppliers",element:e.jsx(Te,{children:e.jsx($o,{})})}),e.jsx(ye,{path:"/purchase-orders",element:e.jsx(Te,{children:e.jsx(vl,{})})}),e.jsx(ye,{path:"/tickets",element:e.jsx(Te,{children:e.jsx(Pl,{})})}),e.jsx(ye,{path:"/sms-campaigns",element:e.jsx(Te,{children:e.jsx(El,{})})}),e.jsx(ye,{path:"/dashboard",element:e.jsx(Te,{children:e.jsx(Ol,{})})}),e.jsx(ye,{path:"/movements",element:e.jsx(Te,{children:e.jsx(zl,{})})}),e.jsx(ye,{path:"/settings",element:e.jsx(Te,{children:e.jsx(wa,{})})}),e.jsx(ye,{path:"*",element:e.jsx(Nt,{to:"/",replace:!0})})]})]})]})}function va(){return e.jsx(qr,{children:e.jsx(ko,{children:e.jsxs(zs,{children:[e.jsx(ye,{path:"/login/*",element:e.jsx(Tl,{})}),e.jsx(ye,{path:"/*",element:e.jsx(Sa,{})})]})})})}console.log("Mounting React app...");const Tr=document.getElementById("root");Tr?(Ro.createRoot(Tr).render(e.jsx(va,{})),console.log("React app rendered!")):console.error("No #root element found in index.html!");
